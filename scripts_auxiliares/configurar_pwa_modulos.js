/** * Script para adicionar suporte PWA em todos os m√≥dulos do ALUFORCE * Atualiza os arquivos HTML para incluir meta tags e scripts do PWA */const fs = require('fs');const path = require('path');// Diret√≥rios dos m√≥dulosconst MODULES_DIR = path.join(__dirname, 'modules');const PUBLIC_DIR = path.join(__dirname, 'public');// Meta tags PWA para adicionar ap√≥s <meta charset>const PWA_META_TAGS = `    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">    <meta name="theme-color" content="#1a2744">    <meta name="apple-mobile-web-app-capable" content="yes">    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">    <meta name="apple-mobile-web-app-title" content="ALUFORCE">    <meta name="mobile-web-app-capable" content="yes">    <meta name="application-name" content="ALUFORCE">    <meta name="msapplication-TileColor" content="#1a2744">    <meta name="format-detection" content="telephone=no">`;// Links de √≠cones PWAconst PWA_ICON_LINKS = `    <!-- Favicon e √≠cones PWA -->    <link rel="icon" type="image/x-icon" href="/favicon.ico">    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">        <!-- PWA Manifest -->    <link rel="manifest" href="/manifest.json">        <!-- CSS PWA Mobile -->    <link rel="stylesheet" href="/css/pwa-mobile.css">`;// Script PWA para adicionar antes de </body>const PWA_SCRIPT = `    <!-- PWA Manager -->    <script src="/js/pwa-manager.js"></script>`;// Lista de arquivos HTML dos m√≥dulosconst MODULE_HTML_FILES = [    'modules/Vendas/public/index.html',    'modules/Financeiro/public/index.html',    'modules/PCP/index.html',    'modules/PCP/public/index.html',    'modules/Compras/index.html',    'modules/Compras/public/index.html',    'modules/RH/public/index.html',    'modules/NFe/public/index.html',];function processFile(filePath) {    const fullPath = path.join(__dirname, filePath);        if (!fs.existsSync(fullPath)) {        console.log(`‚ö†Ô∏è  Arquivo n√£o encontrado: ${filePath}`);        return;    }        let content = fs.readFileSync(fullPath, 'utf8');    let modified = false;        // 1. Verificar se j√° tem as meta tags PWA    if (!content.includes('apple-mobile-web-app-capable')) {        // Adicionar ap√≥s <meta charset="UTF-8">        content = content.replace(            /(<meta\s+charset=["']UTF-8["']\s*\/?>)/i,            `$1${PWA_META_TAGS}`        );        modified = true;        console.log(`   ‚úÖ Meta tags PWA adicionadas`);    } else {        console.log(`   ‚ÑπÔ∏è  Meta tags PWA j√° existem`);    }        // 2. Verificar se j√° tem os links de √≠cones    if (!content.includes('apple-touch-icon.png')) {        // Adicionar ap√≥s <head> ou ap√≥s as meta tags        content = content.replace(            /(<head[^>]*>)/i,            `$1${PWA_ICON_LINKS}`        );        modified = true;        console.log(`   ‚úÖ Links de √≠cones adicionados`);    } else {        console.log(`   ‚ÑπÔ∏è  Links de √≠cones j√° existem`);    }        // 3. Verificar se j√° tem o script PWA    if (!content.includes('pwa-manager.js')) {        // Adicionar antes de </body>        content = content.replace(            /<\/body>/i,            `${PWA_SCRIPT}</body>`        );        modified = true;        console.log(`   ‚úÖ Script PWA adicionado`);    } else {        console.log(`   ‚ÑπÔ∏è  Script PWA j√° existe`);    }        // Salvar se modificado    if (modified) {        fs.writeFileSync(fullPath, content, 'utf8');        console.log(`   üíæ Arquivo salvo`);    }}console.log('üöÄ ALUFORCE - Configura√ß√£o PWA para M√≥dulos');console.log('============================================');MODULE_HTML_FILES.forEach((filePath, index) => {    console.log(`[${index + 1}/${MODULE_HTML_FILES.length}] ${filePath}`);    processFile(filePath);    console.log('');});console.log('============================================');console.log('‚úÖ Configura√ß√£o PWA conclu√≠da!');console.log('');console.log('üìã Pr√≥ximos passos:');console.log('   1. Reinicie o servidor');console.log('   2. Acesse o sistema no celular');console.log('   3. Clique em "Instalar App" ou adicione √† tela inicial');