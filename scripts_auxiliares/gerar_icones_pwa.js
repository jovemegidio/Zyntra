/** * Script para gerar Ã­cones PWA do ALUFORCE * Gera todos os tamanhos necessÃ¡rios para PWA a partir da imagem base */const sharp = require('sharp');const path = require('path');const fs = require('fs');// ConfiguraÃ§Ãµesconst SOURCE_IMAGE = path.join(__dirname, 'Applicativo', 'Favicon.png');const OUTPUT_DIR = path.join(__dirname, 'public', 'icons');// Tamanhos necessÃ¡rios para PWAconst ICON_SIZES = [    { size: 72, name: 'icon-72x72.png' },    { size: 96, name: 'icon-96x96.png' },    { size: 128, name: 'icon-128x128.png' },    { size: 144, name: 'icon-144x144.png' },    { size: 152, name: 'icon-152x152.png' },    { size: 192, name: 'icon-192x192.png' },    { size: 384, name: 'icon-384x384.png' },    { size: 512, name: 'icon-512x512.png' },];// Ãcones adicionais para iOS/Appleconst APPLE_ICONS = [    { size: 180, name: 'apple-touch-icon.png' },    { size: 167, name: 'apple-touch-icon-167x167.png' },    { size: 152, name: 'apple-touch-icon-152x152.png' },    { size: 120, name: 'apple-touch-icon-120x120.png' },];// Ãcone para Windows/Microsoftconst MS_ICONS = [    { size: 70, name: 'ms-icon-70x70.png' },    { size: 150, name: 'ms-icon-150x150.png' },    { size: 310, name: 'ms-icon-310x310.png' },];async function generateIcons() {    console.log('ğŸ¨ ALUFORCE - Gerador de Ãcones PWA');    console.log('=====================================');    // Verificar se a imagem fonte existe    if (!fs.existsSync(SOURCE_IMAGE)) {        console.error('âŒ Erro: Imagem fonte nÃ£o encontrada:', SOURCE_IMAGE);        process.exit(1);    }    // Criar diretÃ³rio de saÃ­da se nÃ£o existir    if (!fs.existsSync(OUTPUT_DIR)) {        fs.mkdirSync(OUTPUT_DIR, { recursive: true });        console.log('ğŸ“ DiretÃ³rio criado:', OUTPUT_DIR);    }    console.log('ğŸ“· Imagem fonte:', SOURCE_IMAGE);    console.log('ğŸ“‚ DiretÃ³rio de saÃ­da:', OUTPUT_DIR);    console.log('');    // Carregar imagem base    const sourceBuffer = fs.readFileSync(SOURCE_IMAGE);    const metadata = await sharp(sourceBuffer).metadata();    console.log(`ğŸ“ DimensÃµes originais: ${metadata.width}x${metadata.height}`);    console.log('');    let successCount = 0;    let errorCount = 0;    // Gerar Ã­cones PWA padrÃ£o    console.log('ğŸ”„ Gerando Ã­cones PWA padrÃ£o...');    for (const icon of ICON_SIZES) {        try {            const outputPath = path.join(OUTPUT_DIR, icon.name);            await sharp(sourceBuffer)                .resize(icon.size, icon.size, {                    fit: 'contain',                    background: { r: 26, g: 39, b: 68, alpha: 1 } // #1a2744                })                .png({ quality: 100, compressionLevel: 9 })                .toFile(outputPath);                        console.log(`  âœ… ${icon.name} (${icon.size}x${icon.size})`);            successCount++;        } catch (error) {            console.log(`  âŒ ${icon.name} - Erro: ${error.message}`);            errorCount++;        }    }    // Gerar Ã­cones Apple    console.log('ğŸ Gerando Ã­cones Apple Touch...');    for (const icon of APPLE_ICONS) {        try {            const outputPath = path.join(OUTPUT_DIR, icon.name);            await sharp(sourceBuffer)                .resize(icon.size, icon.size, {                    fit: 'contain',                    background: { r: 26, g: 39, b: 68, alpha: 1 }                })                .png({ quality: 100, compressionLevel: 9 })                .toFile(outputPath);                        console.log(`  âœ… ${icon.name} (${icon.size}x${icon.size})`);            successCount++;        } catch (error) {            console.log(`  âŒ ${icon.name} - Erro: ${error.message}`);            errorCount++;        }    }    // Gerar Ã­cones Microsoft    console.log('ğŸªŸ Gerando Ã­cones Microsoft...');    for (const icon of MS_ICONS) {        try {            const outputPath = path.join(OUTPUT_DIR, icon.name);            await sharp(sourceBuffer)                .resize(icon.size, icon.size, {                    fit: 'contain',                    background: { r: 26, g: 39, b: 68, alpha: 1 }                })                .png({ quality: 100, compressionLevel: 9 })                .toFile(outputPath);                        console.log(`  âœ… ${icon.name} (${icon.size}x${icon.size})`);            successCount++;        } catch (error) {            console.log(`  âŒ ${icon.name} - Erro: ${error.message}`);            errorCount++;        }    }    // Gerar favicon.ico (mÃºltiplos tamanhos em um arquivo)    console.log('ğŸ”· Gerando favicon.ico...');    try {        const faviconPath = path.join(__dirname, 'public', 'favicon.ico');        // Para ICO, vamos criar apenas o PNG de 32x32 e 16x16        const favicon32 = path.join(OUTPUT_DIR, 'favicon-32x32.png');        const favicon16 = path.join(OUTPUT_DIR, 'favicon-16x16.png');                await sharp(sourceBuffer)            .resize(32, 32, { fit: 'contain', background: { r: 26, g: 39, b: 68, alpha: 1 } })            .png()            .toFile(favicon32);                await sharp(sourceBuffer)            .resize(16, 16, { fit: 'contain', background: { r: 26, g: 39, b: 68, alpha: 1 } })            .png()            .toFile(favicon16);                console.log('  âœ… favicon-32x32.png');        console.log('  âœ… favicon-16x16.png');        successCount += 2;    } catch (error) {        console.log(`  âŒ favicon - Erro: ${error.message}`);        errorCount++;    }    // Gerar Ã­cone maskable (com padding para safe zone)    console.log('ğŸ­ Gerando Ã­cone maskable (com safe zone)...');    try {        const maskablePath = path.join(OUTPUT_DIR, 'maskable-icon-512x512.png');                // Para maskable, o conteÃºdo deve ocupar ~80% do espaÃ§o (safe zone)        const innerSize = Math.floor(512 * 0.8); // 409px        const padding = Math.floor((512 - innerSize) / 2); // ~51px de cada lado                // Primeiro redimensionar a imagem        const resizedBuffer = await sharp(sourceBuffer)            .resize(innerSize, innerSize, { fit: 'contain', background: { r: 26, g: 39, b: 68, alpha: 0 } })            .toBuffer();                // Criar canvas com padding        await sharp({            create: {                width: 512,                height: 512,                channels: 4,                background: { r: 26, g: 39, b: 68, alpha: 1 }            }        })        .composite([{            input: resizedBuffer,            top: padding,            left: padding        }])        .png({ quality: 100 })        .toFile(maskablePath);                console.log('  âœ… maskable-icon-512x512.png');        successCount++;    } catch (error) {        console.log(`  âŒ maskable icon - Erro: ${error.message}`);        errorCount++;    }    // Resumo    console.log('=====================================');    console.log('ğŸ“Š RESUMO');    console.log('=====================================');    console.log(`âœ… Ãcones gerados com sucesso: ${successCount}`);    if (errorCount > 0) {        console.log(`âŒ Erros: ${errorCount}`);    }    console.log('');    console.log('ğŸ‰ Processo concluÃ­do!');    console.log('');    console.log('ğŸ“‹ PrÃ³ximos passos:');    console.log('   1. Verifique os Ã­cones em public/icons/');    console.log('   2. O manifest.json serÃ¡ atualizado automaticamente');    console.log('   3. Teste o PWA no navegador');}// ExecutargenerateIcons().catch(console.error);