<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Aluforce: Relatórios de Vendas</title>
    
    <!-- Sistema de Autenticação Unificado - DEVE ser carregado primeiro -->
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --sidebar-width: 48px;
            --header-height: 42px;
            --tab-height: 0px;
            --primary: #225cfa;
            --primary-orange: #225cfa;
            --primary-dark: #1a1a2e;
            --bg-gray: #f5f5f5;
            --border-color: #e5e5e5;
            --text-primary: #1a1a1a;
            --text-secondary: #666;
            --success-green: #22c55e;
            --warning-yellow: #eab308;
            --danger-red: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-gray);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        /* ==================== SIDEBAR ==================== */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--primary-dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 0;
            flex-shrink: 0;
            z-index: 100;
        }

        .sidebar-logo {
            width: 36px;
            height: 36px;
            background: var(--primary-orange);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            margin-bottom: 20px;
            text-decoration: none;
            cursor: pointer;
        }

        .sidebar-logo i { color: white; }

        .sidebar-nav {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex: 1;
        }

        .sidebar-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            color: #8b8b9a;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s;
            position: relative;
        }

        .sidebar-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        .sidebar-btn.active { background: var(--primary-orange); color: white; }

        /* Tooltip customizada ao passar o mouse */
        .sidebar-btn::after {
            content: attr(title);
            position: absolute;
            left: 54px;
            background: #1a1a2e;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s ease;
            z-index: 1001;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .sidebar-btn::before {
            content: '';
            position: absolute;
            left: 46px;
            border: 6px solid transparent;
            border-right-color: #1a1a2e;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s ease;
            z-index: 1001;
        }

        .sidebar-btn:hover::after,
        .sidebar-btn:hover::before {
            opacity: 1;
        }

        .sidebar-bottom {
            margin-top: auto;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        /* ==================== MAIN AREA ==================== */
        .main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            /* overflow: global-header-sidebar.css */
            background: var(--bg-gray);
            margin-top: 0;
            padding: 0;
        }

        /* ==================== HEADER ==================== */
        .header {
            height: var(--header-height);
            background: var(--primary-dark);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            flex-shrink: 0;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
        }

        .header-brand img { height: 24px; }
        .header-brand span { font-size: 14px; font-weight: 600; color: #8b8b9a; }

        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            color: #8b8b9a;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s;
        }

        .header-btn:hover { background: rgba(255,255,255,0.1); color: white; }

        .user-greeting {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-left: 16px;
            color: #8b8b9a;
            font-size: 13px;
        }

        .user-greeting strong { color: white; }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding-left: 12px;
            border-left: 1px solid #334155;
        }

        .user-greeting {
            color: #94a3b8;
            font-size: 13px;
        }

        .user-greeting strong { color: white; }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-left: 8px;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .user-avatar img.visible { display: block; }

        /* ==================== TABS BAR - OCULTA ==================== */
        .tabs-bar {
            display: none; /* Removido para manter padrão das outras páginas */
        }

        .tab-btn {
            padding: 10px 16px;
            border: none;
            background: transparent;
            color: #64748b;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover { background: #f1f5f9; color: #334155; }
        .tab-btn.active { background: var(--primary); color: white; }

        /* ==================== PAGE CONTENT ==================== */
        .page-content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        /* ==================== PAGE HEADER ==================== */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            background: white;
            border-radius: 16px;
            padding: 20px 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-title-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .page-title-text h1 {
            font-size: 24px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 4px;
        }

        .page-title-text p {
            font-size: 14px;
            color: #64748b;
        }

        .page-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            border: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }

        .btn-secondary {
            background: white;
            color: #374151;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover { background: #f8fafc; border-color: #cbd5e1; }

        /* ==================== FILTERS ==================== */
        .filters-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            display: flex;
            gap: 16px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group input,
        .filter-group select {
            padding: 10px 14px;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            color: #334155;
            background: #f8fafc;
            min-width: 160px;
            transition: all 0.2s;
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* ==================== STATS GRID ==================== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        @media (max-width: 1200px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 600px) { .stats-grid { grid-template-columns: 1fr; } }

        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.08);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stat-card.orange::before { background: linear-gradient(90deg, #f97316, #fb923c); }
        .stat-card.blue::before { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
        .stat-card.green::before { background: linear-gradient(90deg, #10b981, #34d399); }
        .stat-card.purple::before { background: linear-gradient(90deg, #8b5cf6, #a78bfa); }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .stat-icon {
            width: 52px;
            height: 52px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .stat-icon.orange { background: linear-gradient(135deg, #fff7ed, #fed7aa); color: #ea580c; }
        .stat-icon.blue { background: linear-gradient(135deg, #eff6ff, #bfdbfe); color: #2563eb; }
        .stat-icon.green { background: linear-gradient(135deg, #ecfdf5, #a7f3d0); color: #059669; }
        .stat-icon.purple { background: linear-gradient(135deg, #f5f3ff, #ddd6fe); color: #7c3aed; }

        .stat-menu {
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            padding: 4px;
            border-radius: 6px;
        }

        .stat-menu:hover { background: #f1f5f9; color: #64748b; }

        .stat-label {
            font-size: 13px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: #0f172a;
            line-height: 1;
            margin-bottom: 16px;
        }

        .stat-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 16px;
            border-top: 1px solid #f1f5f9;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
        }

        .stat-change.up { background: #ecfdf5; color: #059669; }
        .stat-change.down { background: #fef2f2; color: #dc2626; }
        .stat-change i { font-size: 10px; }

        .stat-period {
            font-size: 12px;
            color: #94a3b8;
        }

        /* ==================== SKELETON LOADING ==================== */
        .skeleton-loading {
            display: inline-block;
            background: linear-gradient(90deg, #e2e8f0 25%, #f1f5f9 50%, #e2e8f0 75%);
            background-size: 200% 100%;
            animation: skeleton-shimmer 1.5s infinite;
            border-radius: 4px;
            color: transparent;
        }

        @keyframes skeleton-shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* ==================== CHARTS ==================== */
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1200px) { .charts-grid { grid-template-columns: 1fr; } }

        .chart-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            font-weight: 700;
            color: #0f172a;
        }

        .chart-title i {
            color: var(--primary);
        }

        .chart-select {
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 13px;
            color: #64748b;
            background: #f8fafc;
            cursor: pointer;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* ==================== TABLES ==================== */
        .tables-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1200px) { .tables-grid { grid-template-columns: 1fr; } }

        .table-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #f1f5f9;
        }

        .table-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            font-weight: 700;
            color: #0f172a;
        }

        .table-title i { color: var(--primary); }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 14px 20px;
            text-align: left;
        }

        .data-table th {
            background: #f8fafc;
            font-size: 11px;
            font-weight: 700;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table td {
            font-size: 14px;
            color: #334155;
            border-bottom: 1px solid #f1f5f9;
        }

        .data-table tbody tr:hover { background: #fafafa; }
        .data-table tbody tr:last-child td { border-bottom: none; }

        .rank-badge {
            width: 32px;
            height: 32px;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 700;
        }

        .rank-badge.gold { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #92400e; }
        .rank-badge.silver { background: linear-gradient(135deg, #f1f5f9, #e2e8f0); color: #475569; }
        .rank-badge.bronze { background: linear-gradient(135deg, #fed7aa, #fdba74); color: #9a3412; }
        .rank-badge.normal { background: #f1f5f9; color: #64748b; }

        .vendedor-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .vendedor-avatar {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 13px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .vendedor-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .vendedor-avatar-img {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .vendedor-name {
            font-weight: 600;
            color: #0f172a;
        }

        .valor-positivo {
            font-weight: 700;
            color: #059669;
        }

        /* ==================== QUICK REPORTS ==================== */
        .quick-reports {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        @media (max-width: 1200px) { .quick-reports { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 600px) { .quick-reports { grid-template-columns: 1fr; } }

        .report-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.02);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        .report-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: transparent;
            transition: all 0.3s;
        }
        .report-card:nth-child(1)::before { background: linear-gradient(90deg, #f59e0b, #fbbf24); opacity: 0; }
        .report-card:nth-child(2)::before { background: linear-gradient(90deg, #10b981, #34d399); opacity: 0; }
        .report-card:nth-child(3)::before { background: linear-gradient(90deg, #3b82f6, #60a5fa); opacity: 0; }
        .report-card:nth-child(4)::before { background: linear-gradient(90deg, #8b5cf6, #a78bfa); opacity: 0; }

        .report-card:hover {
            border-color: #e2e8f0;
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(0,0,0,0.02);
        }
        .report-card:hover::before {
            opacity: 1;
        }

        .report-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 18px;
            position: relative;
        }
        .report-icon::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .report-card:hover .report-icon::after {
            opacity: 1;
        }

        .report-icon.orange { 
            background: linear-gradient(135deg, #fef3c7, #fde68a); 
            color: #d97706;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
        }
        .report-icon.green { 
            background: linear-gradient(135deg, #d1fae5, #a7f3d0); 
            color: #059669;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
        }
        .report-icon.blue { 
            background: linear-gradient(135deg, #dbeafe, #bfdbfe); 
            color: #2563eb;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        .report-icon.purple { 
            background: linear-gradient(135deg, #ede9fe, #ddd6fe); 
            color: #7c3aed;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.15);
        }

        .report-card h4 {
            font-size: 15px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 6px;
            transition: color 0.2s;
        }
        .report-card:hover h4 {
            color: #1e40af;
        }

        .report-card p {
            font-size: 13px;
            color: #64748b;
            line-height: 1.5;
        }

        .report-arrow {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 12px;
            opacity: 0;
            transform: translateX(-8px);
            transition: all 0.3s;
        }
        .report-card:hover .report-arrow {
            opacity: 1;
            transform: translateX(0);
        }
        .report-card:nth-child(1):hover .report-arrow { background: #fef3c7; color: #d97706; }
        .report-card:nth-child(2):hover .report-arrow { background: #d1fae5; color: #059669; }
        .report-card:nth-child(3):hover .report-arrow { background: #dbeafe; color: #2563eb; }
        .report-card:nth-child(4):hover .report-arrow { background: #ede9fe; color: #7c3aed; }

        /* ==================== LOADING ==================== */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e2e8f0;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* ==================== SCROLLBAR ==================== */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
    
    <!-- Verificação de Admin (Gestão de Vendas) -->
    <script src="js/vendas-admin-check.js"></script>

    <!-- Controle de Acesso por Permissões -->
    <script src="js/vendas-access-control.js?v=20260114" defer></script>

    <!-- Tooltips Profissionais -->
    <link rel="stylesheet" href="/css/tooltips-professional.css?v=20260209">
    <script src="/js/tooltips-professional.js?v=20260209"></script>
    <script src="/js/modal-title.js?v=20260210"></script>
    <link rel="stylesheet" href="/css/global-header-sidebar.css?v=20260216">

    <!-- Chat Widget BOB AI - DESATIVADO -->
    <!-- <link rel="stylesheet" href="/chat/widget.css?v=20260218"> -->
</head>
<body>
    <div class="app-container">
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleMobileSidebar()"></div>

        <!-- Sidebar -->
        <aside class="sidebar" id="mobile-sidebar">
            <a href="/dashboard" class="sidebar-logo" title="Painel Principal">
                <i class="fas fa-home"></i>
            </a>
            <nav class="sidebar-nav">
                <button class="sidebar-btn" title="Kanban" onclick="window.location.href='index.html'">
                    <i class="fas fa-columns"></i>
                </button>
                <button class="sidebar-btn" title="Pedidos" onclick="window.location.href='pedidos.html'">
                    <i class="fas fa-clipboard-list"></i>
                </button>
                <button class="sidebar-btn" title="Clientes" onclick="window.location.href='clientes.html'">
                    <i class="fas fa-users"></i>
                </button>
                <button class="sidebar-btn" title="Prospecção CRM" onclick="window.location.href='prospeccao.html'">
                    <i class="fas fa-crosshairs"></i>
                </button>
                <button class="sidebar-btn" title="Estoque" onclick="window.location.href='estoque.html'">
                    <i class="fas fa-boxes-stacked"></i>
                </button>
                <button class="sidebar-btn" title="Meu Dashboard" onclick="window.location.href='dashboard.html'">
                    <i class="fas fa-chart-pie"></i>
                </button>
                <button class="sidebar-btn" title="Gestão de Vendas" onclick="window.location.href='dashboard-admin.html'">
                    <i class="fas fa-chart-line"></i>
                </button>
                <button class="sidebar-btn active" title="Relatórios">
                    <i class="fas fa-chart-bar"></i>
                </button>
                <button class="sidebar-btn" title="Comissões" onclick="window.location.href='comissoes.html'">
                    <i class="fas fa-percentage"></i>
                </button>
            </nav>
            <div class="sidebar-bottom">
                <button class="sidebar-btn" title="Configurações">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </aside>

        <!-- Main Area -->
        <main class="main-area">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                        <button class="mobile-menu-btn" onclick="toggleMobileSidebar()" title="Menu">
                            <i class="fas fa-bars"></i>
                        </button>
                    <div class="header-brand" style="display:flex;align-items:center;gap:10px;">
                        <img src="/images/Logo Monocromatico - Branco - Aluforce.png" alt="ALUFORCE" style="height:22px;object-fit:contain;">
                        <span style="color:rgba(255,255,255,0.2);font-weight:300;font-size:18px;user-select:none;">|</span>
                        <img src="/images/zyntra-branco.png" alt="Zyntra" style="height:22px;object-fit:contain;">
                        <span style="color:rgba(255,255,255,0.18);font-weight:200;font-size:16px;user-select:none;margin:0 2px;">—</span>
                        <span class="page-title" style="font-size:13px;font-weight:500;color:rgba(255,255,255,0.85);letter-spacing:0.3px;">Relatórios</span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="header-btn" title="Atualizar" onclick="location.reload()"><i class="fas fa-sync-alt"></i></button>
                    <button class="header-btn" title="Notificações">
                        <i class="fas fa-bell"></i>
                    </button>
                    <div class="user-greeting">
                        <span><span id="greeting-text">Bom dia</span>, <strong id="user-name">Usuário</strong></span>
                        <div class="user-avatar" id="user-avatar">
                            <img src="" alt="Foto do usuário" id="user-photo">
                            <span id="user-initials">U</span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <!-- Page Header -->
                <div class="page-header">
                    <div class="page-title">
                        <div class="page-title-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="page-title-text">
                            <h1>Relatórios de Vendas</h1>
                            <p>Análises e métricas de desempenho comercial</p>
                        </div>
                    </div>
                    <div class="page-actions">
                        <button class="btn btn-secondary" onclick="imprimirRelatorio()">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                        <button class="btn btn-success" onclick="exportarExcel()" style="background:#10b981;">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                        <button class="btn btn-primary" onclick="exportarPDF()">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filters-card">
                    <div class="filter-group">
                        <label>Data Inicial</label>
                        <input type="date" id="filterDataInicio">
                    </div>
                    <div class="filter-group">
                        <label>Data Final</label>
                        <input type="date" id="filterDataFim">
                    </div>
                    <div class="filter-group">
                        <label>Vendedor</label>
                        <select id="filterVendedor">
                            <option value="">Todos os vendedores</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="carregarDados()">
                        <i class="fas fa-search"></i> Filtrar
                    </button>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card orange">
                        <div class="stat-header">
                            <div class="stat-icon orange"><i class="fas fa-dollar-sign"></i></div>
                            <button class="stat-menu"><i class="fas fa-ellipsis-v"></i></button>
                        </div>
                        <div class="stat-label">Faturamento Total</div>
                        <div class="stat-value" id="faturamentoTotal">R$ 0,00</div>
                        <div class="stat-footer">
                            <div class="stat-change up" id="faturamentoChange"><i class="fas fa-arrow-up"></i> 0%</div>
                            <div class="stat-period">vs período anterior</div>
                        </div>
                    </div>
                    <div class="stat-card blue">
                        <div class="stat-header">
                            <div class="stat-icon blue"><i class="fas fa-shopping-cart"></i></div>
                            <button class="stat-menu"><i class="fas fa-ellipsis-v"></i></button>
                        </div>
                        <div class="stat-label">Total de Vendas</div>
                        <div class="stat-value" id="totalVendas">0</div>
                        <div class="stat-footer">
                            <div class="stat-change up" id="vendasChange"><i class="fas fa-arrow-up"></i> 0%</div>
                            <div class="stat-period">vs período anterior</div>
                        </div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-header">
                            <div class="stat-icon green"><i class="fas fa-receipt"></i></div>
                            <button class="stat-menu"><i class="fas fa-ellipsis-v"></i></button>
                        </div>
                        <div class="stat-label">Ticket Médio</div>
                        <div class="stat-value" id="ticketMedio">R$ 0,00</div>
                        <div class="stat-footer">
                            <div class="stat-change up" id="ticketChange"><i class="fas fa-arrow-up"></i> 0%</div>
                            <div class="stat-period">vs período anterior</div>
                        </div>
                    </div>
                    <div class="stat-card purple">
                        <div class="stat-header">
                            <div class="stat-icon purple"><i class="fas fa-percentage"></i></div>
                            <button class="stat-menu"><i class="fas fa-ellipsis-v"></i></button>
                        </div>
                        <div class="stat-label">Taxa de Conversão</div>
                        <div class="stat-value" id="taxaConversao">0%</div>
                        <div class="stat-footer">
                            <div class="stat-change up" id="conversaoChange"><i class="fas fa-arrow-up"></i> 0%</div>
                            <div class="stat-period">vs período anterior</div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">
                                <i class="fas fa-chart-area"></i>
                                Evolução das Vendas
                            </div>
                            <select class="chart-select" id="chartTipo" onchange="atualizarGraficoVendas()">
                                <option value="valor">Por Valor</option>
                                <option value="quantidade">Por Quantidade</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="vendasChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">
                                <i class="fas fa-chart-pie"></i>
                                Pedidos por Status
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="categoriasChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Tables -->
                <div class="tables-grid">
                    <div class="table-card">
                        <div class="table-header">
                            <div class="table-title">
                                <i class="fas fa-trophy"></i>
                                Top Vendedores
                            </div>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Vendedor</th>
                                    <th>Vendas</th>
                                    <th>Valor Total</th>
                                </tr>
                            </thead>
                            <tbody id="topVendedoresBody">
                                <tr>
                                    <td colspan="4" class="loading"><div class="spinner"></div></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="table-card">
                        <div class="table-header">
                            <div class="table-title">
                                <i class="fas fa-star"></i>
                                Produtos Mais Vendidos
                            </div>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Produto</th>
                                    <th>Qtd</th>
                                    <th>Valor</th>
                                </tr>
                            </thead>
                            <tbody id="topProdutosBody">
                                <tr>
                                    <td colspan="4" class="loading"><div class="spinner"></div></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Mapa do Brasil - Vendas por Estado -->
                <div class="charts-grid" style="grid-template-columns: 1fr 1fr; margin-bottom: 24px;">
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">
                                <i class="fas fa-map-marked-alt"></i>
                                Vendas por Estado
                            </div>
                        </div>
                        <div id="mapaContainer" style="height: 350px; position: relative;">
                            <div id="mapaBrasil" style="width: 100%; height: 100%;"></div>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">
                                <i class="fas fa-trophy"></i>
                                Top 5 Estados
                            </div>
                        </div>
                        <div id="topEstadosContainer" style="padding: 16px;">
                            <div class="loading"><div class="spinner"></div></div>
                        </div>
                    </div>
                </div>

                <!-- Quick Reports -->
                <div class="quick-reports">
                    <div class="report-card" onclick="abrirModalRelatorio('vendas-periodo')">
                        <div class="report-icon orange"><i class="fas fa-calendar-alt"></i></div>
                        <h4>Vendas por Período</h4>
                        <p>Análise detalhada de vendas por data</p>
                        <span class="report-arrow"><i class="fas fa-arrow-right"></i></span>
                    </div>
                    <div class="report-card" onclick="abrirModalRelatorio('comissoes')">
                        <div class="report-icon green"><i class="fas fa-coins"></i></div>
                        <h4>Relatório de Comissões</h4>
                        <p>Comissões por vendedor • Taxa fixa 1%</p>
                        <span class="report-arrow"><i class="fas fa-arrow-right"></i></span>
                    </div>
                    <div class="report-card" onclick="abrirModalRelatorio('clientes')">
                        <div class="report-icon blue"><i class="fas fa-users"></i></div>
                        <h4>Análise de Clientes</h4>
                        <p>Comportamento e histórico</p>
                        <span class="report-arrow"><i class="fas fa-arrow-right"></i></span>
                    </div>
                    <div class="report-card" onclick="abrirModalRelatorio('produtos')">
                        <div class="report-icon purple"><i class="fas fa-box-open"></i></div>
                        <h4>Performance de Produtos</h4>
                        <p>Produtos mais rentáveis</p>
                        <span class="report-arrow"><i class="fas fa-arrow-right"></i></span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ==================== MODAIS DE FILTRO PARA RELATÓRIOS PDF - ESTILO OMIE ==================== -->
    
    <!-- Modal: Vendas por Período -->
    <div id="modalVendasPeriodo" class="modal-overlay" style="display:none;">
        <div class="modal-content-omie rel-modal">
            <div class="modal-header-omie">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div class="rel-icon-badge orange"><i class="fas fa-calendar-alt"></i></div>
                    <div>
                        <h2>Vendas por Período</h2>
                        <span class="rel-subtitle">Análise detalhada de vendas por data</span>
                    </div>
                </div>
                <button class="close-btn" onclick="fecharModal('modalVendasPeriodo')">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
            <div class="modal-container-omie">
                <div class="modal-main-content">
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-calendar-week"></i> Período de Análise</div>
                        <div class="form-row-omie">
                            <div class="form-group-omie">
                                <label>Data Início</label>
                                <input type="date" id="modalVpDataInicio" class="form-control-omie">
                            </div>
                            <div class="form-group-omie">
                                <label>Data Fim</label>
                                <input type="date" id="modalVpDataFim" class="form-control-omie">
                            </div>
                        </div>
                    </div>
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-filter"></i> Filtros</div>
                        <div class="form-group-omie">
                            <label>Vendedor</label>
                            <select id="modalVpVendedor" class="form-control-omie">
                                <option value="">Todos os vendedores</option>
                            </select>
                        </div>
                        <div class="form-group-omie" style="margin-top:14px;">
                            <label>Status do Pedido</label>
                            <select id="modalVpStatus" class="form-control-omie">
                                <option value="todos">Todos os status</option>
                                <option value="faturado">Faturados</option>
                                <option value="pendente">Pendentes</option>
                                <option value="orcamento">Orçamentos</option>
                                <option value="cancelado">Cancelados</option>
                            </select>
                        </div>
                    </div>
                    <div class="rel-preview-hint">
                        <i class="fas fa-info-circle"></i>
                        <span>O relatório será gerado em PDF no formato paisagem A4 com todos os pedidos do período selecionado.</span>
                    </div>
                </div>
                <div class="modal-sidebar-actions">
                    <button class="sidebar-action-btn primary" onclick="gerarRelatorioPDF('vendas-periodo')">
                        <i class="fas fa-file-pdf"></i> Gerar PDF
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn" onclick="limparFiltrosModal('vendas-periodo')">
                        <i class="fas fa-eraser"></i> Limpar Filtros
                    </button>
                    <button class="sidebar-action-btn" onclick="preVisualizarRelatorio('vendas-periodo')">
                        <i class="fas fa-eye"></i> Pré-visualizar
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn danger" onclick="fecharModal('modalVendasPeriodo')">
                        <i class="fas fa-times"></i> Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Comissões -->
    <div id="modalComissoes" class="modal-overlay" style="display:none;">
        <div class="modal-content-omie rel-modal">
            <div class="modal-header-omie">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div class="rel-icon-badge green"><i class="fas fa-coins"></i></div>
                    <div>
                        <h2>Relatório de Comissões</h2>
                        <span class="rel-subtitle">Comissões por vendedor</span>
                    </div>
                </div>
                <button class="close-btn" onclick="fecharModal('modalComissoes')">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
            <div class="modal-container-omie">
                <div class="modal-main-content">
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-calendar-week"></i> Período de Análise</div>
                        <div class="form-row-omie">
                            <div class="form-group-omie">
                                <label>Data Início</label>
                                <input type="date" id="modalComDataInicio" class="form-control-omie">
                            </div>
                            <div class="form-group-omie">
                                <label>Data Fim</label>
                                <input type="date" id="modalComDataFim" class="form-control-omie">
                            </div>
                        </div>
                    </div>
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-user-tie"></i> Configurações</div>
                        <div class="form-group-omie">
                            <label>Vendedor</label>
                            <select id="modalComVendedor" class="form-control-omie">
                                <option value="">Todos os vendedores</option>
                            </select>
                        </div>
                        <div class="form-group-omie" style="margin-top:14px;">
                            <label>Taxa de Comissão</label>
                            <div class="commission-display-omie">
                                <div class="commission-badge-omie">
                                    <i class="fas fa-percent"></i>
                                    <span>1%</span>
                                </div>
                                <span class="commission-note-omie">Taxa fixa institucional</span>
                            </div>
                            <input type="hidden" id="modalComPercentual" value="1">
                        </div>
                    </div>
                    <div class="rel-preview-hint">
                        <i class="fas fa-info-circle"></i>
                        <span>As comissões são calculadas sobre o valor faturado dos pedidos no período.</span>
                    </div>
                </div>
                <div class="modal-sidebar-actions">
                    <button class="sidebar-action-btn primary green-btn" onclick="gerarRelatorioPDF('comissoes')">
                        <i class="fas fa-file-pdf"></i> Gerar PDF
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn" onclick="limparFiltrosModal('comissoes')">
                        <i class="fas fa-eraser"></i> Limpar Filtros
                    </button>
                    <button class="sidebar-action-btn" onclick="preVisualizarRelatorio('comissoes')">
                        <i class="fas fa-eye"></i> Pré-visualizar
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn danger" onclick="fecharModal('modalComissoes')">
                        <i class="fas fa-times"></i> Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Análise de Clientes -->
    <div id="modalClientes" class="modal-overlay" style="display:none;">
        <div class="modal-content-omie rel-modal">
            <div class="modal-header-omie">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div class="rel-icon-badge blue"><i class="fas fa-users"></i></div>
                    <div>
                        <h2>Análise de Clientes</h2>
                        <span class="rel-subtitle">Comportamento e histórico</span>
                    </div>
                </div>
                <button class="close-btn" onclick="fecharModal('modalClientes')">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
            <div class="modal-container-omie">
                <div class="modal-main-content">
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-building"></i> Seleção de Cliente</div>
                        <div class="form-group-omie">
                            <label>Cliente</label>
                            <select id="modalCliCliente" class="form-control-omie">
                                <option value="">Todos os clientes</option>
                            </select>
                        </div>
                        <div class="form-group-omie" style="margin-top:14px;">
                            <label>Status</label>
                            <select id="modalCliStatus" class="form-control-omie">
                                <option value="todos">Todos os status</option>
                                <option value="ativo">Ativos</option>
                                <option value="inativo">Inativos</option>
                                <option value="prospecto">Prospectos</option>
                            </select>
                        </div>
                    </div>
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-map-marked-alt"></i> Localização</div>
                        <div class="form-row-omie">
                            <div class="form-group-omie">
                                <label>Cidade</label>
                                <input type="text" id="modalCliCidade" class="form-control-omie" placeholder="Digite a cidade">
                            </div>
                            <div class="form-group-omie">
                                <label>Estado</label>
                                <select id="modalCliEstado" class="form-control-omie">
                                    <option value="">Todos</option>
                                    <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                                    <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                                    <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                                    <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                                    <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                                    <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                                    <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                                    <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                                    <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-sort-amount-down"></i> Ordenação</div>
                        <div class="form-group-omie">
                            <label>Ordenar por</label>
                            <select id="modalCliOrdenar" class="form-control-omie">
                                <option value="nome">Nome (A-Z)</option>
                                <option value="valor">Maior valor faturado</option>
                                <option value="pedidos">Mais pedidos</option>
                                <option value="recente">Compra mais recente</option>
                            </select>
                        </div>
                    </div>
                    <div class="rel-preview-hint">
                        <i class="fas fa-info-circle"></i>
                        <span>O relatório incluirá dados de faturamento e quantidade de pedidos por cliente.</span>
                    </div>
                </div>
                <div class="modal-sidebar-actions">
                    <button class="sidebar-action-btn primary blue-btn" onclick="gerarRelatorioPDF('clientes')">
                        <i class="fas fa-file-pdf"></i> Gerar PDF
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn" onclick="limparFiltrosModal('clientes')">
                        <i class="fas fa-eraser"></i> Limpar Filtros
                    </button>
                    <button class="sidebar-action-btn" onclick="preVisualizarRelatorio('clientes')">
                        <i class="fas fa-eye"></i> Pré-visualizar
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn danger" onclick="fecharModal('modalClientes')">
                        <i class="fas fa-times"></i> Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Performance de Produtos -->
    <div id="modalProdutos" class="modal-overlay" style="display:none;">
        <div class="modal-content-omie rel-modal">
            <div class="modal-header-omie">
                <div style="display:flex;align-items:center;gap:14px;">
                    <div class="rel-icon-badge purple"><i class="fas fa-box-open"></i></div>
                    <div>
                        <h2>Performance de Produtos</h2>
                        <span class="rel-subtitle">Produtos mais rentáveis</span>
                    </div>
                </div>
                <button class="close-btn" onclick="fecharModal('modalProdutos')">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
            <div class="modal-container-omie">
                <div class="modal-main-content">
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-calendar-week"></i> Período de Análise</div>
                        <div class="form-row-omie">
                            <div class="form-group-omie">
                                <label>Data Início</label>
                                <input type="date" id="modalProdDataInicio" class="form-control-omie">
                            </div>
                            <div class="form-group-omie">
                                <label>Data Fim</label>
                                <input type="date" id="modalProdDataFim" class="form-control-omie">
                            </div>
                        </div>
                    </div>
                    <div class="rel-section">
                        <div class="rel-section-title"><i class="fas fa-sort-amount-down"></i> Ordenação</div>
                        <div class="form-group-omie">
                            <label>Ordenar por</label>
                            <select id="modalProdOrdenar" class="form-control-omie">
                                <option value="valor">Maior valor faturado</option>
                                <option value="quantidade">Maior quantidade vendida</option>
                                <option value="pedidos">Mais pedidos</option>
                            </select>
                        </div>
                    </div>
                    <div class="rel-preview-hint">
                        <i class="fas fa-info-circle"></i>
                        <span>Ranking dos produtos com maior performance de vendas no período selecionado.</span>
                    </div>
                </div>
                <div class="modal-sidebar-actions">
                    <button class="sidebar-action-btn primary purple-btn" onclick="gerarRelatorioPDF('produtos')">
                        <i class="fas fa-file-pdf"></i> Gerar PDF
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn" onclick="limparFiltrosModal('produtos')">
                        <i class="fas fa-eraser"></i> Limpar Filtros
                    </button>
                    <button class="sidebar-action-btn" onclick="preVisualizarRelatorio('produtos')">
                        <i class="fas fa-eye"></i> Pré-visualizar
                    </button>
                    <div class="sidebar-divider"></div>
                    <button class="sidebar-action-btn danger" onclick="fecharModal('modalProdutos')">
                        <i class="fas fa-times"></i> Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* ==================== ESTILOS MODAIS OMIE - RELATÓRIOS PDF ==================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: relModalFadeIn 0.2s ease;
            padding: 20px;
        }
        @keyframes relModalFadeIn { 
            from { opacity: 0; } 
            to { opacity: 1; } 
        }

        /* Modal Omie Container */
        .modal-content-omie.rel-modal {
            background: #f8f8f8;
            border-radius: 12px;
            width: 95%;
            max-width: 820px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
            animation: relModalSlideIn 0.2s ease;
            display: flex;
            flex-direction: column;
        }
        @keyframes relModalSlideIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Header Omie */
        .modal-content-omie.rel-modal .modal-header-omie {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 20px;
            background: white;
            border-bottom: 1px solid #e0e0e0;
            min-height: 56px;
        }
        .modal-content-omie.rel-modal .modal-header-omie h2 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }
        .rel-subtitle {
            font-size: 12px;
            color: #888;
            display: block;
            margin-top: 1px;
        }
        .modal-content-omie.rel-modal .modal-header-omie .close-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            background: none;
            border: none;
            color: #555;
            font-size: 13px;
            cursor: pointer;
            padding: 8px 14px;
            border-radius: 4px;
            transition: all 0.15s;
        }
        .modal-content-omie.rel-modal .modal-header-omie .close-btn:hover {
            background: #f0f0f0;
            color: #333;
        }

        /* Icon Badge no Header */
        .rel-icon-badge {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }
        .rel-icon-badge.orange { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #d97706; }
        .rel-icon-badge.green { background: linear-gradient(135deg, #d1fae5, #a7f3d0); color: #059669; }
        .rel-icon-badge.blue { background: linear-gradient(135deg, #dbeafe, #bfdbfe); color: #2563eb; }
        .rel-icon-badge.purple { background: linear-gradient(135deg, #ede9fe, #ddd6fe); color: #7c3aed; }

        /* Container Omie = main + sidebar */
        .modal-content-omie.rel-modal .modal-container-omie {
            display: flex;
            flex: 1;
            overflow: hidden;
            max-height: calc(90vh - 60px);
        }
        .modal-content-omie.rel-modal .modal-main-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px 24px;
            background: white;
            border-right: 1px solid #e5e5e5;
        }
        .modal-content-omie.rel-modal .modal-sidebar-actions {
            width: 160px;
            background: white;
            padding: 16px 12px;
            display: flex;
            flex-direction: column;
            gap: 2px;
            overflow-y: auto;
            flex-shrink: 0;
        }

        /* Sidebar Buttons */
        .modal-content-omie.rel-modal .sidebar-action-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: none;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            color: #444;
            cursor: pointer;
            transition: all 0.15s;
            text-align: left;
            width: 100%;
        }
        .modal-content-omie.rel-modal .sidebar-action-btn:hover {
            background: #f5f5f5;
            color: #222;
        }
        .modal-content-omie.rel-modal .sidebar-action-btn i {
            width: 16px;
            text-align: center;
            color: #f59e0b;
            font-size: 13px;
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.primary {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(245, 158, 11, 0.3);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.primary i { color: white; }
        
        /* Cores para cada tipo de relatório */
        .modal-content-omie.rel-modal .sidebar-action-btn.green-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 3px 10px rgba(16, 185, 129, 0.3);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.green-btn:hover {
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.blue-btn {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            box-shadow: 0 3px 10px rgba(59, 130, 246, 0.3);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.blue-btn:hover {
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.purple-btn {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            box-shadow: 0 3px 10px rgba(139, 92, 246, 0.3);
        }
        .modal-content-omie.rel-modal .sidebar-action-btn.purple-btn:hover {
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4);
        }

        .modal-content-omie.rel-modal .sidebar-action-btn.danger { color: #666; }
        .modal-content-omie.rel-modal .sidebar-action-btn.danger i { color: #999; }
        .modal-content-omie.rel-modal .sidebar-action-btn.danger:hover { background: #fef2f2; color: #dc2626; }
        .modal-content-omie.rel-modal .sidebar-action-btn.danger:hover i { color: #dc2626; }
        .modal-content-omie.rel-modal .sidebar-divider {
            height: 1px;
            background: #e5e5e5;
            margin: 8px 0;
        }

        /* Sections do formulário */
        .rel-section {
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        .rel-section:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .rel-section-title {
            font-size: 11px;
            font-weight: 700;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .rel-section-title i {
            font-size: 12px;
            color: #cbd5e1;
        }

        /* Form Controls Omie */
        .form-row-omie {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
        }
        .form-group-omie {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .form-group-omie label {
            font-size: 12px;
            color: #555;
            font-weight: 500;
        }
        .form-control-omie {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 13px;
            color: #333;
            background: #fafafa;
            transition: all 0.15s;
            box-sizing: border-box;
        }
        .form-control-omie:hover {
            border-color: #bbb;
            background: #fff;
        }
        .form-control-omie:focus {
            border-color: #f59e0b;
            outline: none;
            background: #fff;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }
        select.form-control-omie {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 36px;
        }

        /* Commission Display Omie */
        .commission-display-omie {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 6px;
        }
        .commission-badge-omie {
            display: flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 6px 14px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 14px;
        }
        .commission-badge-omie i { font-size: 11px; opacity: 0.9; }
        .commission-note-omie {
            font-size: 12px;
            color: #059669;
            font-weight: 500;
        }

        /* Preview Hint */
        .rel-preview-hint {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px 14px;
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 6px;
            margin-top: 16px;
        }
        .rel-preview-hint i {
            color: #94a3b8;
            font-size: 13px;
            margin-top: 1px;
            flex-shrink: 0;
        }
        .rel-preview-hint span {
            font-size: 12px;
            color: #666;
            line-height: 1.5;
        }

        /* Responsive */
        @media (max-width: 700px) {
            .modal-content-omie.rel-modal {
                max-width: 100%;
                max-height: 100vh;
                border-radius: 12px 12px 0 0;
            }
            .modal-content-omie.rel-modal .modal-container-omie {
                flex-direction: column;
            }
            .modal-content-omie.rel-modal .modal-sidebar-actions {
                width: 100%;
                flex-direction: row;
                flex-wrap: wrap;
                gap: 8px;
                padding: 12px;
                border-top: 1px solid #e5e5e5;
            }
            .modal-content-omie.rel-modal .sidebar-divider { display: none; }
            .form-row-omie { grid-template-columns: 1fr; }
        }
    </style>

    <script>
        // Versão: 2026-01-14-v3 - Autenticação via cookies httpOnly
        console.log('🔵 Script de relatórios iniciado - v4 (com PDFs)');
        
        // ==================== MODAIS DE RELATÓRIO PDF ====================
        
        // Mapeamento dos modais por tipo
        const modalMap = {
            'vendas-periodo': 'modalVendasPeriodo',
            'comissoes': 'modalComissoes',
            'clientes': 'modalClientes',
            'produtos': 'modalProdutos'
        };
        
        // Abrir modal de filtros
        async function abrirModalRelatorio(tipo) {
            const modalId = modalMap[tipo];
            if (!modalId) {
                console.error('Modal não encontrado para tipo:', tipo);
                return;
            }
            
            // Configurar datas padrão (últimos 30 dias)
            const hoje = new Date();
            const inicio = new Date();
            inicio.setDate(hoje.getDate() - 30);
            const dataHoje = hoje.toISOString().split('T')[0];
            const dataInicio = inicio.toISOString().split('T')[0];
            
            // Preencher campos de data conforme o modal
            if (tipo === 'vendas-periodo') {
                document.getElementById('modalVpDataInicio').value = dataInicio;
                document.getElementById('modalVpDataFim').value = dataHoje;
                await carregarVendedoresModal('modalVpVendedor');
            } else if (tipo === 'comissoes') {
                document.getElementById('modalComDataInicio').value = dataInicio;
                document.getElementById('modalComDataFim').value = dataHoje;
                await carregarVendedoresModal('modalComVendedor');
            } else if (tipo === 'clientes') {
                await carregarClientesModal('modalCliCliente');
            } else if (tipo === 'produtos') {
                document.getElementById('modalProdDataInicio').value = dataInicio;
                document.getElementById('modalProdDataFim').value = dataHoje;
            }
            
            // Mostrar modal
            document.getElementById(modalId).style.display = 'flex';
        }
        
        // Fechar modal
        function fecharModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Carregar vendedores nos selects dos modais - COM FILTRO DE SEGURANÇA
        async function carregarVendedoresModal(selectId) {
            try {
                const res = await fetchAutenticado('/api/vendas/vendedores');
                if (res.ok) {
                    const data = await res.json();
                    let vendedores = data.vendedores || data || [];
                    const select = document.getElementById(selectId);
                    
                    // ========================================
                    // SEGURANÇA: Filtrar vendedores por permissão
                    // ========================================
                    const supervisor = isSupervisor();
                    const meuVendedorId = getVendedorIdUsuarioLogado();
                    
                    console.log('🔒 [MODAL] Carregando vendedores - Supervisor:', supervisor, '| Meu ID:', meuVendedorId);
                    
                    if (supervisor) {
                        // Supervisores podem ver todos os vendedores
                        select.innerHTML = '<option value="">Todos os vendedores</option>';
                        vendedores.forEach(v => {
                            const option = document.createElement('option');
                            option.value = v.id;
                            option.textContent = v.nome;
                            select.appendChild(option);
                        });
                    } else {
                        // Vendedor comum: só pode ver seus próprios dados
                        select.innerHTML = ''; // Remove "Todos" para forçar seleção própria
                        
                        if (meuVendedorId) {
                            // Encontrar o vendedor logado na lista
                            const meuVendedor = vendedores.find(v => v.id === meuVendedorId || v.id == meuVendedorId);
                            
                            if (meuVendedor) {
                                const option = document.createElement('option');
                                option.value = meuVendedor.id;
                                option.textContent = meuVendedor.nome;
                                option.selected = true;
                                select.appendChild(option);
                            } else {
                                // Não encontrou na lista, usar dados do usuário
                                const option = document.createElement('option');
                                option.value = meuVendedorId;
                                option.textContent = usuarioLogado?.nome || 'Meu Vendedor';
                                option.selected = true;
                                select.appendChild(option);
                            }
                        } else {
                            // Não conseguiu identificar o vendedor, mostrar vazio
                            const option = document.createElement('option');
                            option.value = '';
                            option.textContent = 'Selecione...';
                            select.appendChild(option);
                        }
                        
                        console.log('🔒 [MODAL] Vendedor filtrado para:', select.options[0]?.textContent || 'nenhum');
                    }
                }
            } catch (e) {
                console.error('Erro ao carregar vendedores:', e);
            }
        }
        
        // Carregar clientes no select do modal
        async function carregarClientesModal(selectId) {
            try {
                const res = await fetchAutenticado('/api/vendas/clientes?limite=500');
                if (res.ok) {
                    const data = await res.json();
                    const clientes = data.clientes || data || [];
                    const select = document.getElementById(selectId);
                    
                    // Manter opção "Todos"
                    select.innerHTML = '<option value="">Todos os clientes</option>';
                    
                    clientes.slice(0, 200).forEach(c => {
                        const option = document.createElement('option');
                        option.value = c.id;
                        option.textContent = (c.nome_fantasia || c.razao_social || c.nome || 'Sem nome').substring(0, 50);
                        select.appendChild(option);
                    });
                }
            } catch (e) {
                console.error('Erro ao carregar clientes:', e);
            }
        }
        
        // Gerar relatório PDF
        async function gerarRelatorioPDF(tipo) {
            const tiposRelatorio = {
                'vendas-periodo': 'Vendas por Período',
                'comissoes': 'Relatório de Comissões',
                'clientes': 'Análise de Clientes',
                'produtos': 'Performance de Produtos'
            };
            const titulo = tiposRelatorio[tipo] || tipo;
            
            // Toast de loading
            const toast = document.createElement('div');
            toast.style.cssText = 'position:fixed;top:20px;right:20px;background:#1e293b;color:white;padding:16px 24px;border-radius:12px;z-index:10001;display:flex;align-items:center;gap:12px;box-shadow:0 10px 40px rgba(0,0,0,0.2);';
            toast.innerHTML = `<i class="fas fa-spinner fa-spin" style="color:#6366f1;"></i> Gerando PDF de ${titulo}...`;
            document.body.appendChild(toast);
            
            try {
                let url = '';
                let params = new URLSearchParams();
                
                if (tipo === 'vendas-periodo') {
                    params.append('data_inicio', document.getElementById('modalVpDataInicio').value);
                    params.append('data_fim', document.getElementById('modalVpDataFim').value);
                    const vendedor = document.getElementById('modalVpVendedor').value;
                    if (vendedor) params.append('vendedor_id', vendedor);
                    const status = document.getElementById('modalVpStatus').value;
                    if (status) params.append('status', status);
                    url = `/api/vendas/relatorios/vendas-periodo/pdf?${params}`;
                    
                } else if (tipo === 'comissoes') {
                    params.append('data_inicio', document.getElementById('modalComDataInicio').value);
                    params.append('data_fim', document.getElementById('modalComDataFim').value);
                    const vendedor = document.getElementById('modalComVendedor').value;
                    if (vendedor) params.append('vendedor_id', vendedor);
                    params.append('percentual_comissao', document.getElementById('modalComPercentual').value);
                    url = `/api/vendas/relatorios/comissoes/pdf?${params}`;
                    
                } else if (tipo === 'clientes') {
                    const cliente = document.getElementById('modalCliCliente').value;
                    if (cliente) params.append('cliente_id', cliente);
                    const status = document.getElementById('modalCliStatus').value;
                    if (status && status !== 'todos') params.append('status', status);
                    const cidade = document.getElementById('modalCliCidade').value;
                    if (cidade) params.append('cidade', cidade);
                    const estado = document.getElementById('modalCliEstado').value;
                    if (estado) params.append('estado', estado);
                    params.append('ordenar_por', document.getElementById('modalCliOrdenar').value);
                    url = `/api/vendas/relatorios/clientes/pdf?${params}`;
                    
                } else if (tipo === 'produtos') {
                    params.append('data_inicio', document.getElementById('modalProdDataInicio').value);
                    params.append('data_fim', document.getElementById('modalProdDataFim').value);
                    params.append('ordenar_por', document.getElementById('modalProdOrdenar').value);
                    url = `/api/vendas/relatorios/produtos/pdf?${params}`;
                }
                
                // Abrir PDF em nova aba
                const response = await fetch(url, { credentials: 'include' });
                
                if (!response.ok) {
                    throw new Error('Erro ao gerar PDF');
                }
                
                const blob = await response.blob();
                const pdfUrl = URL.createObjectURL(blob);
                window.open(pdfUrl, '_blank');
                
                // Fechar modal
                const modalId = modalMap[tipo];
                if (modalId) fecharModal(modalId);
                
                toast.innerHTML = `<i class="fas fa-check-circle" style="color:#22c55e;"></i> PDF gerado com sucesso!`;
                setTimeout(() => toast.remove(), 3000);
                console.log(`✅ Relatório PDF ${tipo} gerado`);
                
            } catch (error) {
                console.error(`❌ Erro ao gerar PDF ${tipo}:`, error);
                toast.innerHTML = `<i class="fas fa-exclamation-circle" style="color:#ef4444;"></i> Erro ao gerar PDF`;
                setTimeout(() => toast.remove(), 4000);
            }
        }
        
        // Fechar modal ao clicar fora
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.style.display = 'none';
            }
        });

        // Limpar filtros do modal
        function limparFiltrosModal(tipo) {
            const hoje = new Date();
            const inicio = new Date();
            inicio.setDate(hoje.getDate() - 30);
            const dataHoje = hoje.toISOString().split('T')[0];
            const dataInicio = inicio.toISOString().split('T')[0];

            if (tipo === 'vendas-periodo') {
                document.getElementById('modalVpDataInicio').value = dataInicio;
                document.getElementById('modalVpDataFim').value = dataHoje;
                document.getElementById('modalVpVendedor').selectedIndex = 0;
                document.getElementById('modalVpStatus').selectedIndex = 0;
            } else if (tipo === 'comissoes') {
                document.getElementById('modalComDataInicio').value = dataInicio;
                document.getElementById('modalComDataFim').value = dataHoje;
                document.getElementById('modalComVendedor').selectedIndex = 0;
            } else if (tipo === 'clientes') {
                document.getElementById('modalCliCliente').selectedIndex = 0;
                document.getElementById('modalCliStatus').selectedIndex = 0;
                document.getElementById('modalCliCidade').value = '';
                document.getElementById('modalCliEstado').selectedIndex = 0;
                document.getElementById('modalCliOrdenar').selectedIndex = 0;
            } else if (tipo === 'produtos') {
                document.getElementById('modalProdDataInicio').value = dataInicio;
                document.getElementById('modalProdDataFim').value = dataHoje;
                document.getElementById('modalProdOrdenar').selectedIndex = 0;
            }
            console.log('🧹 Filtros limpos para:', tipo);
        }

        // Pré-visualizar relatório (gera e abre em nova aba sem fechar modal)
        async function preVisualizarRelatorio(tipo) {
            // Usa mesma lógica de gerarRelatorioPDF mas sem fechar o modal
            const tiposRelatorio = {
                'vendas-periodo': 'Vendas por Período',
                'comissoes': 'Relatório de Comissões',
                'clientes': 'Análise de Clientes',
                'produtos': 'Performance de Produtos'
            };
            const titulo = tiposRelatorio[tipo] || tipo;

            const toast = document.createElement('div');
            toast.style.cssText = 'position:fixed;top:20px;right:20px;background:#1e293b;color:white;padding:16px 24px;border-radius:12px;z-index:10001;display:flex;align-items:center;gap:12px;box-shadow:0 10px 40px rgba(0,0,0,0.2);';
            toast.innerHTML = `<i class="fas fa-eye" style="color:#6366f1;"></i> Pré-visualizando ${titulo}...`;
            document.body.appendChild(toast);

            try {
                let url = '';
                let params = new URLSearchParams();

                if (tipo === 'vendas-periodo') {
                    params.append('data_inicio', document.getElementById('modalVpDataInicio').value);
                    params.append('data_fim', document.getElementById('modalVpDataFim').value);
                    const vendedor = document.getElementById('modalVpVendedor').value;
                    if (vendedor) params.append('vendedor_id', vendedor);
                    const status = document.getElementById('modalVpStatus').value;
                    if (status && status !== 'todos') params.append('status', status);
                    url = `/api/vendas/relatorios/vendas-periodo/pdf?${params}`;
                } else if (tipo === 'comissoes') {
                    params.append('data_inicio', document.getElementById('modalComDataInicio').value);
                    params.append('data_fim', document.getElementById('modalComDataFim').value);
                    const vendedor = document.getElementById('modalComVendedor').value;
                    if (vendedor) params.append('vendedor_id', vendedor);
                    params.append('percentual_comissao', document.getElementById('modalComPercentual').value);
                    url = `/api/vendas/relatorios/comissoes/pdf?${params}`;
                } else if (tipo === 'clientes') {
                    const cliente = document.getElementById('modalCliCliente').value;
                    if (cliente) params.append('cliente_id', cliente);
                    const status = document.getElementById('modalCliStatus').value;
                    if (status && status !== 'todos') params.append('status', status);
                    const cidade = document.getElementById('modalCliCidade').value;
                    if (cidade) params.append('cidade', cidade);
                    const estado = document.getElementById('modalCliEstado').value;
                    if (estado) params.append('estado', estado);
                    params.append('ordenar_por', document.getElementById('modalCliOrdenar').value);
                    url = `/api/vendas/relatorios/clientes/pdf?${params}`;
                } else if (tipo === 'produtos') {
                    params.append('data_inicio', document.getElementById('modalProdDataInicio').value);
                    params.append('data_fim', document.getElementById('modalProdDataFim').value);
                    params.append('ordenar_por', document.getElementById('modalProdOrdenar').value);
                    url = `/api/vendas/relatorios/produtos/pdf?${params}`;
                }

                const response = await fetch(url, { credentials: 'include' });
                if (!response.ok) throw new Error('Erro ao gerar pré-visualização');

                const blob = await response.blob();
                const pdfUrl = URL.createObjectURL(blob);
                window.open(pdfUrl, '_blank');

                toast.innerHTML = `<i class="fas fa-check-circle" style="color:#22c55e;"></i> Pré-visualização aberta!`;
                setTimeout(() => toast.remove(), 2500);
            } catch (error) {
                console.error(`❌ Erro ao pré-visualizar ${tipo}:`, error);
                toast.innerHTML = `<i class="fas fa-exclamation-circle" style="color:#ef4444;"></i> Erro ao pré-visualizar`;
                setTimeout(() => toast.remove(), 4000);
            }
        }
        
        // ==================== AUTENTICAÇÁO ====================
        // Sistema usa cookies httpOnly para autenticação
        // Verificar autenticação via /api/me em vez de localStorage
        
        async function fetchAutenticado(url, options = {}) {
            const headers = { 
                'Content-Type': 'application/json',
                ...options.headers 
            };
            try {
                // Usar credentials: 'include' para enviar cookies automaticamente
                const response = await fetch(url, { 
                    ...options, 
                    headers,
                    credentials: 'include'
                });
                if (response.status === 401) {
                    console.warn('⚠️ não autorizado - sessão inválida ou expirada');
                    return response;
                }
                return response;
            } catch (error) {
                console.error('❌ Erro de rede:', error);
                throw error;
            }
        }
        
        // Verificar se usuário está autenticado via API
        async function verificarAutenticacao() {
            try {
                const response = await fetchAutenticado('/api/me');
                if (response.ok) {
                    const data = await response.json();
                    console.log('✅ Usuário autenticado:', data.email || data.nome);
                    return true;
                }
                return false;
            } catch (error) {
                console.log('❌ Erro ao verificar autenticação:', error);
                return false;
            }
        }

        // ==================== USUÁRIO ====================
        // Variável global para armazenar dados do usuário logado
        let usuarioLogado = null;
        
        // IDs dos supervisores - carregados dinamicamente via API
        let SUPERVISORES_IDS = [];
        let SUPERVISORES_NOMES = [];
        
        // IDs dos vendedores - carregados dinamicamente via API
        let VENDEDORES_IDS = {};
        
        // Carregar mapeamentos de vendedores/supervisores via API
        async function carregarMapeamentoVendedores() {
            try {
                const res = await fetchAutenticado('/api/vendas/vendedores');
                if (res.ok) {
                    const vendedores = await res.json();
                    vendedores.forEach(v => {
                        VENDEDORES_IDS[v.id] = v.nome;
                        // Supervisores = nivel admin ou cargo supervisor/gerente
                        const cargo = (v.cargo || v.funcao || '').toLowerCase();
                        const nivel = (v.nivel || v.role || '').toLowerCase();
                        if (nivel === 'admin' || nivel === 'supervisor' || cargo.includes('supervisor') || cargo.includes('gerente')) {
                            SUPERVISORES_IDS.push(v.id);
                            SUPERVISORES_NOMES.push((v.nome || '').split(' ')[0].toLowerCase());
                        }
                    });
                    console.log('✅ Mapeamento vendedores carregado:', Object.keys(VENDEDORES_IDS).length, 'vendedores,', SUPERVISORES_IDS.length, 'supervisores');
                }
            } catch (e) {
                console.warn('⚠️ Erro ao carregar mapeamento de vendedores:', e);
            }
        }
        
        // Verifica se o usuário logado é supervisor (pode ver todos os vendedores)
        function isSupervisor() {
            if (!usuarioLogado) return false;
            
            // Verificar por ID de funcionário
            if (usuarioLogado.funcionario_id && SUPERVISORES_IDS.includes(usuarioLogado.funcionario_id)) {
                return true;
            }
            
            // Verificar por nome do usuário (fallback)
            const nomeUsuario = (usuarioLogado.nome || '').toLowerCase();
            if (SUPERVISORES_NOMES.some(nome => nomeUsuario.includes(nome))) {
                return true;
            }
            
            // Verificar por email
            const emailUsuario = (usuarioLogado.email || '').toLowerCase();
            if (emailUsuario.includes('augusto') || emailUsuario.includes('renata')) {
                return true;
            }
            
            // Verificar se é admin/TI/diretoria (sempre tem acesso total)
            const roleUsuario = (usuarioLogado.role || '').toLowerCase();
            if (['admin', 'ti', 'diretoria', 'super_admin'].includes(roleUsuario)) {
                return true;
            }
            
            return false;
        }
        
        // Retorna o ID do vendedor associado ao usuário logado (se houver)
        function getVendedorIdUsuarioLogado() {
            if (!usuarioLogado) return null;
            
            // Tentar pelo funcionario_id direto
            if (usuarioLogado.funcionario_id && VENDEDORES_IDS[usuarioLogado.funcionario_id]) {
                return usuarioLogado.funcionario_id;
            }
            
            // Tentar pelo nome do usuário
            const nomeUsuario = (usuarioLogado.nome || '').toLowerCase();
            for (const [id, nome] of Object.entries(VENDEDORES_IDS)) {
                if (nome.toLowerCase().includes(nomeUsuario.split(' ')[0])) {
                    return parseInt(id);
                }
            }
            
            // Tentar pelo email
            const emailUsuario = (usuarioLogado.email || '').toLowerCase();
            for (const [id, nome] of Object.entries(VENDEDORES_IDS)) {
                const primeiroNome = nome.split(' ')[0].toLowerCase();
                if (emailUsuario.includes(primeiroNome)) {
                    return parseInt(id);
                }
            }
            
            return null;
        }
        
        // Mapeamento de avatares por nome de usuário
        const avatarNameMap = {
            'clemerson': '/avatars/Clemerson.webp',
            'isabela': '/avatars/Isabela.webp',
            'thaina': '/avatars/Thaina.webp',
            'thiago': '/avatars/Thiago.webp',
            'nicolas': '/avatars/NicolasDaniel.webp',
            'nicolasdaniel': '/avatars/NicolasDaniel.webp',
            'rh': '/avatars/Rh.webp',
            'admin': '/avatars/admin.webp',
            'ti': '/avatars/TI.webp',
            'tialuforce': '/avatars/TI.webp',
            'antonio': '/avatars/Antonio.webp',
            'andreia': '/avatars/Andreia.webp',
            'guilherme': '/avatars/Guilherme.webp',
            'augusto': '/avatars/Augusto.jpg',
            'renata': '/avatars/Renata.jpg',
            'fabiano': '/avatars/Fabiano.webp',
            'fabiola': '/avatars/Fabiola.webp',
            'marcia': '/avatars/Marcia.webp',
            'ronaldo': '/avatars/RonaldoTorres.jpg',
            'joao': '/avatars/JoaoVictor.jpg',
            'douglas': '/avatars/Douglas.webp',
            'fernando': '/avatars/Fernando.webp'
        };

        function getAvatarFromEmail(email, nome) {
            if (!email) return null;
            const username = email.split('@')[0].split('.')[0].toLowerCase();
            if (avatarNameMap[username]) return avatarNameMap[username];
            if (nome) {
                const firstName = nome.split(' ')[0].toLowerCase();
                if (avatarNameMap[firstName]) return avatarNameMap[firstName];
            }
            return null;
        }

        async function carregarUsuario() {
            try {
                const response = await fetchAutenticado('/api/me');
                if (response.ok) {
                    const data = await response.json();
                    const user = data.user || data;
                    
                    // Salvar usuário globalmente
                    usuarioLogado = user;
                    console.log('👤 Usuário logado:', user.nome, '| Email:', user.email, '| Supervisor:', isSupervisor());
                    
                    // Usar apelido se disponível, senão primeiro+último nome
                    const userName = user.apelido || user.nome || 'Usuário';
                    const _partesNome = user.nome ? user.nome.split(/\s+/) : [];
                    const primeiroNome = user.apelido || (_partesNome.length > 1 ? _partesNome[0] + ' ' + _partesNome[_partesNome.length - 1] : (_partesNome[0] || 'Usuário'));
                    
                    document.getElementById('user-name').textContent = primeiroNome;
                    document.getElementById('user-initials').textContent = userName.charAt(0).toUpperCase();
                    
                    // Verificar múltiplos campos de foto
                    let userAvatar = (user.avatar || user.foto || user.foto_perfil_url);
                    if (userAvatar === '/avatars/default.webp') userAvatar = null;
                    if (!userAvatar) {
                        userAvatar = getAvatarFromEmail(user.email, userName);
                    }
                    
                    const userPhotoEl = document.getElementById('user-photo');
                    const userInitialEl = document.getElementById('user-initials');
                    
                    if (userAvatar && userPhotoEl) {
                        userPhotoEl.src = userAvatar;
                        userPhotoEl.classList.add('visible');
                        userPhotoEl.style.display = 'block';
                        if (userInitialEl) userInitialEl.style.display = 'none';
                    } else if (userInitialEl) {
                        userInitialEl.textContent = userName.charAt(0).toUpperCase();
                        userInitialEl.style.display = 'flex';
                        if (userPhotoEl) userPhotoEl.style.display = 'none';
                    }

                    // Saudação
                    const hora = new Date().getHours();
                    let saudacao = 'Bom dia';
                    if (hora >= 12 && hora < 18) saudacao = 'Boa tarde';
                    else if (hora >= 18 || hora < 5) saudacao = 'Boa noite';
                    document.getElementById('greeting-text').textContent = saudacao;
                }
            } catch (error) {
                console.error('Erro ao carregar usuário:', error);
            }
        }

        // ==================== DADOS ====================
        let vendasChart = null;
        let categoriasChart = null;

        async function carregarDados() {
            const dataInicio = document.getElementById('filterDataInicio').value;
            const dataFim = document.getElementById('filterDataFim').value;
            const vendedor = document.getElementById('filterVendedor').value;

            console.log('📊 Iniciando carregamento de dados...', { dataInicio, dataFim, vendedor });

            // Mostrar loading nos cards
            const statsElements = ['faturamentoTotal', 'totalVendas', 'ticketMedio', 'taxaConversao'];
            statsElements.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerHTML = '<span class="skeleton-loading">Carregando...</span>';
            });

            try {
                // Autenticação via cookie httpOnly - não precisa verificar localStorage
                // OTIMIZADO: Uma única chamada de API para todos os dados
                const params = new URLSearchParams({ dataInicio, dataFim });
                if (vendedor) params.append('vendedor', vendedor);
                
                console.log('📡 Chamando API:', `/api/vendas/relatorio/completo?${params}`);
                console.time('Carregamento Relatório');
                
                const res = await fetchAutenticado(`/api/vendas/relatorio/completo?${params}`);
                console.timeEnd('Carregamento Relatório');
                console.log('📡 Status da resposta:', res.status);
                
                // Se não autorizado, mostrar mensagem
                if (res.status === 401 || res.status === 403) {
                    console.warn('⚠️ Não autorizado para acessar relatórios');
                    mostrarEstadoVazio('Sessão expirada. Faça login novamente para visualizar os relatórios.');
                    return;
                }
                
                if (res.ok) {
                    const dados = await res.json();
                    console.log('✅ Dados do relatório recebidos:', dados);
                    
                    // Atualizar estatísticas
                    atualizarEstatisticas(dados.estatisticas || {});
                    
                    // Atualizar gráfico de vendas (Evolução mensal)
                    if (dados.evolucaoMensal && dados.evolucaoMensal.labels && dados.evolucaoMensal.labels.length > 0) {
                        renderizarGraficoVendas({
                            labels: dados.evolucaoMensal.labels,
                            valores: dados.evolucaoMensal.valores
                        });
                    } else {
                        renderizarGraficoVendas({ labels: [], valores: [] });
                    }
                    
                    // Atualizar gráfico de categorias (conversão por status)
                    if (dados.conversaoStatus && dados.conversaoStatus.length > 0) {
                        renderizarGraficoCategorias({
                            labels: dados.conversaoStatus.map(c => c.status || 'Sem Status'),
                            valores: dados.conversaoStatus.map(c => c.quantidade)
                        });
                    } else {
                        renderizarGraficoCategorias({ labels: [], valores: [] });
                    }
                    
                    // Atualizar tabelas (sempre chamar para remover spinner)
                    renderizarTopVendedores(dados.topVendedores || []);
                    renderizarTopProdutos(dados.topProdutos || []);
                    
                    // Atualizar mapa do Brasil com filtros atuais
                    await carregarMapaBrasil();
                } else {
                    console.error('❌ API retornou erro:', res.status);
                    const errorText = await res.text();
                    console.error('❌ Detalhes:', errorText);
                    throw new Error('Falha ao carregar relatório: ' + res.status);
                }

            } catch (error) {
                console.error('❌ Erro ao carregar dados:', error);
                mostrarEstadoVazio('Erro ao carregar dados. Verifique sua conexão e tente novamente.');
            }
        }

        async function carregarEstatisticas(dataInicio, dataFim) {
            // Mantido para compatibilidade, mas agora usa carregarDados()
            try {
                // Calcular dias do período
                const inicio = new Date(dataInicio);
                const fim = new Date(dataFim);
                const diffTime = Math.abs(fim - inicio);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) || 30;
                
                // Usar API dashboard/admin que já existe
                const url = `/api/vendas/dashboard/admin?período=${diffDays}`;
                const res = await fetchAutenticado(url);
                
                if (res.ok) {
                    const data = await res.json();
                    console.log('Dashboard Admin dados:', data);
                    
                    // Extrair métricas do retorno
                    const metricas = data.metricas || {};
                    const stats = {
                        faturamento: metricas.valor_faturado || 0,
                        totalVendas: metricas.total_pedidos || 0,
                        ticketMedio: metricas.ticket_medio || 0,
                        taxaConversao: data.taxaConversao || 0
                    };
                    atualizarEstatisticas(stats);
                } else {
                    // Tentar API alternativa dashboard-stats
                    const statsRes = await fetchAutenticado('/api/vendas/dashboard-stats');
                    if (statsRes.ok) {
                        const statsData = await statsRes.json();
                        console.log('Dashboard Stats dados:', statsData);
                        atualizarEstatisticas({
                            faturamento: statsData.totalFaturadoMes || 0,
                            totalVendas: (statsData.pedidosPendentes || 0) + (statsData.orçamentosAberto || 0),
                            ticketMedio: 0,
                            taxaConversao: 0
                        });
                    }
                }
            } catch (error) {
                console.warn('Erro ao carregar estatísticas:', error);
            }
        }

        function mostrarEstadoVazio(mensagem) {
            console.log('📊 Exibindo estado vazio:', mensagem);
            
            // Zerar estatísticas
            atualizarEstatisticas({ faturamento: 0, totalVendas: 0, ticketMedio: 0, taxaConversao: 0 });
            
            // Gráficos vazios
            renderizarGraficoVendas({ labels: [], valores: [] });
            renderizarGraficoCategorias({ labels: [], valores: [] });
            
            // Tabelas vazias
            renderizarTopVendedores([]);
            renderizarTopProdutos([]);
            
            // Mensagem ao usuário
            if (mensagem) {
                const alertDiv = document.createElement('div');
                alertDiv.className = 'alert-info-relatorio';
                alertDiv.innerHTML = `<i class="fas fa-info-circle"></i> ${mensagem}`;
                alertDiv.style.cssText = 'background:#eff6ff;border:1px solid #bfdbfe;color:#1e40af;padding:12px 16px;border-radius:8px;margin:8px 24px;font-size:14px;display:flex;align-items:center;gap:8px;';
                
                // Remover alerta anterior se existir
                const alertaAnterior = document.querySelector('.alert-info-relatorio');
                if (alertaAnterior) alertaAnterior.remove();
                
                const mainContent = document.querySelector('.main-content') || document.querySelector('.content-area');
                if (mainContent) mainContent.prepend(alertDiv);
            }
        }

        function atualizarEstatisticas(stats) {
            const formatarMoeda = (valor) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                }).format(valor || 0);
            };

            document.getElementById('faturamentoTotal').textContent = formatarMoeda(stats.faturamento || 0);
            document.getElementById('totalVendas').textContent = stats.totalVendas || 0;
            document.getElementById('ticketMedio').textContent = formatarMoeda(stats.ticketMedio || 0);
            document.getElementById('taxaConversao').textContent = `${stats.taxaConversao || 0}%`;
        }

        async function carregarGraficoVendas(dataInicio, dataFim, vendedor) {
            try {
                // Usar API dashboard/monthly que retorna Evolução mensal
                const url = `/api/vendas/dashboard/monthly?months=6`;
                const res = await fetchAutenticado(url);
                
                if (res.ok) {
                    const dados = await res.json();
                    console.log('Evolução de vendas:', dados);
                    renderizarGraficoVendas({
                        labels: dados.labels || [],
                        valores: dados.values || []
                    });
                } else {
                    console.warn('Falha ao carregar Evolução de vendas');
                    renderizarGraficoVendas({ labels: [], valores: [] });
                }
            } catch (error) {
                console.error('Erro ao carregar gráfico de vendas:', error);
                renderizarGraficoVendas({ labels: [], valores: [] });
            }
        }

        function renderizarGraficoVendas(dados) {
            const ctx = document.getElementById('vendasChart').getContext('2d');
            
            if (vendasChart) vendasChart.destroy();
            
            vendasChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dados.labels || ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [{
                        label: 'Vendas',
                        data: dados.valores || [0, 0, 0, 0, 0, 0],
                        borderColor: '#6366f1',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#6366f1',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Demo removido - usar dados reais da API

        async function carregarGraficoCategorias(dataInicio, dataFim, vendedor) {
            try {
                // Usar dados do dashboard/admin que tem conversaoPorStatus
                const inicio = new Date(dataInicio);
                const fim = new Date(dataFim);
                const diffTime = Math.abs(fim - inicio);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) || 30;
                
                const url = `/api/vendas/dashboard/admin?período=${diffDays}`;
                const res = await fetchAutenticado(url);
                
                if (res.ok) {
                    const data = await res.json();
                    console.log('Dados dashboard para categorias:', data);
                    
                    // Usar dados de conversão por status
                    if (data.conversaoPorStatus && data.conversaoPorStatus.length > 0) {
                        const statusLabels = {
                            'faturado': 'Faturado',
                            'orçamento': 'Orçamento', 
                            'analise': 'Em Análise',
                            'aprovado': 'Aprovado',
                            'cancelado': 'Cancelado',
                            'recibo': 'Recibo'
                        };
                        
                        const labels = data.conversaoPorStatus.map(s => statusLabels[s.status] || s.status);
                        const valores = data.conversaoPorStatus.map(s => s.quantidade);
                        
                        renderizarGraficoCategorias({
                            labels: labels,
                            valores: valores
                        });
                    } else {
                        renderizarGraficoCategorias({ labels: [], valores: [] });
                    }
                } else {
                    console.warn('Falha ao carregar gráfico de categorias');
                    renderizarGraficoCategorias({ labels: [], valores: [] });
                }
            } catch (error) {
                console.error('Erro ao carregar gráfico de categorias:', error);
                renderizarGraficoCategorias({ labels: [], valores: [] });
            }
        }

        function renderizarGraficoCategorias(dados) {
            const ctx = document.getElementById('categoriasChart').getContext('2d');
            
            if (categoriasChart) categoriasChart.destroy();
            
            // Cores por status
            const coresPorStatus = {
                'Faturado': '#10b981',
                'Orçamento': '#6366f1',
                'Em Análise': '#f59e0b',
                'Aprovado': '#3b82f6',
                'Cancelado': '#ef4444',
                'Recibo': '#8b5cf6'
            };
            
            const labels = dados.labels || ['Faturado', 'Orçamento', 'Em Análise', 'Aprovado'];
            const cores = labels.map(l => coresPorStatus[l] || '#64748b');
            
            categoriasChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: dados.valores || [40, 30, 20, 10],
                        backgroundColor: cores,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { padding: 20, usePointStyle: true }
                        }
                    },
                    cutout: '65%'
                }
            });
        }

        // Demo removido - usar dados reais da API

        async function carregarTopVendedores(dataInicio, dataFim) {
            try {
                // Usar a API correta: /api/vendas/dashboard/top-vendedores
                const url = `/api/vendas/dashboard/top-vendedores?data_inicio=${dataInicio}&data_fim=${dataFim}&limit=5`;
                const res = await fetchAutenticado(url);
                
                if (res.ok) {
                    const vendedores = await res.json();
                    console.log('Top Vendedores carregados:', vendedores);
                    renderizarTopVendedores(vendedores);
                } else {
                    console.warn('Falha ao carregar top vendedores, status:', res.status);
                    renderizarTopVendedores([]);
                }
            } catch (error) {
                console.error('Erro ao carregar top vendedores:', error);
                renderizarTopVendedores([]);
            }
        }

        function renderizarTopVendedores(vendedores) {
            const tbody = document.getElementById('topVendedoresBody');
            
            if (!vendedores || vendedores.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;padding:20px;color:#64748b;">Nenhum dado disponível</td></tr>';
                return;
            }

            const formatarMoeda = (valor) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor || 0);
            const getRankClass = (i) => i === 0 ? 'gold' : i === 1 ? 'silver' : i === 2 ? 'bronze' : 'normal';

            tbody.innerHTML = vendedores.map((v, i) => `
                <tr>
                    <td><span class="rank-badge ${getRankClass(i)}">${i + 1}</span></td>
                    <td>
                        <div class="vendedor-info">
                            ${v.foto 
                                ? `<img src="${v.foto}" alt="${v.nome}" class="vendedor-avatar-img" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">
                                   <div class="vendedor-avatar" style="display:none;">${(v.nome || 'V')[0]}</div>`
                                : `<div class="vendedor-avatar">${(v.nome || 'V')[0]}</div>`
                            }
                            <span class="vendedor-name">${v.nome || 'Vendedor'}</span>
                        </div>
                    </td>
                    <td>${v.vendas || v.total_vendas || 0}</td>
                    <td class="valor-positivo">${formatarMoeda(v.valor || v.valor_total || 0)}</td>
                </tr>
            `).join('');
        }

        // Demo removido - usar dados reais da API

        async function carregarTopProdutos(dataInicio, dataFim, vendedor) {
            try {
                // Usar a API correta: /api/vendas/dashboard/top-produtos
                const url = `/api/vendas/dashboard/top-produtos?data_inicio=${dataInicio}&data_fim=${dataFim}&limit=5`;
                const res = await fetchAutenticado(url);
                
                if (res.ok) {
                    const produtos = await res.json();
                    console.log('Top Produtos carregados:', produtos);
                    renderizarTopProdutos(produtos);
                } else {
                    console.warn('Falha ao carregar top produtos, status:', res.status);
                    renderizarTopProdutos([]);
                }
            } catch (error) {
                console.error('Erro ao carregar top produtos:', error);
                renderizarTopProdutos([]);
            }
        }

        function renderizarTopProdutos(produtos) {
            const tbody = document.getElementById('topProdutosBody');
            
            if (!produtos || produtos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;padding:20px;color:#64748b;">Nenhum dado disponível</td></tr>';
                return;
            }

            const formatarMoeda = (valor) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor || 0);
            const getRankClass = (i) => i === 0 ? 'gold' : i === 1 ? 'silver' : i === 2 ? 'bronze' : 'normal';

            tbody.innerHTML = produtos.map((p, i) => `
                <tr>
                    <td><span class="rank-badge ${getRankClass(i)}">${i + 1}</span></td>
                    <td>${p.nome || p.codigo || p.produto || 'Produto'}</td>
                    <td>${p.quantidade || 0}</td>
                    <td class="valor-positivo">${formatarMoeda(p.valor || p.valor_total || 0)}</td>
                </tr>
            `).join('');
        }

        // Demo removido - usar dados reais da API

        // Carregar vendedores no filtro principal - COM FILTRO DE SEGURANÇA
        async function carregarVendedores() {
            try {
                const res = await fetchAutenticado('/api/vendas/vendedores');
                if (res.ok) {
                    let vendedores = await res.json();
                    const select = document.getElementById('filterVendedor');
                    
                    // ========================================
                    // SEGURANÇA: Filtrar vendedores por permissão
                    // ========================================
                    const supervisor = isSupervisor();
                    const meuVendedorId = getVendedorIdUsuarioLogado();
                    
                    console.log('🔒 [FILTRO] Carregando vendedores - Supervisor:', supervisor, '| Meu ID:', meuVendedorId);
                    
                    if (supervisor) {
                        // Supervisores podem ver todos os vendedores
                        // Mantém a opção "Todos os vendedores" que já existe no HTML
                        vendedores.forEach(v => {
                            const option = document.createElement('option');
                            option.value = v.id;
                            option.textContent = v.nome;
                            select.appendChild(option);
                        });
                    } else {
                        // Vendedor comum: só pode ver seus próprios dados
                        // Remove a opção "Todos os vendedores"
                        select.innerHTML = '';
                        
                        if (meuVendedorId) {
                            // Encontrar o vendedor logado na lista
                            const meuVendedor = vendedores.find(v => v.id === meuVendedorId || v.id == meuVendedorId);
                            
                            if (meuVendedor) {
                                const option = document.createElement('option');
                                option.value = meuVendedor.id;
                                option.textContent = meuVendedor.nome;
                                option.selected = true;
                                select.appendChild(option);
                            } else {
                                // Não encontrou na lista, usar dados do usuário
                                const option = document.createElement('option');
                                option.value = meuVendedorId;
                                option.textContent = usuarioLogado?.nome || 'Meu Vendedor';
                                option.selected = true;
                                select.appendChild(option);
                            }
                        } else {
                            // Não conseguiu identificar o vendedor, mostrar apenas próprio usuário
                            const option = document.createElement('option');
                            option.value = '';
                            option.textContent = usuarioLogado?.nome || 'Selecione...';
                            option.selected = true;
                            select.appendChild(option);
                        }
                        
                        console.log('🔒 [FILTRO] Vendedor filtrado para:', select.options[0]?.textContent || 'nenhum');
                    }
                }
            } catch (error) {
                console.error('Erro ao carregar vendedores:', error);
            }
        }

        // ==================== AÇÕES ====================
        function imprimirRelatorio() {
            // Impressão direta da página com CSS otimizado para print
            const style = document.createElement('style');
            style.id = 'print-style-temp';
            style.textContent = `
                @media print {
                    body * { visibility: hidden; }
                    .page-content, .page-content * { visibility: visible; }
                    .page-content { position: absolute; left: 0; top: 0; width: 100%; }
                    .sidebar, .header, .page-header .page-actions, .filters-card .btn, .quick-reports, .stat-menu { display: none !important; }
                    .page-header { box-shadow: none !important; border: 1px solid #e2e8f0; }
                    .stat-card, .chart-card, .table-card { box-shadow: none !important; border: 1px solid #e2e8f0; break-inside: avoid; }
                    .charts-grid { break-inside: avoid; }
                }
            `;
            document.head.appendChild(style);
            window.print();
            setTimeout(() => style.remove(), 1000);
        }

        function exportarPDF() {
            // Coletar dados reais da página
            
            // Mostrar toast de loading
            const toast = document.createElement('div');
            toast.style.cssText = 'position:fixed;top:20px;right:20px;background:#1e293b;color:white;padding:16px 24px;border-radius:12px;z-index:10000;display:flex;align-items:center;gap:12px;box-shadow:0 10px 40px rgba(0,0,0,0.2);';
            toast.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Gerando PDF...';
            document.body.appendChild(toast);
            
            // Pegar dados dos stats pelos IDs reais
            const totalVendas = document.getElementById('faturamentoTotal')?.textContent || 'R$ 0,00';
            const totalPedidos = document.getElementById('totalVendas')?.textContent || '0';
            const ticketMedio = document.getElementById('ticketMedio')?.textContent || 'R$ 0,00';
            const conversao = document.getElementById('taxaConversao')?.textContent || '0%';
            
            const dataInicio = document.getElementById('filterDataInicio')?.value || '';
            const dataFim = document.getElementById('filterDataFim')?.value || '';
            const vendedorSelecionado = document.getElementById('filterVendedor')?.selectedOptions[0]?.text || 'Todos os vendedores';
            
            const periodoTexto = dataInicio && dataFim 
                ? `${new Date(dataInicio).toLocaleDateString('pt-BR')} a ${new Date(dataFim).toLocaleDateString('pt-BR')}`
                : 'Período completo';
            
            setTimeout(() => {
                // Criar iframe para impressão
                const iframe = document.createElement('iframe');
                iframe.style.position = 'fixed';
                iframe.style.right = '0';
                iframe.style.bottom = '0';
                iframe.style.width = '0';
                iframe.style.height = '0';
                iframe.style.border = '0';
                document.body.appendChild(iframe);
                
                const doc = iframe.contentWindow.document;
                doc.open();
                doc.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>Aluforce: Relatório de Vendas</title>
                        <style>
                            @page { size: A4 portrait; margin: 10mm 12mm; }
                            * { margin: 0; padding: 0; box-sizing: border-box; }
                            body { font-family: 'Segoe UI', Arial, sans-serif; font-size: 10px; color: #1a1a1a; background: #fff; }
                            
                            .container { max-width: 100%; padding: 0; }
                            
                            /* Header */
                            .header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px; }
                            .logo-area img { height: 40px; width: auto; }
                            .empresa-info { text-align: right; font-size: 8px; color: #4a5568; line-height: 1.4; }
                            .empresa-info .razao { font-weight: 700; color: #1a365d; font-size: 10px; margin-bottom: 2px; }
                            .header-line { height: 3px; background: linear-gradient(90deg, #1a365d, #2c5282, #3182ce); margin-bottom: 10px; }
                            
                            /* Título */
                            .doc-title { background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%); color: #fff; padding: 10px 15px; margin-top: 8px; text-align: center; }
                            .doc-title h1 { font-size: 14px; font-weight: 700; letter-spacing: 0.5px; margin: 0; }
                            .doc-title .periodo { font-size: 10px; color: #90cdf4; margin-top: 3px; }
                            
                            /* KPIs */
                            .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin: 15px 0; }
                            .kpi-card { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px; text-align: center; }
                            .kpi-card.orange { border-top: 3px solid #f97316; }
                            .kpi-card.blue { border-top: 3px solid #3b82f6; }
                            .kpi-card.green { border-top: 3px solid #10b981; }
                            .kpi-card.purple { border-top: 3px solid #8b5cf6; }
                            .kpi-value { font-size: 18px; font-weight: 700; color: #1a365d; }
                            .kpi-label { font-size: 9px; color: #64748b; margin-top: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
                            
                            /* Seções */
                            .section { margin-top: 15px; }
                            .section-header { background: #2c5282; color: #fff; padding: 6px 12px; font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
                            .section-content { border: 1px solid #e2e8f0; border-top: none; padding: 12px; background: #fff; }
                            
                            /* Tabela */
                            table { width: 100%; border-collapse: collapse; }
                            th { background: #1a365d; color: #fff; padding: 8px 10px; font-size: 8px; font-weight: 700; text-transform: uppercase; text-align: left; }
                            td { padding: 8px 10px; border-bottom: 1px solid #e2e8f0; font-size: 9px; }
                            tr:nth-child(even) { background: #f8fafc; }
                            tr:hover { background: #f0f9ff; }
                            
                            /* Info adicional */
                            .info-box { background: #fff; border: 1px solid #e2e8f0; padding: 10px 12px; font-size: 9px; margin-top: 10px; }
                            .info-row { margin: 4px 0; }
                            .info-row strong { color: #64748b; }
                            
                            /* Footer */
                            .footer { margin-top: 20px; padding-top: 10px; border-top: 2px solid #1a365d; font-size: 8px; color: #64748b; text-align: center; }
                            .footer-logo { font-weight: 700; color: #1a365d; font-size: 10px; }
                            
                            @media print { 
                                body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                                html { margin-top: 0 !important; }
                                body::before, body::after { display: none !important; }
                            }
                        </style>
</head>
                    <body>
                        <div class="container">
                            <!-- HEADER -->
                            <div class="header">
                                <div class="logo-area">
                                    <img src="/images/Logo Monocromatico - Azul - Aluforce.png" alt="ALUFORCE" onerror="this.outerHTML='<div style=font-size:20px;font-weight:700;color:#1a365d>ALUFORCE</div>'">
                                </div>
                                <div class="empresa-info">
                                    <div class="razao">I. M. DOS REIS INDÚSTRIA E COMÉRCIO DE CONDUTORES</div>
                                    <div>CNPJ: 08.192.479/0001-60 | IE: 103.385.861-110</div>
                                    <div>RUA ERNESTINA, 270 - VILA SÃO JOÃO</div>
                                    <div>Ferraz de Vasconcelos - SP | CEP: 08527-400</div>
                                </div>
                            </div>
                            <div class="header-line"></div>
                            
                            <!-- TÍTULO -->
                            <div class="doc-title">
                                <h1>RELATÓRIO DE VENDAS</h1>
                                <div class="periodo">${periodoTexto} | ${vendedorSelecionado}</div>
                            </div>
                            
                            <!-- KPIs -->
                            <div class="kpi-grid">
                                <div class="kpi-card orange">
                                    <div class="kpi-value">${totalVendas}</div>
                                    <div class="kpi-label">Total em Vendas</div>
                                </div>
                                <div class="kpi-card blue">
                                    <div class="kpi-value">${totalPedidos}</div>
                                    <div class="kpi-label">Total de Pedidos</div>
                                </div>
                                <div class="kpi-card green">
                                    <div class="kpi-value">${ticketMedio}</div>
                                    <div class="kpi-label">Ticket Médio</div>
                                </div>
                                <div class="kpi-card purple">
                                    <div class="kpi-value">${conversao}</div>
                                    <div class="kpi-label">Taxa de Conversão</div>
                                </div>
                            </div>
                            
                            <!-- TOP VENDEDORES -->
                            <div class="section">
                                <div class="section-header">Top Vendedores</div>
                                <div class="section-content">
                                    <table>
                                        <thead><tr><th>#</th><th>Vendedor</th><th>Vendas</th><th>Valor Total</th></tr></thead>
                                        <tbody>${(() => {
                                            const rows = document.querySelectorAll('#topVendedoresBody tr');
                                            let html = '';
                                            rows.forEach(row => {
                                                const cells = row.querySelectorAll('td');
                                                if (cells.length >= 4) {
                                                    html += '<tr>';
                                                    cells.forEach(c => html += '<td>' + c.textContent.trim() + '</td>');
                                                    html += '</tr>';
                                                }
                                            });
                                            return html || '<tr><td colspan="4" style="text-align:center;padding:12px;">Sem dados</td></tr>';
                                        })()}</tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- TOP PRODUTOS -->
                            <div class="section">
                                <div class="section-header">Produtos Mais Vendidos</div>
                                <div class="section-content">
                                    <table>
                                        <thead><tr><th>#</th><th>Produto</th><th>Qtd</th><th>Valor</th></tr></thead>
                                        <tbody>${(() => {
                                            const rows = document.querySelectorAll('#topProdutosBody tr');
                                            let html = '';
                                            rows.forEach(row => {
                                                const cells = row.querySelectorAll('td');
                                                if (cells.length >= 4) {
                                                    html += '<tr>';
                                                    cells.forEach(c => html += '<td>' + c.textContent.trim() + '</td>');
                                                    html += '</tr>';
                                                }
                                            });
                                            return html || '<tr><td colspan="4" style="text-align:center;padding:12px;">Sem dados</td></tr>';
                                        })()}</tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- INFO -->
                            <div class="info-box">
                                <div class="info-row"><strong>Gerado em:</strong> ${new Date().toLocaleString('pt-BR')}</div>
                                <div class="info-row"><strong>Filtros aplicados:</strong> Período: ${periodoTexto} | Vendedor: ${vendedorSelecionado}</div>
                            </div>
                            
                            <!-- FOOTER -->
                            <div class="footer">
                                <div class="footer-logo">ALUFORCE - Sistema de Gestão Empresarial</div>
                                <div style="margin-top: 3px;">Este documento foi gerado automaticamente pelo sistema ALUFORCE ERP</div>
                            </div>
                        </div>
                    </html>
                `);
                doc.close();
                
                setTimeout(() => {
                    iframe.contentWindow.focus();
                    iframe.contentWindow.print();
                    toast.innerHTML = '<i class="fas fa-check-circle" style="color:#22c55e;"></i> PDF pronto para impressão!';
                    setTimeout(() => {
                        toast.remove();
                        iframe.remove();
                    }, 3000);
                }, 500);
            }, 500);
        }
        
        function exportarExcel() {
            // Mostrar toast de loading
            const toast = document.createElement('div');
            toast.style.cssText = 'position:fixed;top:20px;right:20px;background:#1e293b;color:white;padding:16px 24px;border-radius:12px;z-index:10000;display:flex;align-items:center;gap:12px;box-shadow:0 10px 40px rgba(0,0,0,0.2);';
            toast.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Gerando Excel...';
            document.body.appendChild(toast);
            
            // Pegar dados reais dos stats pelos IDs
            const totalVendas = document.getElementById('faturamentoTotal')?.textContent || 'R$ 0,00';
            const totalPedidos = document.getElementById('totalVendas')?.textContent || '0';
            const ticketMedio = document.getElementById('ticketMedio')?.textContent || 'R$ 0,00';
            const conversao = document.getElementById('taxaConversao')?.textContent || '0%';
            
            const dataInicio = document.getElementById('filterDataInicio')?.value || '';
            const dataFim = document.getElementById('filterDataFim')?.value || '';
            const vendedorSelecionado = document.getElementById('filterVendedor')?.selectedOptions[0]?.text || 'Todos os vendedores';
            const periodoTexto = dataInicio && dataFim
                ? new Date(dataInicio).toLocaleDateString('pt-BR') + ' a ' + new Date(dataFim).toLocaleDateString('pt-BR')
                : 'Período completo';
            const escXml = (s) => String(s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
            const dataHoje = new Date().toLocaleDateString('pt-BR');
            const horaAtual = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            
            // Coletar dados reais das tabelas
            const vendedores = [];
            document.querySelectorAll('#topVendedoresBody tr').forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    vendedores.push({
                        rank: cells[0].textContent.trim(),
                        nome: cells[1].textContent.trim(),
                        vendas: cells[2].textContent.trim(),
                        valor: cells[3].textContent.trim()
                    });
                }
            });
            const produtos = [];
            document.querySelectorAll('#topProdutosBody tr').forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 4) {
                    produtos.push({
                        rank: cells[0].textContent.trim(),
                        nome: cells[1].textContent.trim(),
                        qtd: cells[2].textContent.trim(),
                        valor: cells[3].textContent.trim()
                    });
                }
            });

            // Gerar Excel XML Spreadsheet
            let xml = `<?xml version="1.0" encoding="UTF-8"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
<Styles>
 <Style ss:ID="titulo"><Font ss:Bold="1" ss:Color="#1A365D" ss:Size="16" ss:FontName="Segoe UI"/><Alignment ss:Horizontal="Left" ss:Vertical="Center"/></Style>
 <Style ss:ID="subtitulo"><Font ss:Color="#64748B" ss:Size="10" ss:FontName="Segoe UI"/></Style>
 <Style ss:ID="kpiLabel"><Font ss:Bold="1" ss:Color="#334155" ss:Size="10" ss:FontName="Segoe UI"/><Interior ss:Color="#F1F5F9" ss:Pattern="Solid"/><Alignment ss:Horizontal="Right" ss:Vertical="Center"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#E2E8F0"/></Borders></Style>
 <Style ss:ID="kpiValor"><Font ss:Bold="1" ss:Color="#1E40AF" ss:Size="12" ss:FontName="Segoe UI"/><Interior ss:Color="#F1F5F9" ss:Pattern="Solid"/><Alignment ss:Horizontal="Center" ss:Vertical="Center"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#E2E8F0"/></Borders></Style>
 <Style ss:ID="secao"><Font ss:Bold="1" ss:Color="#FFFFFF" ss:Size="11" ss:FontName="Segoe UI"/><Interior ss:Color="#1A365D" ss:Pattern="Solid"/><Alignment ss:Horizontal="Left" ss:Vertical="Center"/></Style>
 <Style ss:ID="header"><Font ss:Bold="1" ss:Color="#FFFFFF" ss:Size="10" ss:FontName="Segoe UI"/><Interior ss:Color="#2C5282" ss:Pattern="Solid"/><Alignment ss:Horizontal="Center" ss:Vertical="Center"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#2C5282"/></Borders></Style>
 <Style ss:ID="normal"><Font ss:Size="10" ss:FontName="Segoe UI" ss:Color="#1E293B"/><Alignment ss:Vertical="Center"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#F1F5F9"/></Borders></Style>
 <Style ss:ID="rank"><Font ss:Bold="1" ss:Size="10" ss:FontName="Segoe UI" ss:Color="#F97316"/><Alignment ss:Horizontal="Center" ss:Vertical="Center"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#F1F5F9"/></Borders></Style>
 <Style ss:ID="valor"><Font ss:Size="10" ss:FontName="Segoe UI" ss:Color="#059669"/><Alignment ss:Horizontal="Right" ss:Vertical="Center"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#F1F5F9"/></Borders></Style>
 <Style ss:ID="rodape"><Font ss:Color="#94A3B8" ss:Size="9" ss:FontName="Segoe UI" ss:Italic="1"/><Alignment ss:Horizontal="Center" ss:Vertical="Center"/></Style>
</Styles>
<Worksheet ss:Name="Relatorio Vendas">
 <Table ss:DefaultRowHeight="22">
  <Column ss:Index="1" ss:Width="50"/>
  <Column ss:Index="2" ss:Width="250"/>
  <Column ss:Index="3" ss:Width="120"/>
  <Column ss:Index="4" ss:Width="150"/>
`;
            // Título
            xml += `  <Row ss:Height="35"><Cell ss:StyleID="titulo" ss:MergeAcross="3"><Data ss:Type="String">ALUFORCE  |  Relatório de Vendas</Data></Cell></Row>
  <Row ss:Height="18"><Cell ss:StyleID="subtitulo" ss:MergeAcross="3"><Data ss:Type="String">I. M. DOS REIS INDÚSTRIA E COMÉRCIO DE CONDUTORES | CNPJ: 08.192.479/0001-60</Data></Cell></Row>
  <Row ss:Height="18"><Cell ss:StyleID="subtitulo" ss:MergeAcross="3"><Data ss:Type="String">Período: ${escXml(periodoTexto)} | Vendedor: ${escXml(vendedorSelecionado)} | Gerado em ${dataHoje} às ${horaAtual}</Data></Cell></Row>
  <Row ss:Height="10"></Row>
`;
            // KPIs
            xml += `  <Row ss:Height="26">
   <Cell ss:StyleID="kpiLabel"><Data ss:Type="String">Faturamento Total</Data></Cell>
   <Cell ss:StyleID="kpiValor"><Data ss:Type="String">${escXml(totalVendas)}</Data></Cell>
   <Cell ss:StyleID="kpiLabel"><Data ss:Type="String">Total Pedidos</Data></Cell>
   <Cell ss:StyleID="kpiValor"><Data ss:Type="String">${escXml(totalPedidos)}</Data></Cell>
  </Row>
  <Row ss:Height="26">
   <Cell ss:StyleID="kpiLabel"><Data ss:Type="String">Ticket Médio</Data></Cell>
   <Cell ss:StyleID="kpiValor"><Data ss:Type="String">${escXml(ticketMedio)}</Data></Cell>
   <Cell ss:StyleID="kpiLabel"><Data ss:Type="String">Taxa Conversão</Data></Cell>
   <Cell ss:StyleID="kpiValor"><Data ss:Type="String">${escXml(conversao)}</Data></Cell>
  </Row>
  <Row ss:Height="10"></Row>
`;
            // Top Vendedores
            xml += `  <Row ss:Height="26"><Cell ss:StyleID="secao" ss:MergeAcross="3"><Data ss:Type="String">TOP VENDEDORES</Data></Cell></Row>
  <Row ss:Height="24">
   <Cell ss:StyleID="header"><Data ss:Type="String">#</Data></Cell>
   <Cell ss:StyleID="header"><Data ss:Type="String">Vendedor</Data></Cell>
   <Cell ss:StyleID="header"><Data ss:Type="String">Vendas</Data></Cell>
   <Cell ss:StyleID="header"><Data ss:Type="String">Valor Total</Data></Cell>
  </Row>
`;
            if (vendedores.length > 0) {
                vendedores.forEach(v => {
                    xml += `  <Row><Cell ss:StyleID="rank"><Data ss:Type="String">${escXml(v.rank)}</Data></Cell><Cell ss:StyleID="normal"><Data ss:Type="String">${escXml(v.nome)}</Data></Cell><Cell ss:StyleID="normal"><Data ss:Type="String">${escXml(v.vendas)}</Data></Cell><Cell ss:StyleID="valor"><Data ss:Type="String">${escXml(v.valor)}</Data></Cell></Row>\n`;
                });
            } else {
                xml += `  <Row><Cell ss:StyleID="normal" ss:MergeAcross="3"><Data ss:Type="String">Nenhum dado disponível</Data></Cell></Row>\n`;
            }
            xml += `  <Row ss:Height="10"></Row>\n`;
            // Top Produtos
            xml += `  <Row ss:Height="26"><Cell ss:StyleID="secao" ss:MergeAcross="3"><Data ss:Type="String">PRODUTOS MAIS VENDIDOS</Data></Cell></Row>
  <Row ss:Height="24">
   <Cell ss:StyleID="header"><Data ss:Type="String">#</Data></Cell>
   <Cell ss:StyleID="header"><Data ss:Type="String">Produto</Data></Cell>
   <Cell ss:StyleID="header"><Data ss:Type="String">Qtd</Data></Cell>
   <Cell ss:StyleID="header"><Data ss:Type="String">Valor</Data></Cell>
  </Row>
`;
            if (produtos.length > 0) {
                produtos.forEach(p => {
                    xml += `  <Row><Cell ss:StyleID="rank"><Data ss:Type="String">${escXml(p.rank)}</Data></Cell><Cell ss:StyleID="normal"><Data ss:Type="String">${escXml(p.nome)}</Data></Cell><Cell ss:StyleID="normal"><Data ss:Type="String">${escXml(p.qtd)}</Data></Cell><Cell ss:StyleID="valor"><Data ss:Type="String">${escXml(p.valor)}</Data></Cell></Row>\n`;
                });
            } else {
                xml += `  <Row><Cell ss:StyleID="normal" ss:MergeAcross="3"><Data ss:Type="String">Nenhum dado disponível</Data></Cell></Row>\n`;
            }
            // Rodapé
            xml += `  <Row ss:Height="10"></Row>
  <Row ss:Height="20"><Cell ss:StyleID="rodape" ss:MergeAcross="3"><Data ss:Type="String">ALUFORCE — Sistema de Gestão Empresarial | Relatório gerado em ${dataHoje} às ${horaAtual}</Data></Cell></Row>
`;
            xml += ` </Table>
 <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
  <FitToPage/><Print><FitWidth>1</FitWidth><FitHeight>0</FitHeight></Print>
  <Selected/><FreezePanes/><FrozenNoSplit/>
  <SplitHorizontal>4</SplitHorizontal><TopRowBottomPane>4</TopRowBottomPane>
 </WorksheetOptions>
</Worksheet>
</Workbook>`;

            const blob = new Blob([xml], { type: 'application/vnd.ms-excel;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'relatorio_vendas_aluforce_' + new Date().toISOString().split('T')[0] + '.xls';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
            
            toast.innerHTML = '<i class="fas fa-check-circle" style="color:#22c55e;"></i> Excel baixado com sucesso!';
            setTimeout(() => toast.remove(), 3000);
        }

        async function gerarRelatorio(tipo) {
            const tiposRelatorio = {
                'vendas-periodo': 'Vendas por Período',
                'comissoes': 'Relatório de Comissões',
                'clientes': 'Análise de Clientes',
                'produtos': 'Performance de Produtos'
            };
            const titulo = tiposRelatorio[tipo] || tipo;
            
            // Mostrar toast de loading
            const toast = document.createElement('div');
            toast.style.cssText = 'position:fixed;top:20px;right:20px;background:#1e293b;color:white;padding:16px 24px;border-radius:12px;z-index:10000;display:flex;align-items:center;gap:12px;box-shadow:0 10px 40px rgba(0,0,0,0.2);';
            toast.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Gerando ${titulo}...`;
            document.body.appendChild(toast);
            
            try {
                const dataInicio = document.getElementById('filterDataInicio').value;
                const dataFim = document.getElementById('filterDataFim').value;
                const vendedor = document.getElementById('filterVendedor').value;
                
                let csvContent = '';
                let filename = '';
                const dataHoje = new Date().toISOString().split('T')[0];
                
                if (tipo === 'vendas-periodo') {
                    // Relatório de vendas por período - buscar lista de pedidos
                    const params = new URLSearchParams({ 
                        data_inicio: dataInicio, 
                        data_fim: dataFim,
                        limite: 1000
                    });
                    if (vendedor) params.append('vendedor_id', vendedor);
                    
                    const res = await fetchAutenticado(`/api/vendas/pedidos?${params}`);
                    if (!res.ok) throw new Error('Erro ao buscar dados');
                    const pedidos = await res.json();
                    
                    csvContent = 'RELATÓRIO DE VENDAS POR PERÍODO\n';
                    csvContent += `Período: ${dataInicio} a ${dataFim}\n\n`;
                    csvContent += 'DATA;PEDIDO;CLIENTE;VENDEDOR;VALOR;STATUS\n';
                    
                    if (pedidos && pedidos.length > 0) {
                        let totalValor = 0;
                        let totalVendas = 0;
                        pedidos.forEach(p => {
                            const data = p.data_pedido || p.created_at || '';
                            const dataFormatada = data ? new Date(data).toLocaleDateString('pt-BR') : '';
                            const valor = parseFloat(p.valor_total || p.valor || 0);
                            totalValor += valor;
                            if (p.status === 'faturado') totalVendas++;
                            csvContent += `${dataFormatada};${p.numero || p.id || ''};${p.cliente_nome || ''};${p.vendedor_nome || ''};${valor.toFixed(2).replace('.', ',')};${p.status || ''}\n`;
                        });
                        csvContent += `\nTOTAL DE PEDIDOS: ${pedidos.length}\n`;
                        csvContent += `PEDIDOS FATURADOS: ${totalVendas}\n`;
                        csvContent += `VALOR TOTAL: R$ ${totalValor.toFixed(2).replace('.', ',')}\n`;
                    } else {
                        csvContent += 'Nenhum registro encontrado no período\n';
                    }
                    filename = `vendas_periodo_${dataInicio}_${dataFim}.csv`;
                    
                } else if (tipo === 'comissoes') {
                    // Relatório de comissões por vendedor
                    // Calcular período em dias
                    const diffTime = Math.abs(new Date(dataFim) - new Date(dataInicio));
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) || 30;
                    
                    const res = await fetchAutenticado(`/api/vendas/dashboard/top-vendedores?limit=100&period=${diffDays}`);
                    if (!res.ok) throw new Error('Erro ao buscar dados');
                    const vendedores = await res.json();
                    
                    csvContent = 'RELATÓRIO DE COMISSÕES\n';
                    csvContent += `Período: ${dataInicio} a ${dataFim}\n\n`;
                    csvContent += 'VENDEDOR;TOTAL VENDAS;VALOR FATURADO;COMISSÃO (5%)\n';
                    
                    if (vendedores && vendedores.length > 0) {
                        let totalGeral = 0;
                        let comissaoGeral = 0;
                        vendedores.forEach(v => {
                            const valor = parseFloat(v.valor || 0);
                            const comissao = valor * 0.05;
                            totalGeral += valor;
                            comissaoGeral += comissao;
                            csvContent += `${v.nome || ''};${v.vendas || 0};${valor.toFixed(2).replace('.', ',')};${comissao.toFixed(2).replace('.', ',')}\n`;
                        });
                        csvContent += `\nTOTAL GERAL;;${totalGeral.toFixed(2).replace('.', ',')};${comissaoGeral.toFixed(2).replace('.', ',')}\n`;
                    } else {
                        csvContent += 'Nenhum registro encontrado no período\n';
                    }
                    filename = `comissoes_${dataInicio}_${dataFim}.csv`;
                    
                } else if (tipo === 'clientes') {
                    // Análise de clientes - buscar lista de clientes
                    const res = await fetchAutenticado('/api/vendas/clientes');
                    let clientes = [];
                    if (res.ok) {
                        const dados = await res.json();
                        clientes = dados.clientes || dados || [];
                    }
                    
                    csvContent = 'ANÁLISE DE CLIENTES\n';
                    csvContent += `Data de geração: ${new Date().toLocaleDateString('pt-BR')}\n\n`;
                    csvContent += 'CLIENTE;CNPJ/CPF;EMAIL;TELEFONE;CIDADE;ESTADO\n';
                    
                    if (clientes.length > 0) {
                        clientes.forEach(c => {
                            csvContent += `${c.razao_social || c.nome_fantasia || c.nome || ''};${c.cnpj || c.cpf || ''};${c.email || ''};${c.telefone || ''};${c.cidade || ''};${c.estado || c.uf || ''}\n`;
                        });
                        csvContent += `\nTOTAL DE CLIENTES: ${clientes.length}\n`;
                    } else {
                        csvContent += 'Nenhum cliente cadastrado\n';
                    }
                    filename = `analise_clientes_${dataHoje}.csv`;
                    
                } else if (tipo === 'produtos') {
                    // Performance de produtos
                    // Calcular período em dias
                    const diffTime = Math.abs(new Date(dataFim) - new Date(dataInicio));
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) || 30;
                    
                    const res = await fetchAutenticado(`/api/vendas/dashboard/top-produtos?limit=100&period=${diffDays}`);
                    if (!res.ok) throw new Error('Erro ao buscar dados');
                    const produtos = await res.json();
                    
                    csvContent = 'PERFORMANCE DE PRODUTOS\n';
                    csvContent += `Período: ${dataInicio} a ${dataFim}\n\n`;
                    csvContent += 'PRODUTO;CÓDIGO;QUANTIDADE VENDIDA;VALOR TOTAL\n';
                    
                    if (produtos && produtos.length > 0) {
                        let totalQtd = 0;
                        let totalValor = 0;
                        produtos.forEach(p => {
                            const qtd = parseInt(p.quantidade || 0);
                            const valor = parseFloat(p.valor || 0);
                            totalQtd += qtd;
                            totalValor += valor;
                            csvContent += `${p.nome || ''};${p.codigo || ''};${qtd};${valor.toFixed(2).replace('.', ',')}\n`;
                        });
                        csvContent += `\nTOTAL;;${totalQtd};${totalValor.toFixed(2).replace('.', ',')}\n`;
                    } else {
                        csvContent += 'Nenhum registro encontrado no período\n';
                    }
                    filename = `performance_produtos_${dataInicio}_${dataFim}.csv`;
                }
                
                // Gerar e baixar o arquivo CSV
                const BOM = '\uFEFF'; // Para suporte a caracteres especiais no Excel
                const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = filename;
                link.click();
                URL.revokeObjectURL(link.href);
                
                toast.innerHTML = `<i class="fas fa-check-circle" style="color:#22c55e;"></i> ${titulo} gerado com sucesso!`;
                setTimeout(() => toast.remove(), 3000);
                console.log(`✅ Relatório ${tipo} gerado e baixado: ${filename}`);
                
            } catch (error) {
                console.error(`❌ Erro ao gerar relatório ${tipo}:`, error);
                toast.innerHTML = `<i class="fas fa-exclamation-circle" style="color:#ef4444;"></i> Erro ao gerar ${titulo}`;
                setTimeout(() => toast.remove(), 4000);
            }
        }

        function atualizarGraficoVendas() {
            const tipo = document.getElementById('chartTipo').value;
            console.log('Atualizando gráfico por:', tipo);
            carregarDados();
        }

        // ==================== INICIALIZAÇÃO ====================
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('🚀 Inicializando página de relatórios...');
            
            try {
                // Definir datas padrão (últimos 30 dias)
                const hoje = new Date();
                const inicio = new Date();
                inicio.setDate(hoje.getDate() - 30);

                document.getElementById('filterDataFim').value = hoje.toISOString().split('T')[0];
                document.getElementById('filterDataInicio').value = inicio.toISOString().split('T')[0];
                
                console.log('📅 Datas definidas:', inicio.toISOString().split('T')[0], '-', hoje.toISOString().split('T')[0]);

                // Verificar autenticação via API (cookies httpOnly)
                console.log('🔍 Verificando autenticação...');
                const isAutenticado = await verificarAutenticacao();
                
                if (isAutenticado) {
                    console.log('🔑 Usuário autenticado - carregando dados reais...');
                    
                    // Carregar dados do usuário
                    try {
                        await carregarUsuario();
                    } catch (e) {
                        console.warn('⚠️ Erro ao carregar usuário:', e);
                    }
                    
                    // Carregar lista de vendedores
                    try {
                        await carregarVendedores();
                    } catch (e) {
                        console.warn('⚠️ Erro ao carregar vendedores:', e);
                    }
                    
                    // Carregar mapeamento de vendedores/supervisores dinamicamente
                    await carregarMapeamentoVendedores();
                    
                    // Carregar dados reais do relatório
                    await carregarDados();
                    
                    // Carregar mapa do Brasil
                    await carregarMapaBrasil();
                } else {
                    console.log('⚠️ Sem token - redirecionando para login');
                    mostrarEstadoVazio('Você precisa estar autenticado para visualizar os relatórios. Faça login para continuar.');
                    
                    // Mostrar estado vazio no mapa
                    const mapaContainer = document.getElementById('mapaContainer');
                    const topEstadosContainer = document.getElementById('topEstadosContainer');
                    if (mapaContainer) {
                        mapaContainer.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#94a3b8;flex-direction:column;gap:12px;"><i class="fas fa-map-marked-alt" style="font-size:48px;opacity:0.5;"></i><span>Faça login para ver dados reais</span></div>';
                    }
                    if (topEstadosContainer) {
                        topEstadosContainer.innerHTML = '<p style="color:#94a3b8;text-align:center;padding:20px;">Faça login para ver dados reais</p>';
                    }
                }
                
                console.log('✅ Inicialização concluída');
            } catch (error) {
                console.error('❌ Erro na inicialização:', error);
                mostrarEstadoVazio('Erro ao inicializar o módulo de relatórios. Tente recarregar a página.');
            }
        });

        // ==================== MAPA DO BRASIL ====================
        async function carregarMapaBrasil() {
            const mapaContainer = document.getElementById('mapaContainer');
            const topEstadosContainer = document.getElementById('topEstadosContainer');
            
            const mostrarVazio = () => {
                if (mapaContainer) {
                    mapaContainer.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#94a3b8;flex-direction:column;gap:12px;"><i class="fas fa-map-marked-alt" style="font-size:48px;opacity:0.5;"></i><span>Sem dados de vendas por estado</span></div>';
                }
                if (topEstadosContainer) {
                    topEstadosContainer.innerHTML = '<p style="color:#94a3b8;text-align:center;padding:20px;">Sem dados de vendas por estado</p>';
                }
            };
            
            try {
                const dataInicio = document.getElementById('filterDataInicio')?.value || '';
                const dataFim = document.getElementById('filterDataFim')?.value || '';
                const params = new URLSearchParams();
                if (dataInicio) params.append('dataInicio', dataInicio);
                if (dataFim) params.append('dataFim', dataFim);
                
                const res = await fetchAutenticado(`/api/vendas/relatorio/mapa-brasil?${params}`);
                
                if (res.status === 401 || res.status === 403 || res.status === 404) {
                    console.log('ℹ️ Mapa do Brasil: endpoint não disponível ou sem permissão');
                    mostrarVazio();
                    return;
                }
                
                if (res.ok) {
                    const resposta = await res.json();
                    const dadosAPI = resposta.dados || [];
                    
                    if (!dadosAPI.length) {
                        mostrarVazio();
                        return;
                    }
                    
                    // Mapear dados da API para o formato esperado pelo renderizador
                    const nomesEstados = {
                        'AC': 'Acre', 'AL': 'Alagoas', 'AP': 'Amapá', 'AM': 'Amazonas',
                        'BA': 'Bahia', 'CE': 'Ceará', 'DF': 'Distrito Federal', 'ES': 'Espírito Santo',
                        'GO': 'Goiás', 'MA': 'Maranhão', 'MT': 'Mato Grosso', 'MS': 'Mato Grosso do Sul',
                        'MG': 'Minas Gerais', 'PA': 'Pará', 'PB': 'Paraíba', 'PR': 'Paraná',
                        'PE': 'Pernambuco', 'PI': 'Piauí', 'RJ': 'Rio de Janeiro', 'RN': 'Rio Grande do Norte',
                        'RS': 'Rio Grande do Sul', 'RO': 'Rondônia', 'RR': 'Roraima', 'SC': 'Santa Catarina',
                        'SP': 'São Paulo', 'SE': 'Sergipe', 'TO': 'Tocantins'
                    };
                    
                    const estados = dadosAPI.map(e => ({
                        uf: e.uf,
                        nome: nomesEstados[e.uf] || e.uf,
                        faturamento: parseFloat(e.valor_total) || 0,
                        vendas: parseInt(e.quantidade_pedidos) || 0,
                        clientes: parseInt(e.quantidade_clientes) || 0
                    }));
                    
                    // Ordenar por faturamento desc para top5
                    estados.sort((a, b) => b.faturamento - a.faturamento);
                    const top5 = estados.slice(0, 5);
                    
                    renderizarMapaBrasil({ estados });
                    renderizarTopEstados(top5);
                } else {
                    console.warn('⚠️ Mapa do Brasil: API retornou status', res.status);
                    mostrarVazio();
                }
            } catch (error) {
                console.warn('⚠️ Erro ao carregar mapa:', error.message);
                mostrarVazio();
            }
        }

        function renderizarMapaBrasil(dados) {
            const container = document.getElementById('mapaBrasil');
            const estados = dados.estados || [];
            
            // Criar mapa indexado por UF
            const dadosEstados = {};
            estados.forEach(e => { dadosEstados[e.uf] = e; });
            const maxFaturamento = Math.max(...estados.map(e => e.faturamento), 1);
            
            const nomesEstados = {
                'AC': 'Acre', 'AL': 'Alagoas', 'AP': 'Amapá', 'AM': 'Amazonas',
                'BA': 'Bahia', 'CE': 'Ceará', 'DF': 'Distrito Federal', 'ES': 'Espírito Santo',
                'GO': 'Goiás', 'MA': 'Maranhão', 'MT': 'Mato Grosso', 'MS': 'Mato Grosso do Sul',
                'MG': 'Minas Gerais', 'PA': 'Pará', 'PB': 'Paraíba', 'PR': 'Paraná',
                'PE': 'Pernambuco', 'PI': 'Piauí', 'RJ': 'Rio de Janeiro', 'RN': 'Rio Grande do Norte',
                'RS': 'Rio Grande do Sul', 'RO': 'Rondônia', 'RR': 'Roraima', 'SC': 'Santa Catarina',
                'SP': 'São Paulo', 'SE': 'Sergipe', 'TO': 'Tocantins'
            };

// Paths SVG geográficos reais dos estados brasileiros (MapSVG CC-BY-4.0)
            const pathsEstados = {
                'AC': 'm 30.732574,238.03114 -2.08,-0.04 0.54,-1.81 -0.21,-0.83 -0.25,-0.49 -1.25,-0.7 -0.14,-0.45 0.27,-1.15 -0.77,-1.95 -1.09,-0.64 -5.6,-1.25 -7.34,-0.19 0.27,-0.56 2.49,-2.26 0.89,-1.23 0.29,-1.2 -0.22,-1.23 -0.68,-0.91 -0.83,-0.44 -1.68,-2.95 -0.77,-0.44 -0.9,-0.19 -1.13,-1.13 -0.92,-2.38 -2,-1.53 -0.98,-3.62 -0.87,-1.64 -1.88,-1.08 -0.08,-1.17 0.81,0.1 0.42,-0.52 0.07,-0.67 -0.2,-0.42 -2.12,-0.93 -0.36,-0.66 -2.16999996,-1.89 0.04,-0.37 0.62,-0.05 0.49999996,-1.32 -0.01,-1.31 3.01,-0.39 0.5,-0.39 -0.22,-1.35 -1.17,-1.57 0,0 17.95,7.48 23.66,5.66 12.14,3.14 26.44,14.17 28.509996,12.13 0,0 2.97,1.26 0,0 -0.3,0.48 -1.57,0.66 -2.09,1.59 -2.86,2.79 -1.65,0.86 -0.66,-0.18 -1.53,0.18 -0.05,0.56 -1.92,1.3 -2.08,0.99 -1.439996,1.83 -0.44,1.18 -0.61,0.28 -1.17,-0.75 -0.76,-0.13 -2.37,0.05 -0.68,0.26 -0.63,0.45 -0.36,0.86 -2.44,3.48 -3.77,1.25 -0.84,0.69 -1.94,0.51 -1.03,0.03 0.08,-2.11 -1.36,0.2 -3.55,-0.77 -5.24,-0.47 -5.09,0.38 -0.66,-0.58 -2.27,-0.17 -3.56,1.83 -2.73,0.62 -1.68,-0.67 -1.4,-1.44 -1.64,1.16 0.04,-17.55 0.05,-1.1 0.47,-0.71 0.07,-2.35 -0.26,-0.88 0.97,-1.18 0.48,-1.14 -1.16,0.2 -2.97,2.59 -1.6,1.01 -2.06,2.38 -1.95,0.67 -0.65,1.08 -1.81,0.99 z',
                'AL': 'm 562.17257,230.56114 -0.2,-0.73 -1.42,-0.78 -0.45,0.09 -1.02,-0.29 -0.54,-1.4 0,0 1.32,-1.07 0.64,-1.09 2.17,-0.76 2.38,-3.29 0.09,-0.69 0.82,-0.6 1,1.22 1.67,0.3 1.08,-0.12 2.55,2.02 1.9,2.12 1.78,1.05 1.91,0.48 2.5,-0.65 3.14,0.29 1.17,-0.11 1.86,-1.06 1.16,0.05 1.81,-1.11 2.18,-2.29 0.12,-0.45 1.55,-1.24 2,-0.24 2.24,0.85 2.56,-1.29 1.47,-0.19 1.92,0.81 2.9,0.27 0.27,0.21 0,0 -2.78,4.96 -4.55,5.13 -3.58,3.58 -3.04,4.58 -3.33,2.88 -1,2.03 -1.32,1.79 0,0 -0.6,-1.31 -3.59,-2.23 -0.46,-0.03 -1.66,-0.79 -1.76,-1.45 -1.3,-2.45 -5.42,-3.07 -3.68,-0.95 z',
                'AM': 'm 166.08257,47.551144 0.72,0.78 0.75,0.34 0.61,0.01 1.13,-0.42 0.63,0.11 0.06,0.96 1.21,1.17 0.97,0.37 0.88,-0.21 1.36,0.11 1.95,0.95 0.49,0.66 -0.91,3.32 -0.71,1.5 2.73,3.74 1.66,4.76 0.19,2.26 0.87,1.12 0.05,0.45 -1.62,1.46 0.36,1.59 0.66,1.58 -0.77,3.04 -0.57,0.96 0.29,4.98 0.88,2.17 1.22,0.84 0.58,0.9 1.13,4.33 -0.06,0.58 -1.14,1.32 -1.84,-0.33 -0.14,1.14 5.01,4.42 0.52,0.04 1.96,1.31 1.48,1.649996 1.04,2.04 0.53,0.07 1.34,-0.42 2.36,1.04 -0.44,-2.11 0.75,-2.289996 0.25,-1.73 -0.37,-1.8 0.82,-2.97 1.02,-1.26 1.28,-0.69 2.09,-0.71 0.55,-0.89 1.6,-0.06 2.83,0.93 1.87,2.04 0.92,2.51 1.82,0.23 1.25,-0.46 1.41,-1.41 2.03,-0.55 0.42,-0.39 0.02,-0.53 -1.14,-1.41 -0.23,-0.73 0.11,-0.66 1.15,-2.64 0.07,-1.13 1.66,-3.03 2.33,-3.26 -0.03,-0.68 18.49,0.07 0,0 0.4,4.86 -0.43,1.45 0.18,2.27 0.24,0.68 1.7,0.85 0.18,0.41 -0.35,0.69 -0.05,2.11 1.83,1.99 0.36,0.19 0.7,-0.18 1.84,1.23 0.55,1.83 0.04,0.93 0.3,0.45 4.64,3.769996 4.58,2.54 0.63,0.9 1.35,1.09 1.88,0.67 2.37,1.31 2.26,0.65 1.36,0.15 1.32,0.82 0.08,0.61 1.27,1.34 2.7,1.44 1.1,2.17 1.87,0.79 0.85,-0.61 1.38,-0.35 0.19,0.48 -0.13,0.78 1.81,1.67 -29.9,64.24 -0.78,1.31 -1.45,1.13 -0.58,0.97 -0.03,1.13 0.82,2.33 0.38,0.57 1.07,0.58 1.58,1.56 0.64,1.26 0.15,1.96 0.57,0.57 0,0 -1.18,1.2 -0.2,0.61 -0.06,0.76 0.34,0.84 -0.27,1.01 -1.2,1.82 -0.86,0.64 -0.42,0.85 0.1,0.85 0.66,1.37 0.46,1.94 -1.38,4.22 -1.18,5.22 -1.21,0.73 -47.85,0.32 0,0 0.04,-0.7 -0.36,-0.38 -1.39,-0.28 -1.92,1.08 -0.54,1.74 -0.68,0.19 -3.24,-1.48 -0.68,-2.88 -0.62,-0.2 -0.98,0.13 -0.46,-0.21 -1.25,-3.27 -2.54,-0.98 -1.33,-1.27 -0.8,-1.91 -0.45,-0.49 -2.15,-1.13 -10.79,0.06 -1.38,2.56 -1.72,0.5 0.09,1.17 -0.26,0.22 -2.48,0.53 -1.19,1.59 -0.05,0.67 0.9,0.7 0.17,0.45 -0.36,1.02 -0.81,1.15 -2.06,1.21 -0.11,1.81 0.24,1.46 -3.87,-0.46 -2.13,0.38 -1.2,1.07 -1.79,-0.1 -0.84,-0.55 -0.46,-0.02 -1.75,1.26 -0.53,0.84 0.26,1.75 -2.54,3.16 -0.68,0.08 -0.68,-0.53 -0.64,-2.26 -0.38,-0.09 -1.84,1.02 -1.3,1.21 -1.37,0.39 -0.77,-0.13 -1.08,0.5 -0.41,0.53 -0.13,0.72 -1.22,0.79 -0.37,0.02 -2.31,-2.33 -0.72,-0.37 -2.87,0.33 -3.96,-0.26 0.16,1.29 -0.15,0.56 -1.55,1.81 -1.92,0.58 -3.26,2.56 0,0 -28.509996,-12.13 -26.44,-14.17 -12.14,-3.14 -23.66,-5.66 -17.95,-7.48 0,0 -0.07,-0.65 0.7,-2.92 1.22,-1.4 4.92,-3.47 2.26,-0.24 0.47,-0.3 0.98,-1.56 0.08,-1.03 -1.74,-4.49 0.38,-1.19 1.18,-2.19 1.28,-1.32 0.92,-1.25 0.42,-0.98 0.3,-1.74 -0.29,-1.32 0.67,-2.04 0.31,-2.31 0.73,-0.75 3.66,-1.63 2.19,-1.23 1.15,-1.04 0.44,-1.4 0.78,-0.37 1.41,-0.11 1.65,-0.93 3.54,-2.73 2.42,-0.43 1.51,0.29 4.19,-1.22 1.5,-0.77 1.82,-0.36 3.33,0.38 1.3,-1.59 0.63,-1.45 1.09,-0.61 2.14,0.2 0.64,0.54 1.32,-0.24 1.1,-0.74 1.71,0.12 0.31,0.53 -0.02,1.18 1.61,1.29 2.83,0.08 0.58,-0.4 0.46,-0.78 -0.11,-0.39 1.17,-4.92 6.7,-37.17 1.16,-2.92 -0.99,-4.959996 0.12,-0.26 -1.3,-1.05 -1.48,-2.75 -0.04,-0.49 0.65,-1.39 -0.52,-1.78 -0.37,-0.4 -1.7,-0.59 -3.03,-2.35 -1.94,-2.28 0.2,-11.51 3.89,-0.26 1.75,-1.17 3.5,-0.92 2.68,1.76 1.22,0.11 1.27,-0.43 -0.49,-1.69 0.3,-1.72 -1.37,-2.1 -0.57,-0.54 -1.15,-0.6 -1.51,0.53 -2.79,-0.61 -3.57,0.09 -0.06,-9.9 0.96,0.04 1.32,-0.58 2.28,-0.6 2.84,0.87 19.03,0.06 -0.46,-0.66 -0.79,-0.14 -0.38,-1.2 0.95,-1.93 1.43,0.4 0.61,1.52 0.87,1.32 0.66,0.35 0.83,0.01 1.61,-0.61 1.94,-2.09 0.32,-0.84 1.259996,-1.24 2.55,-1.39 1.29,0.46 1.17,2.58 1.62,1.99 0.74,1.3 0.66,1.78 0.23,1.55 -0.49,3.63 0.2,1.76 3.2,-0.75 8.31,7.06 0.79,0.28 2.5,0.21 2.3,-1 1.7,-1.7 2.11,-1.16 2.19,-0.11 0.56,0.29 0.77,1.08 -0.02,0.97 -1.11,1.7 0.37,0.98 0.58,0.27 1.33,-0.72 0.56,-0.91 0.23,-1.29 1,-1.16 0.47,-0.23 1,0.18 0.55,-0.18 0.41,-0.66 0.46,-2.31 0.51,-0.37 1.51,-0.36 2.93,-1.77 0.97,0.55 0.93,-0.29 1.6,-1.04 1.02,-1.61 2.11,-1.21 2.03,0.55 2.36,-1.65 0.55,-0.82 0.44,-2.66 -0.03,-1.29 0.77,-0.92 1.03,-0.42 1.74,-0.02 1.34,-0.39 2.06,-1.6 0.96,-0.37 2.28,-0.3 z',
                'AP': 'm 345.24257,99.961144 -0.94,-0.06 -0.77,0.339996 -1.3,0.12 -2.79,-0.679996 -1.45,-1.03 -0.43,-1.5 -1.87,-1.39 -0.11,-1.3 0.21,-0.69 -0.31,-1.58 -0.33,-0.47 -0.95,-0.19 -0.41,-0.94 0.08,-2.43 -2.93,-3.28 -0.78,0.36 -0.82,-0.19 -1.5,-3.48 0.13,-1.58 -0.59,-1.81 -0.62,-0.56 -0.67,-1.51 -0.19,-2.11 0.43,-3.14 -0.17,-0.33 -2.57,-0.73 -2.02,-2.26 -0.76,-2.83 0.19,-0.72 0.68,-0.23 -0.49,-1.18 -0.68,0.03 -2.84,-2.66 -0.94,0.14 -0.38,0.42 -1.33,0.14 -0.84,-0.27 -0.8,-0.98 -1.14,-0.84 -1.19,-0.12 -0.49,-1.28 -0.67,-0.8 -1.93,-1.05 -1.29,-0.49 -3.39,-0.37 -1.08,0.29 -1.17,-0.02 -0.31,-0.54 -0.24,-1.44 0.25,-4.54 0.62,-1.3 -0.37,-2.3 -0.62,-0.57 0,0 0.35,-0.21 0.99,0.3 -0.01,0.81 -0.29,0.18 0.34,0.97 1.47,-0.06 0.82,0.23 0.35,0.9 0.84,0.71 2.25,0.78 3.29,0.75 2.76,-1.78 0.35,-0.76 1.73,-1.17 0.83,-0.29 0.69,0.94 2.71,0.94 1.08,-0.12 1.72,-1.01 0.12,-0.42 0.32,0.03 1.46,1.3 -0.2,0.87 2.37,-0.17 0.51,0.5 0.95,0.17 0.62,-0.01 0.91,-0.48 1.67,-1.5 1.78,-1.1 1.75,-2.3 0.37,-1 -0.2,-0.54 3.13,-6.5 0.11,-1.82 1.11,-1.3 0.73,-0.19 3.6,-5.79 0.23,-1.15 0.84,-1.2 1.79,-1.55 0.63,-1.66 2.11,-1.14 0.47,-0.92 1.04,-0.58 0.56,1.46 0.88,1.36 -1.67,-4.8 -0.07,-1.29 0.18,-0.33 3.37,2.42 1.14,1.21 0.91,1.22 0.52,1.19 0.03,1.58 0.44,0.31 0.32,-0.48 0.38,-0.1 0.21,0.4 0.21,7.89 0.66,3.87 2.71,6.05 2.66,8.94 3.32,5 1.01,0.35 3.27,-0.08 2.78,0.94 1.29,0.85 0.77,2.65 -0.16,3.33 -1.29,0.96 -1.73,0.43 -0.38,0.33 1.79,-0.15 1.04,-0.42 0.28,0.23 0.12,0.59 -0.17,0.73 -5.03,4.06 -1.17,2.1 -2.15,1.41 -1.94,3.72 -2.91,3.5 -0.7,0.46 -0.94,-0.09 -1.45,0.52 -2.08,2.98 0,0 -1.34,0.07 -0.75,0.9 0,0 -1.47,1.68 -0.97,2.22 -1.12,1.87 -0.84,0.65 -3.01,3.45 -0.36,2.4 0.17,1.8 -1.95,1.81 -0.98,0.12 z m 23.36,-46.99 -0.45,-0.33 -1.1,-1.86 0.07,-0.88 0.23,-0.41 1.66,-0.45 0.43,0.39 0.83,2.27 -0.99,1.1 -0.68,0.17 z m 2.49,17.61 -0.4,-0.25 -0.08,-0.71 1.11,-1.1 0.88,-0.15 1.25,0.24 0.46,-0.11 0.44,-0.64 0.05,0.59 -0.97,1.44 -0.99,0.5 -1.75,0.19 z m 3.44,-2.87 -0.78,-0.23 0,-0.56 0.72,-1.04 1.25,-0.1 0.18,0.35 -0.1,0.51 -1.27,1.07 z m -7.19,-18.42 -0.76,-0.5 0.26,-0.83 0.88,-0.17 0.86,0.32 0.01,0.73 -1.25,0.45 z',
                'BA': 'm 527.76257,365.59114 -0.36,-0.83 0.68,-1.35 -0.01,-0.53 -0.53,-1.04 -4.13,-3.05 -0.15,-0.51 0.22,-1.51 -0.57,-1.23 -0.65,0.24 -0.2,0.45 -0.34,0.18 -0.22,-0.25 0.53,-4.4 0.82,-3.3 0.82,-0.88 2.47,0.24 1.02,-0.71 0,-0.42 -0.56,-1.02 0.16,-2.65 4.96,-4.22 1.47,-3.08 -0.42,-1.17 -0.78,-1.02 -0.89,-0.06 -0.73,-0.38 -2.83,-2.47 -2.12,0.02 -2.19,-0.6 -2.27,-1.08 -2.73,-0.56 -1.98,-0.14 -1.32,0.99 -1.47,0.5 -2.61,-0.45 -0.57,0.21 -0.44,-3.96 -6.52,-6.2 -0.38,-0.18 -4.39,1.23 -1.53,-1.24 -0.51,0.21 -0.93,-0.22 -2.54,-1.22 -2.17,-1.62 -0.98,0.18 -4.35,-3.63 -1.1,-0.54 -2.73,-0.75 -1.77,0.25 -1.88,0.9 -0.81,1.12 -0.64,0.18 -5.33,-1.47 -0.61,-0.49 -0.26,-1.5 0.14,-0.89 1.29,-2.74 -0.86,-0.46 -2.28,-0.52 -2.18,-0.04 -1.2,-0.5 -1.79,-0.08 -3.83,1.58 -4.26,3.03 -0.64,1.11 -3.37,1.87 -2.02,0.4 -0.95,1.18 -1.81,1.55 -1.43,0.52 -1,-0.15 -1.85,2.58 -1.04,0.77 -2.13,-0.38 -0.72,0.13 -0.69,1 -1.34,0.92 -0.4,-0.24 1.43,-3.43 -0.51,-2.41 0,0 1.48,-1.97 0.25,-0.77 -0.23,-1.27 -0.67,-1.72 0.1,-0.67 0.71,-1.42 -0.05,-0.46 -3.21,-2.62 -1.69,-3.46 -0.62,-3.52 0.05,-1.55 1.2,-3.83 1.59,-1.03 0.23,-0.38 0.06,-0.94 -1.63,-0.84 -0.11,-0.33 0.48,-2.52 1.43,-1.06 -0.02,-0.37 -2.72,-2.46 0,0 -0.04,-0.93 1.36,-2.38 -0.04,-1.07 -0.17,-0.42 -1.46,-0.49 -0.94,-0.65 -0.35,-1.26 0.06,-2.92 0.19,-0.85 1.95,-1.67 1.14,-0.42 0.96,-0.72 -0.29,-0.63 -0.58,-0.52 -0.92,-0.29 -1.03,0.18 -0.35,-0.33 -0.09,-0.5 0.42,-0.96 2.04,-0.82 0.56,-0.45 -0.04,-0.76 -1.88,-0.98 -3.58,-0.67 -1.86,-1.96 -0.23,-0.92 0.5,-1.16 1.01,-0.73 1.52,-3.48 0.9,-0.61 1.01,-0.27 0.35,-0.38 -1.29,-1.8 0.19,-0.37 3.21,-2.62 3.82,-2.02 0.56,-0.47 0.22,-0.98 0.69,-0.65 0,0 2.33,-0.02 1.44,1.34 0.66,1.04 0.53,2.21 1.76,2.49 4.18,1.86 1.8,-0.52 2.11,0.18 0.33,-0.21 0.75,-1.45 1.14,-0.37 0.67,-0.87 1.17,-0.89 2.21,-0.75 1.33,0.17 1.48,0.53 1.35,-0.42 2.97,-2.42 2.95,-5.05 0.72,-0.86 0.24,-0.92 0.3,-2.56 -0.12,-1.16 -2.24,-4.43 0.05,-0.93 3.24,-1.65 1.95,-0.02 1.5,0.46 0.41,0.93 0.32,0.18 2.12,-0.43 1.39,-0.54 1.33,0.38 1.71,0.99 -0.13,0.65 0.19,0.29 0.82,0.28 3,-0.11 1.47,-0.64 1.7,-0.1 0.82,-1.22 1.51,-1.34 2.73,-0.34 0.77,-0.36 0.81,-0.98 2.17,0.01 0.62,0.63 0.31,0.05 1.86,-1.81 -0.1,-2.4 1.99,-0.38 0.79,0.18 1.05,-0.66 1.5,-2.31 0.46,-1.15 0,0 0.89,0.4 1.16,-0.27 2.2,0.29 2.82,1.39 0.44,0.51 -0.06,2.73 0.72,1.94 2.21,0.91 0.27,2 -0.92,1.68 1.83,0.62 0.96,-0.22 0.82,-0.92 2.87,-0.88 0.77,-3.58 0.5,-0.87 0.75,-0.16 0.78,0.53 0.63,0.05 2.39,-1.02 1.1,-1.24 0.17,-0.59 -0.25,-1.36 0.29,-0.25 2.24,-0.45 0.77,-2.05 1.65,-0.44 2.53,-1.46 0.59,-0.1 1.49,0.56 0.83,1.44 1.36,0.81 2.36,0.78 2.99,0.4 1.58,1.15 0.54,1.65 0.39,0.27 0.43,-0.15 0.29,-1.75 0.43,-0.44 1,-0.01 0.45,0.32 0.02,0.63 -0.62,0.88 0.45,0.83 0.5,0.37 2.1,0.86 0.02,0.94 1.22,3.05 0,0 0.54,1.4 1.02,0.29 0.45,-0.09 1.43,0.79 0.2,0.72 0,0 -0.67,1.16 0.21,2.14 1.28,2.5 1.99,1.95 0.75,1.15 -0.08,3.12 -0.66,1.62 -0.09,0.88 0.76,2.75 -0.3,0.58 -0.69,0.55 -2.55,1 -1.13,-0.75 -1.71,-0.01 -0.32,0.3 -0.59,1.58 0.02,0.77 0.95,1.6 1.1,0.66 0.52,1.49 1.43,1.51 0.15,0.39 -0.13,1.42 -0.34,0.39 0.12,0.42 0.59,0.52 1.93,0.92 0.48,0.71 0.54,0.34 1.55,0.64 2.89,-0.88 0,0 0.64,-0.02 0.36,0.41 -4.08,8.83 -3.83,5.19 -1.03,2.33 -5.03,5.74 -2.45,1.26 -0.87,-0.01 0.3,-1.43 0.37,-0.15 0.14,-1.1 -0.45,-1.93 -1.87,-0.25 -0.43,-1.3 -0.68,-0.75 -0.37,0.6 -0.46,2.33 -0.5,0.87 -0.55,0.38 -0.56,-0.29 -0.49,-1.74 0.11,-0.32 0.31,-0.13 -0.03,-0.39 -0.87,1.29 0.93,1.69 0.46,0.23 0.37,-0.15 1.15,0.26 -0.46,1.81 -1.21,1.15 -0.25,1.82 -1.25,0.97 -0.35,0.67 -0.2,0.84 0.18,0.85 -1.35,-0.39 -0.21,0.39 -0.36,2.52 0.36,-0.72 0.75,0.21 0.24,0.54 -0.23,0.41 0.06,0.62 0.3,0.3 0.33,1 -1.04,2.51 0.57,3.44 -0.55,0.49 -0.57,-0.22 -0.14,1.13 0.59,0.46 1.21,-1.72 -0.47,-2.21 0.82,-0.61 0.25,0.54 -0.06,1.76 -0.96,2.61 -0.74,5.43 -0.51,1.81 0.2,2.47 0.78,2.85 0.19,4.54 0.87,6.41 0.99,3.42 -2.21,6.66 -1.35,6.65 -0.47,1.01 -0.16,2.86 -1.06,3.72 -0.09,2.33 0.39,4.42 0.89,1.71 -2.24,2.98 -1.81,0.67 -0.94,0.64 -2.72,3.89 -0.57,2.04 0,0 -8.09,-5.14 -0.31,-0.53 z m 22.28,-78 -0.23,-1.2 0.74,-0.41 1.06,-1.04 0.16,-0.64 -0.37,-0.73 0.76,0.14 0.82,1.05 -0.05,0.53 -2.89,2.3 z m -2.53,6.85 -0.63,-0.03 0.01,-0.67 0.26,-0.36 -0.8,-0.22 -0.42,-0.4 0.13,-1.07 1.87,-0.15 0.16,0.2 0.11,1.13 -0.69,1.57 z',
                'CE': 'm 574.05257,157.11114 -4.89,1.59 -2.61,2.01 -3.3,6.69 -0.84,1.12 -0.87,0.57 -0.65,1.67 0.15,0.74 -1.4,2.44 -1.46,1.51 -0.57,1.1 -1.03,0.26 -0.78,-0.51 -0.51,0.07 -0.84,0.88 -1.41,2.25 -0.34,1.97 0.64,0.17 0.66,-0.38 0,0 -0.08,0.54 -0.84,1.15 -1.03,3 0.52,1.31 -0.66,1.31 -1.09,0.63 -0.17,0.38 -0.12,0.93 0.24,0.41 0.58,0.29 0.35,0.72 -0.02,1.66 1.24,0.89 0.69,0.08 0.34,1.19 -1.61,3.49 -1.19,1.12 0.17,0.25 0,0 -1.59,0.49 -1.07,0.83 -1.54,2.29 -1.65,0.05 -0.63,-1.64 -0.78,-0.57 -1.36,-0.48 -1.01,-1.07 -0.46,-0.99 -1.83,-0.83 -2.85,-1.9 -3.08,-0.42 -1.29,0.1 -2.14,0.8 -1.63,0.19 -0.89,-0.24 -4.93,-0.2 0,0 0.06,-1.32 -0.68,-0.68 -0.08,-0.97 1.14,-3.11 1.5,-2.25 0.01,-0.69 -0.77,-1.16 -2.56,-0.47 -1.31,-0.65 -1.01,-2.67 -1.05,-5.2 -0.76,-2.57 0.24,-0.45 -0.94,-8.16 -0.11,-0.38 -0.92,-0.69 0.8,-0.58 0.59,-1.58 -0.6,-2.99 -1,-2.01 0.48,-1.6 -0.79,-3.87 0.74,-1.36 0.02,-0.76 -1.36,-1.59 -0.44,-1.73 -3.15,-6.42 -1.8,-4.72 -0.29,-1.29 0.18,-1.46 1.58,-1.97 1.09,-1.85 0.11,-0.8 0,0 0.19,-0.14 -0.04,-0.62 -0.4,-0.66 0.65,-0.81 6.74,-0.22 2.89,-0.43 2.07,-0.66 7.4,0.79 2.12,1.12 1.94,1.5 4.12,2.18 1.46,0.52 4.82,3 1.21,0.2 2.22,2.29 2.99,2.11 2.57,0.72 2.44,2.91 1.22,0.61 2.96,3.81 4.16,3.08 1.46,2 1.04,0.99 1.5,0.82 1.15,0.03 2.37,0.92 0.79,0.67 z',
                'DF': 'm 416.97257,334.13114 -14.69,-0.02 -0.52,-3.26 0.92,-1.83 0.38,-3.73 11.95,0.01 1.83,1.98 0.06,2.21 -0.59,1.19 -0.21,2.44 z',
                'ES': 'm 501.89257,411.63114 -0.29,-0.14 0.44,-2.34 0.57,-1.3 -0.59,-3.12 0.16,-0.42 1.72,-2.06 5.15,0.03 0.55,-0.32 0.97,-3.24 1.11,-1.27 0.88,-2.29 0.24,-1.72 0.26,-0.44 1.24,-0.86 1.71,-2.09 0.54,-2.97 -0.29,-2.43 -1.27,-2.81 -1.1,-1.27 -0.52,-0.09 -0.45,0.29 -0.76,-0.28 -0.49,-0.71 0.43,-0.55 1.48,-0.09 0.8,0.35 0.97,0.03 0.95,-0.24 0.32,-0.42 -0.17,-1.72 -1.31,-0.35 -0.21,-0.41 0.3,-1.54 0.03,-1.92 -0.52,-0.66 -1.33,-0.67 -0.3,-0.7 1.17,-1.93 2.17,-1.31 0.31,-0.02 1.05,0.74 1.13,0.11 0.02,-0.81 -1.67,-2.27 1.34,0.13 2.18,-0.29 0.84,-0.61 1.08,-0.32 1.58,-0.08 2.54,0.81 0.91,0.55 0,0 0,0 0,0 0.3,0.53 8.1,5.14 0,0 -0.93,3.35 -0.31,2.86 0.12,3.59 0.72,6.15 -0.31,2.47 -1.49,3.18 -2.75,1.39 -0.55,0.6 -1.67,3.33 -0.98,3.8 -0.77,1.47 -0.83,-0.68 -0.88,-0.13 -0.29,1.28 1.35,0.52 -1.94,4.24 -3.45,3.84 -0.24,-0.27 -1.86,0.66 -0.8,1.23 -0.06,1.39 -0.42,1.25 -1.59,2.02 -0.29,1.13 0,0 -1.62,-1.06 -2.99,0.37 -4.34,-1.01 -2.5,-1.13 -0.67,-4.71 z',
                'GO': 'm 416.97257,334.13114 -0.87,-1.01 0.21,-2.44 0.59,-1.19 -0.06,-2.21 -1.83,-1.98 -11.95,-0.01 -0.38,3.73 -0.92,1.83 0.52,3.26 14.69,0.02 0,0 0,0 0,0 -0.53,1.52 0.31,1.57 -0.68,1.59 -1.04,1.25 -0.41,1.47 0.85,1.21 0.85,0.34 1.42,1.03 1.65,4.56 0,0.6 -2.32,2.71 -3.24,3.01 -0.43,2.14 1.09,1.11 0.9,-0.47 1.58,0.57 0.47,0.61 0.18,1 -0.17,0.71 -0.73,0.9 -0.51,1.89 1.19,3.46 -3.09,2.06 -1.16,0.2 -0.86,0.9 -0.48,1.12 -4.89,2.74 -0.7,-0.77 -4.35,-1.86 -0.55,0.48 -0.58,0.09 -1.75,0.01 -1.48,-0.28 -3.86,0.16 -2.01,-0.89 -4.13,2.64 -2.91,2.92 -0.33,0 -1.31,-1.42 -1.52,-0.3 -3.19,1.64 -3.71,-0.62 -2.48,0.96 -2.23,0.54 -1.41,2.1 -1.21,2.46 0.06,1 -0.84,1.3 -0.82,0.28 -0.84,-0.16 -0.45,0.14 -0.94,0.74 -1.64,2.1 -0.57,1.9 0.56,0.61 -0.01,0.34 -0.36,0.23 -0.86,-0.46 0,0 -0.24,-0.45 -2.66,-2.24 -3.15,-0.61 -1.62,-1.55 -1.9,-0.43 -1.49,-0.04 -3.35,-1.34 -0.68,-0.85 -3.07,-1.56 -0.67,-0.61 -1.44,-0.71 -1.14,-0.17 -2.7,-1.68 -2.78,0.16 -3.8,-0.7 -0.13,-0.33 0.26,-0.84 0.57,-1.17 1.31,-1.76 -0.08,-0.42 -2.25,-0.9 -1.14,0.67 -0.66,-0.19 -0.28,-0.41 -0.23,-1.11 0.26,-2.58 -0.19,-1.77 0,0 -0.95,-2.2 -0.18,-3.43 -1.41,-2.19 -0.16,-0.71 0.4,-3.41 2.55,-3.85 0.38,-2.91 0.7,-0.77 2.02,-0.84 1.92,-1.77 1.25,-2.02 0.33,-1.95 0.5,-1.01 1.28,-1.04 0.82,-1.43 0.08,-1.54 1.75,-0.97 1.4,-2.62 2.65,-0.13 2.72,-0.86 0.32,-0.28 1.98,-4.19 0.71,-0.96 0.64,-4.1 0.38,-0.74 1.92,-1.94 1.65,-1.01 1.07,-0.26 1.23,0.68 1.21,-0.73 1.39,-1.43 0.84,-2.93 1.17,-2.87 -0.01,-0.8 -0.48,-1.14 0.58,-2.74 1.6,-3.09 -0.12,-5.18 1.21,-0.78 1.03,-2.63 2,-3.17 0.39,-1.07 -0.16,-2.72 0.35,-0.9 0.97,-0.86 0.27,-1.13 -0.08,-0.63 0,0 0.34,-0.45 0.2,-1.88 0.66,-1.23 1.81,-2.09 0.56,-0.3 -0.03,1.71 -1.22,1.88 -0.52,2.34 2.4,0.4 2.2,1.03 3.93,0.4 3.09,1.71 4.07,1.43 0.63,-0.23 1.63,-5.94 1.47,-2.39 1.18,-0.97 1.15,1.31 1.04,1.88 1.11,3.71 0.61,3.1 1.14,0.05 0.75,-0.75 0.3,-1 0.56,-0.54 2.76,0.34 4.53,-0.53 0.22,0.74 -0.56,1.56 3.13,1.47 3.35,0.68 0.69,-0.08 0.51,-3.3 0.55,0.03 1.51,2.62 0.46,0.24 1.78,-0.9 2.52,-2.08 4.53,-1 1.55,0 2.56,-1.1 1.74,-1.34 5.36,-1.42 0,0 2.72,2.46 0.02,0.38 -1.43,1.06 -0.48,2.52 0.1,0.33 1.63,0.84 -0.06,0.94 -0.23,0.38 -1.59,1.03 -1.19,3.83 -0.05,1.55 0.62,3.52 1.7,3.46 3.21,2.62 0.05,0.47 -0.72,1.42 -0.1,0.67 0.67,1.72 0.23,1.28 -0.25,0.77 -1.48,1.97 0,0 -1,1.01 -3.23,-0.34 -0.9,-1.76 -2.42,-1.48 -1.17,1.49 0.58,3.77 -0.57,0.54 -0.4,0.13 -2.78,-1.14 -1.17,0.23 -0.37,0.28 -0.72,3.18 0.72,0.1 0.49,1.16 -0.57,0.94 -0.73,0.7 0.04,1.9 0.42,0.61 0.53,0.19 0.69,4.26 -0.53,0.53 -3.36,0.9 -2.29,1.51 z',
                'MA': 'm 458.83257,129.18114 -0.04,0.33 -2.04,2.15 -0.43,0.17 -0.04,1.44 1.97,-1.7 0.68,-1.21 2.12,-1.58 0.89,-1.14 1.03,-6.33 1.15,-0.7 1.11,-0.12 1.67,-0.92 0.65,-0.13 0.46,0.12 0.08,1.63 -0.2,0.45 -1.42,1.87 -3.21,1.75 -0.03,0.72 0.73,0.12 0.45,-0.81 1.15,-0.31 0.22,0.83 -0.59,0.51 0.25,0.3 4.21,-4.97 0.86,0.33 2.58,-0.93 4.04,0.43 -0.46,-2.41 0.61,-0.23 2.42,0.08 1.78,0.38 2.63,1.05 1.04,0.11 2.15,1.38 1.4,0.03 1.26,1.3 1.89,1.32 2.5,0.58 1.16,-0.19 0.56,0.76 0.34,0.05 1.59,-0.09 2.46,0.66 0.26,-0.9 -0.67,-0.47 1.67,-0.38 0.57,0.11 -0.09,0.42 0,0 -0.46,1.43 0.23,0.72 0.63,0.54 -0.38,1.53 -1.79,2.27 -4.13,3.97 -3.32,0.46 -0.8,-0.16 -2.92,3.4 0.04,1.8 -0.88,1.83 -1.89,1.85 -0.82,1.98 -0.64,0.17 -0.77,1.05 0.36,1.92 1.23,0.83 0.38,1.28 -0.28,1.46 -1.14,2.87 1.58,2.81 0.55,2.98 -0.11,2.43 -0.21,0.55 -4.1,4.42 -0.17,2.48 0.12,2.11 0.51,2.3 1.78,2.04 1.61,0.91 0.17,0.5 0.13,0.84 -0.39,2.2 -0.29,0.44 -0.12,1.21 -0.5,1.46 -1.21,1.31 -2.29,0.29 -0.65,-0.28 -0.83,0.04 -2.43,0.86 -1.52,0.11 -2.5,-1.82 -1.01,-0.21 -1.46,0.19 -1.01,0.6 -1.12,0.26 -0.23,-0.3 -0.84,0.24 -0.5,0.22 -1.9,1.91 0.01,0.46 -0.63,0.87 -2.01,2 -2.34,0.91 -2.87,2.56 -1.33,0.53 -1.05,0.04 -1.7,1.53 -1.08,0.36 -2.61,0.32 -2.72,0.76 -2.13,1.95 -0.98,2.97 -0.39,2.97 -0.63,2.32 -1.45,2.74 -0.3,0.22 -0.34,0.82 -0.13,1.52 -1.2,2.48 -1.7,1.4 -0.73,2 0.71,1.94 0.47,3.18 1.73,3.06 -0.04,0.52 -0.76,1.4 -0.13,6.36 -1.15,2.45 -0.26,1.06 -0.05,1.92 0,0 -1.28,-0.66 -0.61,-0.82 -0.82,-0.45 -0.99,-0.29 -1.78,0.2 -0.71,-0.18 -1.35,-2 -0.99,-2.86 -2.13,-1.62 -0.14,-1.65 1.64,-1.81 -0.08,-0.53 -3.88,-1.95 -0.62,-1.05 -0.06,-1.66 -0.75,-1.59 -0.94,-0.69 -2.08,-0.28 -0.2,-0.42 0.26,-0.71 2.63,-2.54 -0.37,-1.31 0.73,-2.68 0.69,-1.43 0.57,-0.55 1.34,-0.54 3.39,-0.35 -0.39,-1.35 0.64,-3.25 -0.08,-1.76 -1.8,-1.21 -4.27,0.94 -2.15,1.34 -2.27,-3.02 -0.91,-0.85 -3,-4.15 -0.88,0.07 -0.84,-1.44 0.61,-1.19 -0.11,-0.88 -0.25,-0.34 -1.37,-0.24 -0.42,0.27 -1.93,-1.33 0.18,-0.71 1.76,-0.66 1.75,-2.04 0.25,-1.59 -0.28,-1 0.31,-2.36 1.77,-6.16 0.01,-0.43 -0.68,-1.14 -0.23,-1.08 0.21,-3.72 -0.64,-1.5 -0.47,-3.49 -0.84,-1.03 -3.4,-1.44 -1.22,-0.02 -0.28,-0.32 -0.08,-1.03 -0.59,-0.69 -1.74,-0.29 -0.96,0.52 -1.4,-0.09 -2.78,-1.51 -0.86,-0.06 -1.96,0.53 -2.62,1.85 -0.53,0.64 0,0 -0.49,-0.08 14.71,-11.83 2.35,0.23 1.17,-0.92 1.55,-2.17 0.43,-1.15 1.55,-1.17 0.62,-2.88 1.12,-0.46 2.44,-2.32 0.47,-1.21 0.29,-1.9 1.6,-4.69 1.96,-1.54 1.48,-1.76 0.83,-1.45 0.46,-1.28 -0.18,-1.82 0.79,-0.81 -1.04,-1.58 3.68,-3.09 -0.13,-1.64 0.5,-2.38 1.74,-1.57 0.36,-0.71 0.9,-3.02 0.08,-1.61 -0.43,-0.53 -0.99,0.16 -0.27,-0.49 0.05,-0.62 1.14,-0.15 0.57,-0.74 0.71,-4.39 -0.16,-1.38 0.47,-1.03 0.77,-0.45 0,0 0.63,0 0.24,-0.24 -0.06,-0.54 0.34,-0.749996 0.58,-0.53 1.34,0.98 0.45,1.839996 1.19,0.12 0.77,-1.36 0.61,2.93 0.99,0.04 0.29,-0.49 0.07,-0.94 0.85,-0.04 1.69,0.53 0.5,0.69 -1.43,1.7 0.67,0.7 0.02,0.55 1.21,-2.04 0.49,-1.54 0.45,0 0.4,1.02 0,0.58 -0.87,0.92 -0.27,0.99 0.08,2.71 0.26,0.33 0.47,0.12 0.58,-0.14 0.96,-0.93 -0.47,-1 0.14,-0.6 1.32,-1.43 1.05,-0.25 2.13,0.59 1.5,-1.11 0.05,0.92 -0.36,0.21 -1.13,1.53 0.59,0.58 0.1,-0.37 1.25,-0.6 0.58,0.79 -0.14,1.21 1.63,1.75 0.86,-0.44 1.58,0.67 0.77,2.4 -0.11,0.95 -2.19,2.73 -0.38,0.89 0.1,0.66 0.6,-1.03 1.75,-1.68 0.83,-0.03 0.87,0.81 0.52,1.89 -0.27,1.23 -0.97,0.19 -1.03,0.91 -1.16,1.49 0.07,0.77 -1.16,2.35 -0.62,3.52 0.21,0.34 0.87,0.23 z m 0.52,0.45 -0.06,-0.79 0.53,-1.53 -0.41,-1.07 0.13,-0.66 0.91,-1.24 0.55,-0.19 0.05,2.35 -0.22,1.34 -0.8,0.6 -0.68,1.19 z m -6.3,-25.76 -0.44,-0.46 -0.08,-0.6 0.8,-1.12 0.84,-0.03 0.68,0.42 0.1,0.34 -0.19,0.36 -1.71,1.09 z m 3.5,4.18 -0.29,-0.3 0.06,-0.53 1.06,-0.89 0.48,0.07 0.5,0.85 -0.14,0.61 -0.4,-0.17 -1.27,0.36 z m -14.16,-4.81 -0.21,-0.05 0.95,-3.579996 0.3,0.09 0.03,0.23 -0.41,3.059996 -0.66,0.25 z',
                'MG': 'm 527.76257,365.59114 -0.91,-0.55 -2.54,-0.81 -1.58,0.08 -1.08,0.32 -0.84,0.61 -2.18,0.29 -1.34,-0.13 1.67,2.27 -0.02,0.81 -1.13,-0.11 -1.05,-0.74 -0.31,0.02 -2.17,1.31 -1.17,1.93 0.3,0.7 1.33,0.67 0.52,0.66 -0.03,1.92 -0.3,1.54 0.21,0.41 1.31,0.35 0.17,1.72 -0.32,0.42 -0.95,0.24 -0.97,-0.03 -0.8,-0.35 -1.48,0.09 -0.43,0.55 0.49,0.71 0.76,0.28 0.45,-0.29 0.52,0.09 1.1,1.27 1.27,2.81 0.29,2.43 -0.54,2.97 -1.71,2.09 -1.24,0.86 -0.26,0.44 -0.24,1.72 -0.88,2.29 -1.11,1.27 -0.97,3.24 -0.55,0.32 -5.15,-0.03 -1.72,2.06 -0.16,0.42 0.59,3.12 -0.57,1.3 -0.44,2.34 0.29,0.14 0,0 -2.53,2.35 -1.24,0.27 -0.56,0.5 0.74,0.7 -2.36,6.05 -1.9,3.71 -0.09,0.75 1.44,0.13 0.29,0.61 -0.21,0.52 -2.53,0.98 -9.51,4.53 -1.37,0.2 0.02,-0.46 -0.49,-0.17 -2.53,-0.27 -0.57,0.06 -1.62,0.94 -1.25,0.16 -3.2,0.08 -0.36,-0.32 -0.51,0.08 -4.1,1.78 -1.05,0.77 -1.71,0.77 -0.5,-0.28 -2.59,0.17 -2.91,1.34 -2.42,0.74 -0.68,0.49 0,0 -1.25,0.73 -2.2,0.22 -1.93,1.02 -1.23,1.24 -1.79,0.67 -2.38,0.25 -2.34,-0.08 -0.01,-0.49 0.35,-0.49 -0.09,-0.35 -1.19,0.33 -0.18,2.3 0.24,0.23 -0.05,0.84 -0.75,0.98 -1.3,0.32 -0.57,-0.43 -3.61,1 -0.19,-0.53 -2.01,0.24 -1.12,-0.25 -2.03,-3.31 1.22,-0.71 -0.52,-1.71 -1.8,-0.83 -1.79,-1.23 -0.71,-1.61 0.53,-1.56 0.19,-3.45 -0.26,-2.94 1.86,-2.72 0.7,-2.18 0.05,-1.27 -0.23,-0.37 -3.7,-1.32 -1,0.05 -0.28,0.36 -0.78,0.31 -1.61,0.05 0.03,-0.85 -0.83,-1.99 -1.3,-1.79 -0.37,-2.21 -0.31,-0.62 -0.79,-0.74 0.19,-1.94 1.52,-2.03 0.06,-0.56 -0.4,-1.55 -1.88,-1.21 -0.58,-0.61 0.29,-2.37 0.57,-1.01 -0.2,-1.04 -3.27,-3.35 -1.3,0.29 -0.85,0.64 -1.65,-0.78 -2.38,0.11 -0.31,0.61 0.2,0.46 -0.44,0.99 -2.78,0.68 -1.11,-0.43 -1.51,-1.45 -1.01,1.25 -8.18,0.68 -0.46,0.48 -0.48,1.19 0.27,2.54 -0.41,0.44 -1.19,-0.52 -0.01,-2.78 -0.25,-0.96 -0.36,-0.39 -0.56,-0.05 -0.26,0.19 -0.41,1.13 -0.67,0.94 -0.54,0.32 -0.62,-0.02 -1.21,-2.1 -0.33,-1.42 0.14,-0.91 -1.68,-0.79 -2.18,-1.42 -1.99,0.59 -1.62,-0.22 -1.67,0.35 -4.29,-0.96 -2.55,-0.08 -1.73,-1.55 -0.75,-0.14 -1.5,0.61 -1.43,1.69 -1.92,0.37 -2.15,1.11 -1.22,1.13 0,0 0.31,-2.62 -0.59,-3.21 0.99,-4.18 0.58,-0.25 0,0 0.86,0.46 0.36,-0.23 0.01,-0.34 -0.56,-0.61 0.57,-1.9 1.64,-2.1 0.94,-0.74 0.45,-0.14 0.84,0.16 0.82,-0.28 0.84,-1.3 -0.06,-1 1.21,-2.46 1.41,-2.1 2.23,-0.54 2.48,-0.96 3.71,0.62 3.19,-1.64 1.52,0.3 1.31,1.42 0.33,0 2.91,-2.92 4.13,-2.64 2.01,0.89 3.86,-0.16 1.48,0.28 1.75,-0.01 0.58,-0.09 0.55,-0.48 4.35,1.86 0.7,0.77 4.89,-2.74 0.48,-1.12 0.86,-0.9 1.16,-0.2 3.09,-2.06 -1.19,-3.46 0.51,-1.89 0.73,-0.9 0.17,-0.71 -0.18,-1 -0.47,-0.61 -1.58,-0.57 -0.9,0.47 -1.09,-1.11 0.43,-2.14 3.24,-3.01 2.32,-2.71 0,-0.6 -1.65,-4.56 -1.42,-1.03 -0.85,-0.34 -0.85,-1.21 0.41,-1.47 1.04,-1.25 0.68,-1.59 -0.31,-1.57 0.53,-1.52 1.27,-0.12 2.29,-1.51 3.36,-0.9 0.53,-0.53 -0.69,-4.26 -0.53,-0.19 -0.42,-0.61 -0.04,-1.9 0.73,-0.7 0.57,-0.94 -0.49,-1.16 -0.72,-0.1 0.72,-3.18 0.37,-0.28 1.17,-0.23 2.78,1.14 0.4,-0.13 0.57,-0.54 -0.58,-3.77 1.17,-1.49 2.42,1.48 0.9,1.76 3.23,0.34 1,-1.01 0,0 0.51,2.41 -1.43,3.44 0.4,0.23 1.34,-0.91 0.7,-1 0.72,-0.13 2.13,0.38 1.04,-0.77 1.85,-2.57 0.99,0.15 1.43,-0.53 1.81,-1.55 0.95,-1.17 2.02,-0.41 3.37,-1.86 0.64,-1.11 4.27,-3.03 3.82,-1.58 1.8,0.09 1.2,0.5 2.18,0.03 2.28,0.53 0.85,0.46 -1.29,2.74 -0.15,0.89 0.26,1.49 0.61,0.5 5.33,1.46 0.64,-0.17 0.81,-1.12 1.88,-0.89 1.77,-0.26 2.73,0.75 1.1,0.54 4.35,3.64 0.98,-0.18 2.17,1.62 2.53,1.22 0.93,0.22 0.51,-0.21 1.53,1.24 4.39,-1.23 0.38,0.18 6.52,6.2 0.44,3.96 0.57,-0.21 2.61,0.45 1.47,-0.5 1.32,-0.99 1.99,0.15 2.73,0.56 2.26,1.08 2.19,0.61 2.12,-0.03 2.83,2.47 0.73,0.38 0.89,0.07 0.78,1.02 0.42,1.17 -1.47,3.08 -4.96,4.22 -0.15,2.65 0.56,1.02 0,0.42 -1.02,0.71 -2.48,-0.24 -0.82,0.88 -0.82,3.3 -0.53,4.4 0.22,0.25 0.35,-0.19 0.2,-0.45 0.64,-0.24 0.58,1.23 -0.22,1.51 0.15,0.51 4.14,3.06 0.53,1.04 0.01,0.53 -0.68,1.35 z',
                'MS': 'm 359.21257,400.07114 -0.4,2.46 -0.28,0.4 -1.5,0.78 -1.32,0.04 -0.47,0.22 -1.22,1.03 -1.99,2.68 -0.73,0.65 -1.01,0.3 -0.62,1.68 -0.16,2.93 -2.59,3.64 -0.96,0.52 -0.23,0.38 0.31,1.93 -0.08,0.95 -1.21,2.34 -2,2.26 0.35,0.85 -0.28,1.21 -1.44,1.03 -0.4,1.21 -1.73,1.69 -1.26,2.44 -1.95,1.87 -7.56,4.53 -1.26,1.14 -0.74,1.54 -0.84,1.08 0,0 -5.41,2.27 -1.11,0.82 -0.93,2.33 0.02,1.15 -1.45,3.56 -0.67,0.68 -1.66,1.01 -1.11,0.32 -0.33,0.35 -1.57,7.92 -0.36,0.82 -2.38,1.56 0,0 -2.55,-2.33 -3.41,-1.89 -3.99,1.97 -0.68,0.75 -1.66,0.49 -2.58,0.43 -2.36,-0.46 -1.01,-0.65 -0.47,-4.27 -0.32,-0.7 -0.9,-0.95 -0.23,-2.47 0.51,-1.34 -0.64,-0.79 -0.09,-0.44 0,-2.87 -0.89,-1.97 -0.6,-2.74 -0.05,-0.72 0.59,-1.36 0.02,-1.61 -1.57,-1.09 -0.38,-0.8 -0.16,-2.16 -1.65,-1.82 -2.17,-0.26 -1.51,0.31 -1.83,-0.29 -2.46,-1.96 -0.56,-1.49 -1.54,0.33 -2.17,2.74 -1,-0.6 -1.72,0.81 -1.08,0.16 -1.74,-0.69 -2.56,-0.49 -3.46,0.23 -3.66,-0.71 -0.48,-0.91 -1.99,-0.13 -0.89,0.52 -2.5,-0.88 0.91,-7.27 -0.43,-2.38 0.6,-1.42 0.98,-1.46 0.6,-6.03 -0.66,-2.33 -0.05,-1.73 -0.76,-0.96 -0.43,-0.09 -0.49,0.65 -0.64,-3.26 -0.79,-1.87 -1.21,-2.02 -0.35,-1.83 4.03,-2.3 0.76,-0.88 -4.2,-3.86 5.38,-11.42 1.12,-0.06 -0.28,-2.13 -0.74,-0.13 3.23,-10.33 0.66,-1.16 -3.09,-5.85 0.03,-1.91 0,0 0.7,0.2 1.02,1.1 2.15,1.52 5.62,-1.97 2.05,-2 2.02,-2.95 0.09,-1.17 1.4,-1.45 2.59,0.03 1.56,-0.22 0.77,0.34 1.66,-0.51 1.35,-1.25 2.02,-0.49 1.27,0.2 0.76,1.15 2.79,1.25 2.62,0.47 0.65,0.35 0.27,0.86 0.78,1.02 3.03,1.16 1.26,1.11 1.24,0.57 4.52,-0.63 1.26,-0.8 0.49,-0.85 1.43,-0.61 2.44,0.07 1.59,1.04 0.3,1.37 0.24,0.25 0.99,0.04 2.13,-0.88 1.01,0.06 5.62,-6.01 1.34,-0.13 -1.23,6.61 -1.8,0.7 -1.66,2.83 -0.19,0.46 0.15,0.53 1.3,0.11 1.74,1.27 4.62,0.27 0.57,-0.57 2.66,-0.08 0.87,0.08 1.17,0.57 1.55,-0.31 0,0 0.19,1.77 -0.26,2.58 0.23,1.11 0.28,0.41 0.66,0.19 1.14,-0.67 2.25,0.9 0.08,0.42 -1.31,1.76 -0.57,1.17 -0.26,0.84 0.13,0.33 3.8,0.7 2.78,-0.16 2.7,1.68 1.14,0.17 1.44,0.71 0.67,0.61 3.07,1.56 0.68,0.85 3.35,1.34 1.49,0.04 1.9,0.43 1.62,1.55 3.15,0.61 2.66,2.24 0.24,0.45 0,0 -0.58,0.25 -0.99,4.18 0.59,3.21 z',
                'MT': 'm 207.22257,296.31114 1.47,-1.43 4.11,-2.57 0.52,-2.45 1.43,-3.78 0.93,-1.08 1.64,-0.53 0.43,-0.41 0.58,-0.84 0.52,-2.25 1.66,-2.01 0.56,-2.24 0.07,-1.71 -0.58,-1.49 0.04,-2.05 -1.53,-3.34 -0.9,0.03 -0.58,-0.51 -0.43,-3.25 0.14,-1.32 1.36,-1.08 1.4,-1.75 0.17,-0.75 -1.41,-3.59 -1.07,-0.43 -1.11,-0.11 -3.5,0.09 -1.22,-1.11 0.24,-0.56 -17.16,-0.05 0.9,-9 -1.5,-2.75 -0.27,-1.76 0.03,-0.8 1,-3.52 -0.38,-1.93 0.94,-1.67 -0.83,-2.27 -0.15,-1.39 -0.26,-0.61 -0.78,-0.47 -0.06,-0.35 1.29,-4.99 0.76,-1.42 -0.6,-1.24 -1.4,-0.97 0,0 47.85,-0.32 1.21,-0.73 1.18,-5.22 1.38,-4.22 -0.46,-1.94 -0.66,-1.37 -0.1,-0.85 0.42,-0.85 0.86,-0.64 1.2,-1.82 0.27,-1.01 -0.34,-0.84 0.06,-0.76 0.2,-0.61 1.18,-1.2 0,0 1.17,1.08 2.45,4.06 0.4,1.76 1.37,3.96 1.32,1.93 0.77,1.62 -0.23,2.44 0.48,2.4 0.73,2.2 1.53,1.11 3,2.75 3.38,1.7 0.23,0.94 -0.04,1.1 0.23,0.49 0.95,0.4 0.82,-0.17 1.63,0.45 0.54,0.72 0.2,1.08 0.35,0.32 1.37,-0.45 3.69,1.49 34.04,2.42 62.97,3.48 0,0 -0.65,1.02 -0.56,1.89 -1.1,1.25 -0.44,3.14 -0.43,0.85 -0.37,0.27 -1.94,5.29 -0.54,2.97 -0.04,2.95 -1.88,5.99 0.06,0.86 1.39,1.34 -0.16,0.87 -0.82,0.89 -0.05,0.5 1.1,2.25 -0.47,3.31 0.01,1.57 0.52,0.58 0.44,3.05 -0.74,2.76 0.98,3.34 0.96,0.51 0.8,0.02 0,0 0.08,0.63 -0.27,1.13 -0.97,0.86 -0.35,0.9 0.16,2.72 -0.39,1.07 -2,3.17 -1.03,2.63 -1.21,0.78 0.12,5.18 -1.6,3.09 -0.58,2.74 0.48,1.14 0.01,0.8 -1.17,2.87 -0.84,2.93 -1.39,1.43 -1.21,0.73 -1.23,-0.68 -1.07,0.26 -1.65,1.01 -1.92,1.94 -0.38,0.74 -0.64,4.1 -0.71,0.96 -1.98,4.19 -0.32,0.28 -2.72,0.86 -2.65,0.13 -1.4,2.62 -1.75,0.97 -0.08,1.54 -0.82,1.43 -1.28,1.04 -0.5,1.01 -0.33,1.95 -1.25,2.02 -1.92,1.77 -2.02,0.84 -0.7,0.77 -0.38,2.91 -2.55,3.85 -0.4,3.41 0.16,0.71 1.41,2.19 0.18,3.43 0.95,2.2 0,0 -1.55,0.31 -1.17,-0.57 -0.87,-0.08 -2.66,0.08 -0.57,0.57 -4.62,-0.27 -1.74,-1.27 -1.3,-0.11 -0.15,-0.53 0.19,-0.46 1.66,-2.83 1.8,-0.7 1.23,-6.61 -1.34,0.13 -5.62,6.01 -1.01,-0.06 -2.13,0.88 -0.99,-0.04 -0.24,-0.25 -0.3,-1.37 -1.59,-1.04 -2.44,-0.07 -1.43,0.61 -0.49,0.85 -1.26,0.8 -4.52,0.63 -1.24,-0.57 -1.26,-1.11 -3.03,-1.16 -0.78,-1.02 -0.27,-0.86 -0.65,-0.35 -2.62,-0.47 -2.79,-1.25 -0.76,-1.15 -1.27,-0.2 -2.02,0.49 -1.35,1.25 -1.66,0.51 -0.77,-0.34 -1.56,0.22 -2.59,-0.03 -1.4,1.45 -0.09,1.17 -2.02,2.95 -2.05,2 -5.62,1.97 -2.15,-1.52 -1.02,-1.1 -0.7,-0.2 0,0 -0.66,-0.67 -0.32,-0.8 0.54,-0.71 -2.44,-2.15 -1.28,0.63 -0.52,-0.05 -1.17,-0.68 -0.45,-0.7 -2.02,-1.41 -1.89,-0.76 -0.3,-0.32 -0.3,-1.12 -0.23,-2.93 -0.61,-1.77 -0.19,-3.66 0.88,-1.64 1.14,-1.09 0.34,-1.78 -0.05,-1.89 -0.96,0.06 -0.4,0.6 -0.38,0.16 -26.86,-1.08 -1.05,-12.65 -5.37,-6.13 4.88,-0.06 -0.35,-7.55 -2.64,-5.32 -0.49,-1.97 0.26,-1.06 0.61,-0.55 0.65,-1.28 -1.44,-2.93 -3.11,-1.04 z',
                'PA': 'm 371.29257,235.50114 -62.97,-3.48 -34.04,-2.42 -3.69,-1.49 -1.37,0.45 -0.35,-0.31 -0.2,-1.09 -0.55,-0.72 -1.63,-0.45 -0.82,0.17 -0.95,-0.39 -0.23,-0.5 0.04,-1.1 -0.23,-0.94 -3.38,-1.7 -3,-2.76 -1.54,-1.11 -0.72,-2.2 -0.48,-2.39 0.23,-2.44 -0.77,-1.63 -1.33,-1.93 -1.37,-3.95 -0.39,-1.76 -2.45,-4.06 -1.18,-1.08 0,0 -0.57,-0.56 -0.15,-1.96 -0.64,-1.26 -1.59,-1.56 -1.07,-0.58 -0.37,-0.57 -0.83,-2.34 0.03,-1.13 0.58,-0.97 1.45,-1.13 0.78,-1.31 29.9,-64.24 -1.81,-1.67 0.13,-0.78 -0.19,-0.48 -1.39,0.35 -0.85,0.61 -1.87,-0.78 -1.1,-2.17 -2.69,-1.45 -1.27,-1.34 -0.08,-0.6 -1.32,-0.82 -1.37,-0.15 -2.25,-0.65 -2.38,-1.31 -1.88,-0.67 -1.35,-1.09 -0.63,-0.9 -4.58,-2.54 -4.64,-3.769996 -0.3,-0.44 -0.04,-0.93 -0.55,-1.83 -1.84,-1.23 -0.7,0.19 -0.36,-0.2 -1.83,-1.98 0.05,-2.11 0.35,-0.69 -0.18,-0.41 -1.69,-0.85 -0.24,-0.68 -0.18,-2.27 0.43,-1.45 -0.4,-4.86 0,0 -1.59,-16.97 0,0 0.75,0.32 0.43,0.58 -0.02,0.48 0.45,0.4 0.92,0.28 1.37,-0.71 0.47,-0.81 2.71,0.23 0.81,-1.05 -0.54,-1.81 1.79,-0.36 1.41,-1.63 2.64,1.01 1.88,0.03 0.54,-1.52 3.33,-1.62 1.97,0.39 1.16,-0.11 0.49,-0.25 1.2,-1.48 0.4,-1.4 1.46,-1.1 0.86,-0.11 0.65,0.46 2.11,-1.13 0.41,0.11 0.37,0.99 0.73,0.45 2.03,0.48 1.61,0.25 0.56,-0.6 1.67,-0.39 0.78,0.28 0.82,-0.01 0.86,-0.34 2.24,0.3 4.67,1.38 0.96,-0.14 1,-0.87 -0.03,-2.28 -2.07,-2.5 -1.24,-0.63 0.49,-1.68 1.31,-1.45 0.28,-1.11 0.31,-0.17 0.71,0.19 0.83,0.76 2.35,1.11 11.62,-2.33 1.57,1.69 1.02,0.06 0.44,-0.29 0,0 0.62,0.57 0.37,2.3 -0.62,1.3 -0.25,4.54 0.24,1.44 0.31,0.54 1.17,0.02 1.08,-0.29 3.39,0.37 1.29,0.49 1.93,1.05 0.67,0.8 0.49,1.28 1.19,0.12 1.14,0.84 0.8,0.98 0.84,0.27 1.33,-0.14 0.38,-0.42 0.94,-0.14 2.84,2.66 0.68,-0.03 0.49,1.18 -0.68,0.23 -0.19,0.72 0.76,2.83 2.02,2.26 2.57,0.73 0.17,0.33 -0.43,3.14 0.19,2.11 0.67,1.51 0.62,0.56 0.59,1.81 -0.13,1.58 1.5,3.48 0.82,0.19 0.78,-0.36 2.93,3.28 -0.08,2.43 0.41,0.94 0.95,0.19 0.33,0.47 0.31,1.58 -0.21,0.69 0.11,1.3 1.87,1.39 0.43,1.5 1.45,1.03 2.79,0.679996 1.3,-0.12 0.77,-0.339996 0.94,0.06 0,0 -0.53,0.739996 0.29,1.59 -0.17,0.53 -1.29,1.11 -1.39,0.17 -0.5,-0.18 -0.84,-0.79 -0.66,-0.15 -3.38,1.58 -0.37,0.54 -1.6,0.72 -0.63,-0.02 -1.55,0.59 0.04,0.58 6.46,-1.06 0.88,0.66 0.13,0.46 0,0.66 -0.62,0.5 0.3,0.36 0.63,-0.2 0.86,-1 1.02,-0.01 0.53,-0.27 0.6,0.12 1.07,-0.42 1.14,-0.57 3.28,-2.34 1.5,-0.35 1.84,-0.81 3.16,-1.84 0.54,-0.999996 0.67,-0.52 2.09,-1.01 0.66,-0.72 -0.25,-0.67 0.21,-0.41 1.13,-0.28 1.09,0.06 0.41,0.21 0.38,3.799996 -0.52,2.58 0.33,1.62 0.81,1.6 1.31,1.35 0.3,1.64 -0.12,0.47 -1.84,1.84 -0.47,0.13 -0.87,-0.52 -1.82,-0.52 -1.26,-0.31 -0.93,0.14 -2.13,-1.04 -0.26,-1.12 -0.88,-0.53 -2.28,3.82 -0.61,2.37 0.68,2.97 0.48,0.64 0.92,0.62 -1.01,-1.14 -0.43,-2.69 0.12,-0.52 2.57,-4.22 2.31,1.18 0.11,0.45 2.53,2.45 -0.25,2.02 -0.74,0.55 0.4,2.33 0.52,1.13 1.12,0.75 0.74,0.15 0.52,0.49 -0.34,-0.64 -0.77,-0.24 -1.2,-1.04 -0.22,-0.68 0.34,-4.2 0.82,-1.19 1.43,0.73 0.83,1.2 -0.09,0.79 1.2,0.86 0.25,-0.29 -1,-1.26 -0.92,-2.1 0,-0.44 2.26,-2.32 1.62,0.09 1.93,0.64 0.34,0.56 -0.61,0.59 0.32,0.28 0.48,0.03 1.03,-0.17 1.33,-0.9 4.09,-0.96 0.77,0.2 1.74,1.06 3.17,-0.42 1.07,-0.41 1.02,-1.01 0.98,-0.59 1.74,-0.51 0.77,0.07 0.06,0.75 -2.04,4.02 -0.24,1.5 -0.46,1.07 -0.83,1.03 -0.01,0.88 0.58,1.42 -0.32,2.47 0.88,-1.19 0.01,-1.4 1.54,-3 1.13,-3.19 1.12,-1.56 0.27,-0.27 0.76,-0.05 0.58,-0.35 1.82,-0.23 0.88,-1.35 1.51,-1.69 1.36,-2.26 0.52,-0.46 0.79,0.49 0.62,-0.46 1.62,2.34 1.19,0.59 -0.05,-0.74 -0.35,-0.75 0.62,-1.01 3.51,-0.51 -1.03,-0.32 -3.51,0.46 -0.31,-0.21 0.29,-2.43 0.51,-0.29 0.67,0.38 1.02,0.11 1.07,-3.099996 -0.68,-1.39 0.03,-0.68 1.17,-1.81 2.84,-2.48 0.36,-0.08 1.11,1.14 2.93,-2.09 0.46,-0.07 0.4,0.45 0.1,0.57 -0.32,0.67 1.07,-0.16 0.81,-0.58 0.36,-0.78 0.63,-0.19 0.28,0.15 0.74,1.39 1.33,1.2 0.2,-0.56 -0.11,-0.38 -0.96,-0.49 -0.14,-0.29 -0.13,-1.2 0.17,-0.42 0.44,-0.19 2.28,0.26 1.18,0.65 0.62,1.02 1.63,0.71 1.65,-0.78 0.53,2.14 -0.5,0.31 -0.03,0.59 0.92,-0.52 1.16,-2.35 0.38,0.23 -0.23,1.33 0.41,0.44 2.51,-0.26 0.45,0.65 0.46,1.68 -0.6,0.95 0.85,-0.5 0.26,0.37 1.89,0.14 3.53,-1.24 -0.31,1.58 -0.75,1.829996 1.47,-0.489996 0.59,-0.62 0.63,1.619996 0,0 -0.77,0.45 -0.47,1.03 0.16,1.38 -0.71,4.39 -0.57,0.74 -1.14,0.15 -0.05,0.62 0.27,0.49 0.99,-0.16 0.43,0.53 -0.08,1.61 -0.9,3.02 -0.36,0.71 -1.74,1.57 -0.5,2.38 0.13,1.64 -3.68,3.09 1.04,1.58 -0.79,0.81 0.18,1.82 -0.46,1.28 -0.83,1.45 -1.48,1.76 -1.96,1.54 -1.6,4.69 -0.29,1.9 -0.47,1.21 -2.44,2.32 -1.12,0.46 -0.62,2.88 -1.55,1.17 -0.43,1.15 -1.55,2.17 -1.17,0.92 -2.35,-0.23 -14.71,11.83 0.49,0.08 0,0 2.29,0.81 1.87,-0.24 1.29,0.12 1.02,1.66 0.39,0.31 0.87,0.14 1.26,1.17 -0.04,0.63 -0.37,0.67 -0.72,0.37 -0.97,0.07 -0.29,0.28 0.09,1.41 1.01,1.34 -0.92,2.75 -0.64,0.48 -1.46,0.46 -0.25,0.46 0.29,1.2 -0.19,1.34 -1.3,0.15 -1.51,1.34 -0.85,1.27 0.15,1.51 -0.24,0.5 -2.5,1.2 -3.41,1.14 -2.47,1.78 -0.19,0.35 0.43,2.19 0.06,2.67 -1.28,2.1 -1.41,1.68 -0.15,0.57 0.17,0.88 0.59,0.96 1.67,1.74 0.75,0.32 0.15,0.3 -0.66,4.04 -1.76,5.15 -1.08,0.81 -1.7,3.24 -0.18,0.99 -0.94,1.54 -0.74,0.85 -1.05,0.16 -1.37,0.92 -1.03,1.92 -1.21,1.68 -1.18,1.09 -1.15,1.58 -1.13,4.46 -1.6,3.66 z m 21.16,-130.31 -4.52,1.96 -3.39,0.52 -2.02,-0.31 -0.65,1.13 -1.84,1.19 -0.72,-0.61 -0.61,-1.53 -0.23,0.28 0.42,1.23 -0.34,0.81 -0.71,0.41 -3.77,-1.64 -0.8,0.72 -4.19,1.26 -3.2,-0.57 -0.81,-0.61 -0.24,-1.85 -0.23,-0.41 -1.11,-1.02 -1.06,-1.6 -0.21,-1.78 0.52,-2.75 0.62,-0.379996 1.76,0.359996 0.93,-0.749996 0.08,-0.56 -1.3,0.43 -1.22,-0.13 -0.94,-0.71 -0.18,-1.05 0.34,-5.08 0.73,-0.76 0.35,0.75 1.76,0.6 0.55,-0.06 -0.46,-0.42 -1.27,-0.22 -0.9,-2.16 0.36,-1.68 0.89,-1.97 1.33,-1.33 0.96,-0.57 1.34,-0.49 1.32,-0.13 3.46,0.52 7.21,1.77 3.7,-0.46 0.11,-0.3 1.14,-0.62 2.16,-0.37 2.89,0.29 2.8,0.82 6.48,0.85 0.63,0.47 -0.05,1.23 -0.7,0.74 -0.68,1.5 -0.36,2.65 -0.86,3.3 -1.29,0.68 -0.35,0.69 0.23,1.19 -1.98,2.579996 -1.39,3.5 -0.49,0.45 z m -47.21,-0.17 -0.75,-0.51 1.1,-2.25 -0.09,-1.79 0.25,-0.21 2.33,-0.479996 0.9,-0.86 0.15,-0.5 -0.2,-2.34 0.86,-2.58 1.26,-1.49 2.29,-1.47 2.87,-0.2 0.72,2.36 -1.1,2.19 -0.85,3.04 -1.1,0.67 -1.34,2.029996 -0.78,0.72 -4.94,3.31 -1.58,0.36 z m 28.48,-22.899996 -1.03,-0.25 -2.45,0.08 -0.79,-0.16 -0.29,-0.26 -0.38,-1.09 0.01,-1.24 1.51,-0.42 1.89,0.04 2.19,-1.29 4.81,-0.6 0.77,0.26 0.68,0.68 -0.18,1.02 -2.56,1.39 -1.78,2.48 -1.1,0.5 -1.3,-1.14 z m 4.79,0 1.86,-1.2 1.98,0.03 1.65,0.62 0.53,0.99 0.05,0.62 -0.88,0.77 -2.85,0.28 -1.17,0.32 -2.26,-0.89 -0.2,-0.53 1.29,-1.01 z m -16.98,4.39 -0.5,-0.26 -0.61,0.04 -1.54,-0.69 0.21,-1.16 0.64,-0.92 1.92,-0.4 2.36,-0.9 1.32,0.08 0.8,0.68 0.09,0.13 -1.93,1.61 -1.07,0.34 -1.69,1.45 z m 9.42,-9.69 -0.82,-0.3 -0.17,-1.66 0.15,-0.6 1.17,-1.31 2.45,-0.92 0.25,0.12 0.53,0.68 0.04,0.89 -1.95,1.99 -1.65,1.11 z m -13.83,20.22 -0.14,-0.41 0.19,-0.93 1.04,-2.81 2.59,-1.69 0.72,-0.28 0.69,0.14 -0.16,1.79 -1.56,0.44 -1.62,2.19 -1.75,1.56 z m 10.91,-17.57 -1.19,-0.31 -0.3,-0.48 0.88,-0.96 0.71,-3.95 0.89,-1.23 0.29,0.13 0.07,0.32 -0.02,2.48 0.6,1.87 -0.32,0.88 -1.03,0.4 -0.58,0.85 z m -14.81,10.19 -0.27,-0.19 0.12,-0.61 0.55,-0.36 1.19,-1.71 0.76,-1.54 0.73,-0.66 1.45,-0.54 -0.2,1.49 -0.4,1 -1.72,1.66 -2.21,1.46 z m 13.87,-7.03 -0.6,-0.15 -0.84,-0.71 -0.96,-1.64 -0.05,-0.38 0.23,-0.29 0.81,-0.58 1.85,0.84 0.29,0.43 0.24,2.09 -0.97,0.39 z m -5.38,30.559996 -0.65,-0.11 -0.88,-0.52 -0.69,0.46 -0.75,-0.28 -1.68,-1.74 0,-0.61 1.28,-0.01 3.06,1.32 0.31,1.49 z m -21.15,-5.54 0.04,-1.03 -0.2,-0.3 0.6,-0.99 2.36,-0.88 0.78,0.38 0.87,0.86 -0.29,0.35 -1.03,0.47 -2.54,0.41 -0.59,0.73 z m 12.7,-6.69 -0.18,-0.03 0.01,-0.35 0.54,-0.939996 1.79,-1.62 0.42,-1.24 0.05,-1.3 0.24,-0.3 0.32,0.44 0,1.51 -0.89,2.73 -0.62,0.649996 -1.68,0.45 z m 6.3,-9.899996 1.65,-2.96 0.88,-0.21 0.71,0.19 0.27,0.87 -0.58,0.71 -2.93,1.4 z m 31.42,18.969996 -0.84,-0.35 -0.34,-1.06 1.04,-1.72 1.07,-0.33 0.19,0.1 -0.02,0.74 -0.74,2.24 -0.36,0.38 z m -33.48,-19.469996 -0.54,-0.2 0.32,-2.04 1.33,-1.81 0.23,0.04 1.29,0.88 -0.01,0.25 -1.55,0.64 -1.07,2.24 z m 2.23,5.03 0.72,0.03 -0.4,0.45 -0.94,0.31 -0.11,1.12 -0.79,0.71 -1.69,0.84 -0.16,-0.18 0.27,-0.83 0.47,-0.63 1.73,-1.67 0.9,-0.15 z m -22.56,10.209996 -0.55,-0.19 -0.07,-0.35 0.43,-0.4 3.56,-1.6 0.54,0.7 -0.01,0.2 -1.4,0.73 -2.5,0.91 z m 63.53,-4.78 -1.03,-0.19 -0.82,-0.79 0.87,-1.249996 1.34,-0.01 0.19,1.19 -0.1,0.589996 -0.45,0.46 z m -37.25,-18.899996 -2.36,0.7 -0.59,0.01 -0.18,-0.21 1.03,-1.04 1.04,-0.51 1.04,0.17 0.44,0.34 0.15,0.23 -0.15,0.21 -0.42,0.1 z m -5.27,8.59 -0.08,-0.76 0.25,-0.5 2.48,-1.46 -0.9,2 -0.81,0.63 -0.94,0.09 z m 2.14,4.53 -0.45,-0.12 -0.07,-0.23 0.78,-1.5 1.19,0.02 -0.12,1.35 -1.33,0.48 z m 28.04,15.829996 -0.28,-0.23 0.9,-1.6 0.68,-0.4 0.23,0.75 0.51,0.37 -0.26,0.52 -0.43,0.34 -0.63,-0.18 -0.72,0.43 z m -26.66,-23.319996 -0.89,-0.07 0.02,-0.19 2.36,-1.84 0.04,0.96 -0.23,0.63 -0.25,0.34 -1.05,0.17 z m 67.46,10.22 -0.38,-0.53 0.19,-0.76 1.02,-0.91 0.25,0.15 0.23,1.75 -1.31,0.3 z',
                'PB': 'm 610.69257,199.41114 -2.5,-2.06 -0.82,-0.26 -2.65,-0.21 -2.31,1.07 -1.48,1.28 -0.45,1.8 -1.9,1.03 -2.01,0.45 -1.14,-0.02 0,0.6 -0.8,0.53 -2.18,0.29 -3.88,-0.26 -1.61,0.88 -0.55,0.64 -1.82,0.1 -0.89,0.69 -0.54,0.76 0.39,0.73 0.01,0.54 -0.4,0.48 -1.78,1.53 -1.34,0.16 -1.65,0.84 -1.6,-0.79 -0.95,-0.94 -0.35,-2.24 0.24,-0.49 -0.18,-0.3 -1.14,-0.32 -0.44,0.29 -1.51,0.25 0.04,-0.45 2.53,-2.64 0.17,-0.43 -0.72,-1.87 -0.04,-0.47 0.37,-0.78 3,-1.07 0.11,-0.3 -0.5,-1.39 -3.5,-1.92 -1.48,0.41 -2.22,1.26 -0.93,1.51 -1.48,0.87 -1.05,0.31 -2.7,1.88 -1.52,1.64 -1.63,0.23 -2.63,0.97 -0.77,-0.33 0.05,-0.68 -0.63,-1.24 -0.38,-0.08 -0.93,0.73 -1.51,0.32 -0.99,-0.33 -1.4,-1.91 -0.4,-0.09 0,0 -0.17,-0.25 1.19,-1.12 1.61,-3.49 -0.34,-1.19 -0.69,-0.08 -1.24,-0.89 0.02,-1.66 -0.35,-0.72 -0.58,-0.29 -0.24,-0.41 0.12,-0.93 0.17,-0.38 1.09,-0.63 0.66,-1.31 -0.52,-1.31 1.03,-3 0.84,-1.15 0.08,-0.54 0,0 0.57,-0.46 1.93,1.64 0.9,0.42 2.88,0.61 1.16,-1.13 3.23,-1.66 0.82,-0.71 0.1,-1.04 0.41,-0.95 3.18,-1.21 1.43,-0.12 3.26,-1.04 0.64,0.08 0.53,0.44 0.01,1.19 -2.99,3.21 -0.44,0.96 -0.38,1.74 -0.41,0.38 -0.85,0.25 -0.21,0.31 -0.08,1.72 3.53,0.52 0.32,0.23 0.31,1.38 0.29,0.23 3.15,-1.26 1.77,-0.08 1.95,0.3 0.89,1.17 -0.52,1.54 0.83,0.74 2.35,-0.93 0.5,-0.74 0.55,-1.21 -0.47,-0.94 -0.16,-1.42 0.48,-0.59 1.01,0.32 -0.53,-1.53 -0.72,-0.78 0.31,-1.48 1.82,-1.35 1.38,-0.05 0.42,0.39 -0.1,1 0.62,0.49 3.42,0.4 0.53,0.35 5.83,-0.39 2.17,0.3 2.46,1.1 1.04,-0.4 3.5,0.21 0.93,-0.24 0,0 0.09,2.4 1.45,4.39 0.06,0.64 -0.18,0.94 -0.37,0.45 -0.03,0.88 0.58,-0.74 0.51,-1.5 0.01,1.98 0.59,1.01 -0.27,5.18 -0.36,0.6 z',
                'PE': 'm 558.54257,227.45114 -1.22,-3.04 -0.01,-0.94 -2.11,-0.86 -0.5,-0.37 -0.45,-0.83 0.61,-0.89 -0.02,-0.62 -0.45,-0.32 -1,0.01 -0.43,0.44 -0.29,1.74 -0.43,0.15 -0.39,-0.26 -0.54,-1.65 -1.58,-1.15 -2.99,-0.4 -2.36,-0.77 -1.35,-0.81 -0.83,-1.44 -1.49,-0.56 -0.59,0.11 -2.53,1.46 -1.65,0.44 -0.77,2.05 -2.23,0.45 -0.29,0.25 0.25,1.36 -0.17,0.59 -1.1,1.24 -2.39,1.03 -0.64,-0.06 -0.77,-0.53 -0.76,0.17 -0.5,0.87 -0.77,3.57 -2.87,0.88 -0.82,0.92 -0.96,0.23 -1.84,-0.62 0.92,-1.68 -0.26,-2 -2.21,-0.91 -0.72,-1.94 0.06,-2.73 -0.44,-0.51 -2.81,-1.38 -2.2,-0.29 -1.16,0.26 -0.9,-0.4 0,0 2.62,-1.27 1.97,-1.71 0.54,-0.87 2.29,-1.33 0.97,-0.28 3.89,-3.87 0.74,-1.76 0.06,-2.27 -0.29,-0.54 -1.62,-1.58 0.07,-2.19 -0.6,-1.13 -0.06,-0.95 0.11,-0.45 0.52,-0.33 1.79,-0.16 0,0 4.93,0.2 0.89,0.24 1.63,-0.19 2.14,-0.8 1.29,-0.1 3.08,0.42 2.85,1.9 1.83,0.83 0.46,0.99 1.01,1.07 1.36,0.48 0.78,0.57 0.63,1.64 1.65,-0.05 1.54,-2.29 1.07,-0.83 1.59,-0.49 0,0 0.4,0.09 1.4,1.91 0.99,0.33 1.51,-0.32 0.93,-0.73 0.38,0.08 0.63,1.24 -0.05,0.68 0.77,0.33 2.63,-0.97 1.63,-0.23 1.52,-1.64 2.7,-1.88 1.05,-0.31 1.48,-0.87 0.93,-1.51 2.22,-1.26 1.48,-0.41 3.5,1.92 0.5,1.39 -0.11,0.3 -3,1.07 -0.37,0.78 0.04,0.47 0.72,1.87 -0.17,0.43 -2.53,2.64 -0.04,0.45 1.51,-0.25 0.44,-0.29 1.14,0.32 0.18,0.3 -0.24,0.49 0.35,2.24 0.95,0.94 1.6,0.79 1.65,-0.84 1.34,-0.16 1.78,-1.53 0.4,-0.48 -0.01,-0.54 -0.39,-0.73 0.54,-0.76 0.89,-0.69 1.82,-0.1 0.55,-0.64 1.61,-0.88 3.88,0.26 2.18,-0.29 0.8,-0.53 0,-0.6 1.14,0.02 2.01,-0.45 1.9,-1.03 0.45,-1.8 1.48,-1.28 2.31,-1.07 2.65,0.21 0.82,0.26 2.5,2.06 0,0 0.88,0.23 0.55,1.22 -1.27,1.72 -0.11,0.55 0.01,0.48 0.7,0.37 0.27,0.5 0.19,1.06 -1.96,6.38 -3.25,8.95 0,0 -0.27,-0.21 -2.9,-0.27 -1.92,-0.81 -1.47,0.19 -2.56,1.29 -2.24,-0.85 -2,0.24 -1.55,1.24 -0.12,0.45 -2.18,2.29 -1.81,1.11 -1.16,-0.05 -1.86,1.06 -1.17,0.11 -3.14,-0.29 -2.5,0.65 -1.91,-0.48 -1.78,-1.05 -1.9,-2.12 -2.55,-2.02 -1.08,0.12 -1.67,-0.3 -1,-1.22 -0.82,0.6 -0.09,0.69 -2.38,3.29 -2.17,0.76 -0.64,1.09 z',
                'PI': 'm 505.96257,127.17114 1.31,0.12 0.69,-0.23 2.24,0.51 0.99,0.85 0.32,0.6 0,0 -0.11,0.8 -1.09,1.85 -1.58,1.97 -0.18,1.46 0.29,1.29 1.8,4.72 3.15,6.42 0.44,1.73 1.36,1.59 -0.02,0.76 -0.74,1.36 0.79,3.87 -0.48,1.6 1,2.01 0.6,2.99 -0.59,1.58 -0.8,0.58 0.92,0.69 0.11,0.38 0.94,8.16 -0.24,0.45 0.76,2.57 1.05,5.2 1.01,2.67 1.31,0.65 2.56,0.47 0.77,1.16 -0.01,0.69 -1.5,2.25 -1.14,3.11 0.08,0.97 0.68,0.68 -0.06,1.32 0,0 -1.79,0.16 -0.52,0.33 -0.11,0.45 0.06,0.95 0.6,1.13 -0.07,2.19 1.62,1.58 0.29,0.54 -0.06,2.27 -0.74,1.76 -3.89,3.87 -0.97,0.28 -2.29,1.33 -0.54,0.87 -1.97,1.71 -2.62,1.27 0,0 -0.45,1.16 -1.5,2.3 -1.05,0.67 -0.79,-0.18 -2,0.38 0.11,2.4 -1.86,1.8 -0.32,-0.05 -0.62,-0.62 -2.16,-0.01 -0.82,0.98 -0.77,0.36 -2.73,0.34 -1.51,1.34 -0.82,1.22 -1.7,0.1 -1.48,0.64 -3,0.11 -0.82,-0.28 -0.19,-0.28 0.13,-0.66 -1.71,-0.98 -1.33,-0.39 -1.39,0.55 -2.13,0.43 -0.32,-0.18 -0.41,-0.93 -1.5,-0.46 -1.95,0.02 -3.24,1.65 -0.06,0.93 2.24,4.44 0.12,1.15 -0.29,2.57 -0.25,0.91 -0.72,0.86 -2.95,5.05 -2.97,2.42 -1.35,0.42 -1.48,-0.53 -1.34,-0.17 -2.2,0.75 -1.17,0.89 -0.67,0.87 -1.14,0.38 -0.75,1.45 -0.33,0.21 -2.11,-0.18 -1.8,0.52 -4.18,-1.85 -1.77,-2.49 -0.53,-2.21 -0.66,-1.04 -1.44,-1.34 -2.33,0.02 0,0 -2.94,-0.21 0,0 0.05,-1.92 0.26,-1.06 1.15,-2.45 0.13,-6.36 0.76,-1.4 0.03,-0.51 -1.73,-3.06 -0.47,-3.19 -0.7,-1.94 0.73,-2 1.7,-1.4 1.2,-2.48 0.13,-1.51 0.34,-0.83 0.3,-0.21 1.44,-2.74 0.63,-2.32 0.39,-2.97 0.98,-2.98 2.13,-1.95 2.72,-0.76 2.61,-0.31 1.07,-0.37 1.7,-1.53 1.05,-0.04 1.34,-0.52 2.86,-2.57 2.34,-0.91 2.01,-2 0.63,-0.87 0,-0.46 1.9,-1.92 0.5,-0.22 0.84,-0.24 0.23,0.3 1.12,-0.26 1,-0.6 1.46,-0.19 1.01,0.21 2.51,1.82 1.51,-0.1 2.44,-0.86 0.83,-0.04 0.65,0.28 2.28,-0.29 1.21,-1.31 0.5,-1.46 0.12,-1.21 0.29,-0.44 0.39,-2.2 -0.13,-0.85 -0.17,-0.5 -1.61,-0.91 -1.78,-2.03 -0.51,-2.3 -0.11,-2.11 0.17,-2.48 4.1,-4.43 0.21,-0.55 0.1,-2.43 -0.55,-2.98 -1.58,-2.8 1.14,-2.87 0.28,-1.47 -0.38,-1.27 -1.23,-0.84 -0.35,-1.92 0.77,-1.05 0.64,-0.17 0.82,-1.98 1.89,-1.85 0.88,-1.83 -0.04,-1.79 2.92,-3.41 0.81,0.16 3.31,-0.46 4.13,-3.97 1.79,-2.27 0.39,-1.53 -0.64,-0.53 -0.22,-0.72 0.46,-1.44 0,0 0.73,0.12 1.47,0.87 0.51,0.51 -0.13,0.31 z',
                'PR': 'm 397.01257,499.66114 -5.24,-0.03 -0.33,0.44 -1.74,0.24 -0.76,-0.07 -0.11,-0.39 -1.57,0.57 -1.35,1.43 -3.35,2.13 -1.44,-0.16 -1.23,-0.62 -3.13,-2.6 -1.03,-0.39 -0.76,-0.01 -2.84,0.73 -2.33,0.17 -0.81,-0.03 -1.42,-0.76 -1.11,0.14 -1.53,0.65 -0.59,1.47 -0.73,0.87 -1.87,0.98 -3.57,-0.41 -2,1.15 -0.72,0.77 -0.69,1.59 0.85,2.99 -0.87,0.86 -0.92,0.02 -0.75,0.38 -0.17,0.49 -1.33,-1.89 -4.25,0.13 -3.76,-0.43 -1.58,-1.18 -0.16,-0.41 -1.03,-0.63 -4.26,-0.36 -5.29,-1.68 -2.34,0.57 -2.69,-0.03 -2.02,-1.41 -0.32,-0.51 -1.06,-0.24 -0.53,-0.01 -0.71,0.37 -3.63,-0.02 0,0 -0.22,-1.21 -2.53,-4.18 0.02,-2.59 -0.99,-2.88 -3.42,-2.37 -1.09,1.13 -2.12,-0.11 -1.1,0.43 -1.07,0.9 -1.46,-1.08 -0.82,0.06 -0.28,-2.2 0.66,-1.57 1.07,-1.27 1.22,-2.18 0.06,-0.34 -0.49,-0.75 0.02,-1.24 0.9,-3.64 1.26,-3.02 -0.25,-2.3 1.28,-2.38 -0.21,-1.02 -0.84,-0.88 -0.31,-1.6 0.66,-1.06 0.79,-0.54 0,0 2.38,-1.56 0.36,-0.82 1.57,-7.92 0.33,-0.35 1.11,-0.32 1.66,-1.01 0.67,-0.68 1.45,-3.56 -0.02,-1.15 0.93,-2.33 1.11,-0.82 5.41,-2.27 0,0 3.26,-2.29 3.83,0.65 4.01,-0.11 3.27,0.29 1.21,-0.62 0.35,-0.6 0.73,-0.37 1.17,0.29 1.48,0.78 2.52,0.46 2.64,1.09 1.31,0.13 1.07,-0.54 2.58,-0.01 0.78,1 1.75,0.84 3.51,0.8 0.63,0.51 0.71,1.32 1.73,0.07 0.42,-0.34 1.65,0.15 0.66,0.54 5.31,0.13 2.97,-0.85 1.13,1.55 3.59,2.83 0.89,1.76 0.01,2.74 -0.39,0.58 -0.16,0.81 0.38,1.84 1.3,1.51 -0.08,1.76 -0.36,0.56 1.49,3 1.21,1.15 0.67,0.28 0.5,0.68 -0.05,0.89 0.92,1.97 0.6,0.29 0.25,0.44 -0.25,1.05 -1.27,2.13 0.32,2.04 0.6,0.38 1.01,0.21 2.38,-0.12 3.42,-0.53 0.5,0.39 1.58,-0.19 1.59,0.13 1.61,1.26 -0.14,0.41 -0.89,0.65 -0.69,3.3 0.35,0.78 1.07,0.53 0.65,-0.85 1.1,-2.76 0.76,-0.17 2.14,0.58 -0.4,1.95 0.73,3.3 1.42,0.58 0.16,1.32 0,0 -1.35,1.02 -0.61,1.48 -0.55,-0.12 0.27,-1.94 1.44,-0.95 -1.41,0.28 -0.89,0.49 -0.87,-0.02 -0.34,-0.39 -0.57,-0.17 -0.54,0.37 -0.28,0.93 0.52,0.8 -0.73,0.96 -0.3,0.1 -2.48,-0.53 -0.79,-0.54 -0.45,0.12 -0.18,0.9 0.34,0.37 1.61,0.56 1.4,-0.25 2.13,0.6 0.27,0.48 -0.97,0.68 -1.54,2.78 -1.24,0.77 -2.42,0.57 -0.2,0.45 2.95,-0.2 0.15,1.19 z',
                'RJ': 'm 468.61257,450.54114 -0.07,-0.78 0.38,-0.27 3.19,0.22 2.59,-0.59 -2.53,-1.55 -1.4,-0.5 -2.81,0.68 -1.36,1.6 -1.03,0.32 -0.7,-0.05 -1.35,-2.15 -0.48,0 -0.9,0.42 -0.96,1.06 -3.15,0.8 -0.34,0.91 -0.19,1.9 2.19,0.13 1.07,1.01 -1.15,1.08 -0.94,-0.17 -1.42,0.17 0,0 -0.48,-0.26 -1.63,-1.73 -0.05,-0.41 1.09,-3.5 1.09,-1.15 2.35,-1.01 0.5,0.15 2.77,-0.36 1.5,-0.71 1.65,-2.15 -0.75,-1.64 -1.7,-0.01 -3.15,0.53 -1.77,-0.39 -1.23,-1.59 -0.56,-1.17 -1.27,-0.54 0,0 0.68,-0.49 2.42,-0.74 2.91,-1.34 2.58,-0.17 0.5,0.27 1.72,-0.77 1.05,-0.77 4.09,-1.79 0.52,-0.07 0.36,0.31 3.2,-0.07 1.25,-0.17 1.63,-0.94 0.57,-0.06 2.53,0.27 0.49,0.17 -0.02,0.47 1.38,-0.2 9.51,-4.53 2.53,-0.99 0.21,-0.52 -0.28,-0.61 -1.44,-0.13 0.09,-0.75 1.89,-3.71 2.36,-6.04 -0.73,-0.71 0.56,-0.49 1.24,-0.27 2.53,-2.36 0,0 1.93,0.76 0.67,4.71 2.5,1.13 4.33,1.01 2.99,-0.37 1.62,1.06 0,0 -0.08,1.27 -0.94,1.61 -0.22,2.13 1.14,6.78 -0.5,0.68 -3.08,1.75 -5.97,1.94 -2.83,1.72 -3.5,3.69 -0.11,1.66 0.31,1.19 -0.19,1.62 -0.73,1.48 -1.82,0.51 -6.55,-0.17 -5.79,0.7 -2.39,-0.46 -0.49,-0.38 -0.06,-0.68 1.03,-1.48 0.67,-1.45 -0.09,-0.62 -0.78,-0.18 -2.79,1.15 -0.26,0.69 0.31,0.79 1.38,1.17 0.25,0.97 -0.59,0.52 -1.63,0.51 -1.57,-0.03 -8.04,1.07 -1.46,0.45 z m -5.11,1.99 -0.67,-0.97 2.11,-1.55 1.86,0.94 0.43,0.7 -2.46,0.5 -0.41,-0.35 -0.47,0 -0.39,0.73 z',
                'RN': 'm 609.55257,183.17114 -0.93,0.24 -3.5,-0.21 -1.04,0.4 -2.46,-1.1 -2.17,-0.3 -5.83,0.39 -0.53,-0.35 -3.42,-0.4 -0.62,-0.49 0.1,-1 -0.42,-0.39 -1.38,0.05 -1.82,1.35 -0.31,1.48 0.72,0.78 0.53,1.53 -1.01,-0.32 -0.48,0.59 0.16,1.42 0.47,0.94 -0.55,1.21 -0.5,0.74 -2.35,0.93 -0.83,-0.74 0.52,-1.54 -0.89,-1.17 -1.95,-0.3 -1.77,0.08 -3.15,1.26 -0.29,-0.23 -0.31,-1.38 -0.32,-0.23 -3.53,-0.52 0.08,-1.72 0.21,-0.31 0.85,-0.25 0.41,-0.38 0.38,-1.74 0.44,-0.96 2.99,-3.21 -0.01,-1.19 -0.53,-0.44 -0.64,-0.08 -3.26,1.04 -1.43,0.12 -3.18,1.21 -0.41,0.95 -0.1,1.04 -0.82,0.71 -3.23,1.66 -1.16,1.13 -2.88,-0.61 -0.9,-0.42 -1.93,-1.64 -0.57,0.46 0,0 -0.66,0.38 -0.64,-0.17 0.34,-1.97 1.41,-2.25 0.84,-0.88 0.51,-0.07 0.78,0.51 1.03,-0.26 0.57,-1.1 1.46,-1.51 1.4,-2.44 -0.15,-0.74 0.65,-1.67 0.87,-0.57 0.84,-1.12 3.3,-6.69 2.61,-2.01 4.89,-1.59 0,0 0.47,0.76 0.86,0.75 3.13,-0.01 1.22,0.41 1.69,1.75 1.32,0.5 3.33,-0.32 2.88,0.52 2.54,-0.24 2.33,-0.73 4.5,0.92 1.27,0.04 1.95,0.86 1.02,0.82 0.64,0.94 2.31,4.74 0.5,1.79 -0.04,0.75 1.48,5.38 0.21,1.68 0.72,0.54 0.96,2.69 z',
                'RO': 'm 187.58257,291.21114 -1.29,-1.45 -0.44,-1.88 -1.56,-0.52 -0.86,0.32 -1.81,0.08 -4.07,-1.81 -0.01,-0.4 -0.66,-0.61 -1.27,0.59 -1.98,-1.68 -1.52,-0.97 -0.86,-1.46 -0.28,-1.39 -1.04,-0.39 -1.77,1.12 -1.22,-0.03 -1.41,-0.8 -0.87,-1.33 -3.13,-1.58 -1.96,-0.17 -1.14,0.54 -0.9,0.85 -1.43,-0.17 -0.31,-0.3 -2.14,-0.51 -3.06,-0.28 -0.76,-0.43 -1.18,-1.19 -0.3,-1.97 -1.58,-0.49 -1.89,-0.97 -0.82,-1.72 -0.29,-0.2 -2.72,-0.28 -0.38,-0.35 -0.84,-3.71 -0.88,-0.89 -0.48,1.16 -0.66,-0.32 -0.27,-0.64 0.62,-1.53 -0.84,-1.52 -1.36,-0.39 -1.26,-3.47 -0.17,-1.66 1.55,-2.91 -0.21,-1.66 -1.16,-1.97 -0.75,-2.16 -0.06,-2.29 0.62,-0.5 0.38,-1.37 1.04,-1.05 0.36,-1.47 -0.24,-1.49 -0.42,-0.89 -0.09,-1.53 0.54,-1.65 -1.17,-2.18 -1.02,-0.38 -1.09,0.98 -0.06,0.51 -0.84,0.96 -0.57,0 -2.18,-1.02 -5.18,0.08 -5.61,1.78 -1.69,-0.01 -1.48,0.48 0,0 -2.97,-1.26 0,0 3.26,-2.56 1.92,-0.58 1.55,-1.81 0.15,-0.56 -0.16,-1.29 3.96,0.26 2.87,-0.33 0.72,0.37 2.31,2.33 0.37,-0.02 1.22,-0.79 0.13,-0.72 0.41,-0.53 1.08,-0.5 0.77,0.13 1.37,-0.39 1.3,-1.21 1.84,-1.02 0.38,0.09 0.64,2.26 0.68,0.53 0.68,-0.08 2.54,-3.16 -0.26,-1.75 0.53,-0.84 1.75,-1.26 0.46,0.02 0.84,0.55 1.79,0.1 1.2,-1.07 2.13,-0.38 3.87,0.46 -0.24,-1.46 0.11,-1.81 2.06,-1.21 0.81,-1.15 0.36,-1.02 -0.17,-0.45 -0.9,-0.7 0.05,-0.67 1.19,-1.59 2.48,-0.53 0.26,-0.22 -0.09,-1.17 1.72,-0.5 1.38,-2.56 10.79,-0.06 2.15,1.13 0.45,0.49 0.8,1.91 1.33,1.27 2.54,0.98 1.25,3.27 0.46,0.21 0.98,-0.13 0.62,0.2 0.68,2.88 3.24,1.48 0.68,-0.19 0.54,-1.74 1.92,-1.08 1.39,0.28 0.36,0.38 -0.04,0.7 0,0 1.4,0.97 0.6,1.24 -0.76,1.42 -1.29,4.99 0.06,0.35 0.78,0.47 0.26,0.61 0.15,1.39 0.83,2.27 -0.94,1.67 0.38,1.93 -1,3.52 -0.03,0.8 0.27,1.76 1.5,2.75 -0.9,9 17.16,0.05 -0.24,0.56 1.22,1.11 3.5,-0.09 1.11,0.11 1.07,0.43 1.41,3.59 -0.17,0.75 -1.4,1.75 -1.36,1.08 -0.14,1.32 0.43,3.25 0.58,0.51 0.9,-0.03 1.53,3.34 -0.04,2.05 0.58,1.49 -0.07,1.71 -0.56,2.24 -1.66,2.01 -0.52,2.25 -0.58,0.84 -0.43,0.41 -1.64,0.53 -0.93,1.08 -1.43,3.78 -0.52,2.45 -4.11,2.57 -1.47,1.43 0,0 -0.74,-0.04 -2.59,-1.55 -1.27,-1.43 -7.08,0.96 -1.32,-0.43 -0.25,-0.3 -3.38,0.66 -0.48,-0.16 -0.52,-1.35 z',
                'RR': 'm 234.87257,61.661144 1.6,16.97 0,0 -18.49,-0.07 0.03,0.68 -2.33,3.26 -1.66,3.03 -0.07,1.13 -1.15,2.64 -0.11,0.66 0.23,0.73 1.14,1.41 -0.02,0.53 -0.42,0.39 -2.03,0.55 -1.41,1.41 -1.25,0.46 -1.82,-0.23 -0.92,-2.51 -1.87,-2.04 -2.83,-0.93 -1.6,0.06 -0.55,0.89 -2.09,0.71 -1.28,0.69 -1.02,1.26 -0.82,2.97 0.37,1.8 -0.25,1.73 -0.75,2.289996 0.44,2.11 -2.36,-1.04 -1.34,0.42 -0.53,-0.07 -1.04,-2.04 -1.48,-1.649996 -1.96,-1.31 -0.52,-0.04 -5.01,-4.42 0.14,-1.14 1.84,0.33 1.14,-1.32 0.06,-0.58 -1.13,-4.33 -0.58,-0.9 -1.22,-0.84 -0.88,-2.17 -0.29,-4.98 0.57,-0.96 0.77,-3.04 -0.66,-1.58 -0.36,-1.59 1.62,-1.46 -0.05,-0.45 -0.87,-1.12 -0.19,-2.26 -1.66,-4.76 -2.73,-3.74 0.71,-1.5 0.91,-3.32 -0.49,-0.66 -1.95,-0.95 -1.36,-0.11 -0.88,0.21 -0.97,-0.37 -1.21,-1.17 -0.06,-0.96 -0.63,-0.11 -1.13,0.42 -0.61,-0.01 -0.75,-0.34 -0.72,-0.78 0,0 0.3,-0.46 0.23,-2.28 -0.3,-0.22 -3.37,-0.23 -3.75,0.14 -3.31,-0.7 -0.2,-0.6 0.8,-1.76 0.12,-1.48 -0.73,-1.77 -1.94,-3.54 -0.73,-2.06 -0.47,-3.72 0.79,-1.48 -0.08,-0.96 -1.84,-2 -2.16,-1.06 -2.81,-2.78 -1.06,-1.81 -0.29,-0.96 -1.14,-0.65 -0.25,-0.39 0.03,-0.84 0.29,-0.33 0.9,0.07 1.12,0.66 0.94,1.73 0.61,0.09 3.39,-0.5 1.35,0.1 1.91,0.59 0.61,1.2 0.55,1.93 0.54,0.35 0.96,-0.08 0.74,-0.65 0.95,-0.4 3.18,0.16 0.47,0.05 1.31,1.21 0.6,0.15 0.52,-0.14 0.61,-1.56 1.31,0.14 1.45,0.93 3.93,4.57 1.05,0.57 0.71,0.11 1.51,-0.68 0.74,-1.13 0.1,-0.84 -0.83,-2.76 0.36,-1.74 0.46,-0.28 1.93,-0.05 1.01,-1.1 1.55,-1.09 0.75,0.05 3.9,1.34 0.59,-0.17 0.8,-0.72 1.03,-0.3 1.13,0.35 1.03,-0.21 1.34,-1.28 1,-0.25 1.15,0.23 1.11,-0.07 0.68,-0.85 0.05,-1.35 3.03,-1.81 2.33,0.19 2.76,-0.39 0.89,-1.13 0.09,-0.71 0.59,-1.1199998 0.75,-0.13 1.85,-0.9 1.1,-1.04 1.11,-1.71 -1.2,-3.56 -1.17,-0.36 0.64,-0.18 1.43,0.07 0.8,0.32 3.57,-0.1 1.06,-0.95 0.74,-0.22 1.37,0.42 0.53,1.31 1.04,0.8 0.48,1.37 -0.67,4.9 -0.72,1.3799998 -1.25,0.7 0.06,0.83 1.61,0.41 1.62,-0.22 2.35,0.81 1.82,1.1 -0.88,1.43 -0.01,1.15 2.34,3.42 0.2,1.55 -1.51,2.92 -1.88,1.41 -0.72,1.5 0.27,0.39 0.06,2.17 -1.47,2.41 -0.9,2.77 -0.31,2.57 -0.09,2.67 0.98,1.87 0.51,1.76 -0.01,1.4 1.57,1.03 0.9,0.2 0.13,0.68 -0.46,5.15 0.12,0.74 1.81,0.29 -0.66,1.17 0.46,0.5 2.15,0.74 1.46,1.92 2.66,2.74 z',
                'RS': 'm 322.25257,638.78114 -0.36,0.01 -1.94,-1.11 -0.2,-0.46 0.52,-4.27 -0.46,-4.25 0.15,-1.07 0.63,-1.24 2.84,-2.38 0.83,-1.56 2.3,-2.56 -1.46,-1.65 -1.07,-0.62 -2.25,-0.6 -2.32,-2.25 -1.21,-1.62 -0.1,-1.59 -0.43,-1.18 -1.23,-2.03 -2.06,-2.24 -0.67,-0.59 -2.39,-1.21 -1.45,0.21 -1.9,-1.51 -1.52,-1.63 -1.25,-0.78 -0.14,-1.7 -1.9,-2.16 -3.32,-0.46 -0.92,-0.47 -1.73,-1.66 -1.76,0.13 -2.17,-1.38 -1.91,-3.71 -1.11,-1.49 -2.53,-2.12 -0.7,0.08 -0.67,1.79 -2.59,2.24 -2.67,0.12 0.1,-2.86 0.4,-1.28 -0.39,-1 -3.65,-4.29 -2.37,-1.77 -2.18,-2.06 -1.75,-2.11 -2.69,-2.21 -1.9,-0.14 -2.15,0.21 -1.14,1.36 -0.06,0.96 -1.03,0.97 -1.11,0.02 -0.58,-0.48 -3.16,0.14 -0.65,-0.48 -0.16,-0.91 -0.49,-0.22 0.85,-0.22 1.04,-0.72 2.52,-2.77 0.11,-1.84 0.6,-1.25 0.82,-0.45 1.29,-0.07 0.64,-0.26 0.92,-1 5.45,-6.48 0.63,-1.42 0.17,-1.11 0.82,-1.07 1.2,-0.85 1.37,-0.41 1.96,-4.22 0.1,-0.61 0.31,-0.37 1.64,-0.86 1.63,-1.8 0.85,-1.15 0.51,-1.29 1.34,-2.1 0.93,-0.29 1.57,0.18 0.55,0.79 0.47,-1.28 -0.21,-0.58 -1.35,-0.82 -0.05,-0.36 0.35,-0.33 1.08,-0.38 0.82,-0.96 2.79,-0.95 1.05,-1.07 0.1,-0.92 0.82,-0.91 2.21,-1.15 2.47,-0.4 1.77,-1.81 0.15,-1.06 1.32,-2.36 0.33,-0.04 0.05,0.36 0.29,0.2 1.33,-0.17 2.44,-1.13 2.68,-0.59 1.21,-0.57 2.1,-2.35 0.5,0.01 0.67,-0.39 1.01,-1.35 2.31,-0.73 0.3,0.38 0,0 3.52,0.39 3.26,-1.15 0.56,-0.81 1.35,0.58 -0.15,0.92 3.08,-0.03 1.63,0.99 2.56,-0.37 1.92,1.15 2.58,-0.41 1.54,0.18 2.8,-0.16 2.26,0.92 2.48,1.4 1,2.44 1.59,0.19 0.09,-0.48 1.81,-0.35 5.56,3.54 1.37,1.55 0.71,-0.03 1.56,0.98 3.03,3.49 1.64,2.21 0.48,1.48 2.17,2.66 1.17,0.55 6.69,1.06 2.11,-0.4 3.35,0.34 0.88,2.34 -2.08,1.58 -1.27,0.41 -0.73,1.86 0.22,2.19 -0.38,1.56 -0.52,1.3 -1.18,0.2 -1.29,1.69 -0.03,1.41 1.8,1.17 0.27,-0.2 -0.28,-0.97 0.01,-0.96 1.49,-0.82 1.58,0.64 0.73,0.91 1.17,0.85 0.45,-0.03 0,0 -1.4,1.73 -3.9,7.04 -4.21,11.6 -6.3,10.48 -5.44,6.66 -6.51,5.96 -6.09,3.68 -3.1,4.31 -0.18,-0.43 0.65,-1.58 0.34,-2.18 -1.18,-1.71 0.1,-0.42 0.93,-0.17 1.01,0.4 0.56,0.58 1.02,0.04 2.58,-1.41 0.82,-0.68 2.85,-3.71 0.75,-0.69 0.45,0.19 1.02,-0.19 1.05,-0.84 0.93,-1.27 0.37,-1.48 0.18,-0.93 -0.23,-2.1 0.2,-1.37 1.57,-0.07 0.74,0.3 0.27,0.83 0.35,-0.26 -0.29,-1.4 0.51,-2.07 0.48,-0.57 2.74,-1.59 0.73,-1.08 0.47,-2.75 -0.21,-2.28 0.56,-0.68 0.5,0.8 0.37,0.03 0.43,-0.42 0.47,-3.08 -0.1,-0.44 -0.95,-1.22 -0.67,-0.03 -0.26,0.69 0.17,0.39 -0.14,0.57 -0.35,0.2 -1.51,-0.02 -2.01,0.4 -0.34,1.61 -0.53,0.05 -0.81,-0.44 0.1,-1.71 -0.82,-0.89 -1.04,0.33 -0.6,-0.48 -0.73,-1.26 -0.4,-1.45 0.12,-0.57 -0.64,-0.69 -0.61,2.71 0.44,2.25 1.25,2.11 -0.57,0.81 -0.74,2.54 0.38,3.03 -0.18,0.77 -0.48,-0.37 0.26,-0.24 -0.03,-0.71 -0.47,-1.28 -0.45,-0.39 -0.53,0.66 -0.03,1.37 -1.41,3.27 -0.05,1.89 0.22,0.52 -0.72,0.7 -1.61,0.64 -0.61,1.58 -4.09,1.57 -0.72,0.53 -0.53,1.59 -0.1,2.27 -0.97,2.27 -2.36,1.3 -0.11,1.76 0.48,0.83 0.25,1.02 -0.95,0.56 -0.25,1.51 0.43,0.6 0.68,-0.14 1.3,0.63 0.15,0.91 -2.13,1.65 -2.32,4.52 -1.93,6.88 -2.01,4.49 -1.68,2.52 -7.79,7.53 z',
                'SC': 'm 379.56257,558.27114 -0.45,0.03 -1.17,-0.85 -0.73,-0.92 -1.59,-0.63 -1.48,0.82 -0.01,0.96 0.28,0.97 -0.27,0.2 -1.8,-1.17 0.04,-1.41 1.28,-1.69 1.18,-0.2 0.53,-1.31 0.37,-1.55 -0.22,-2.19 0.73,-1.86 1.27,-0.42 2.08,-1.58 -0.88,-2.34 -3.35,-0.34 -2.11,0.4 -6.69,-1.06 -1.16,-0.54 -2.17,-2.66 -0.49,-1.48 -1.63,-2.21 -3.03,-3.49 -1.57,-0.99 -0.71,0.03 -1.37,-1.55 -5.56,-3.54 -1.81,0.34 -0.09,0.48 -1.6,-0.19 -1,-2.44 -2.47,-1.39 -2.27,-0.93 -2.79,0.16 -1.54,-0.18 -2.59,0.41 -1.91,-1.15 -2.57,0.36 -1.63,-0.98 -3.08,0.03 0.15,-0.93 -1.35,-0.58 -0.56,0.81 -3.26,1.16 -3.52,-0.39 0,0 1.45,-2.93 0.73,-2.09 -0.58,-3.25 0.41,-3.21 -0.04,-2.55 0.96,-1.75 0,0 3.63,0.02 0.71,-0.38 0.53,0.01 1.06,0.24 0.31,0.51 2.03,1.41 2.68,0.03 2.34,-0.58 5.29,1.68 4.26,0.36 1.02,0.63 0.17,0.41 1.57,1.18 3.77,0.42 4.25,-0.13 1.33,1.9 0.18,-0.5 0.74,-0.38 0.92,-0.02 0.87,-0.86 -0.85,-2.99 0.69,-1.58 0.72,-0.78 2,-1.14 3.57,0.4 1.87,-0.97 0.73,-0.87 0.59,-1.48 1.53,-0.65 1.11,-0.14 1.42,0.76 0.81,0.03 2.33,-0.17 2.84,-0.73 0.75,0.01 1.04,0.4 3.12,2.6 1.23,0.62 1.44,0.16 3.35,-2.13 1.35,-1.43 1.56,-0.57 0.12,0.39 0.76,0.07 1.74,-0.23 0.33,-0.44 5.24,0.03 0,0 -0.39,1.32 0.51,1.65 -0.07,0.39 -1.5,1.14 -0.98,-0.48 -0.82,-2.53 -0.02,1.12 0.59,2.72 1.71,1.66 0.56,0.95 -1.01,2.29 -0.16,2.32 0.1,0.43 0.76,0.73 0.26,5.86 0.31,0.55 0.43,0.2 0.77,-0.51 0.35,0.72 0.1,0.87 -0.47,0.06 -0.43,-0.28 -1.19,0.63 -0.34,3.84 0.57,2.59 -0.57,0.75 0.31,1.93 0.91,1.88 -0.86,2.34 -0.52,4.01 -1.71,4.68 -0.34,-0.1 -0.36,-0.76 0.21,-0.97 -0.92,-1.18 -0.26,0.33 0.18,2.43 1.16,0.83 -0.92,1.66 -1.64,0.65 -4.13,3.04 -2.8,2.56 -3.75,4.44 -1.04,1.88 z m 17.88,-26.55 -0.15,-0.47 0.25,-1.75 0.76,-2.4 -0.4,-1.18 0.16,-1.02 1.4,-0.76 0.22,0.06 0.66,0.94 -0.54,2.56 -0.82,0.86 -0.59,1.22 0.2,1.17 -1.15,0.77 z m -0.45,-24.37 -1.87,-2.02 2.55,-2.44 0.25,0.04 0.65,1.05 -0.86,1.32 -0.72,2.05 z',
                'SE': 'm 570.20257,261.95114 -2.9,0.89 -1.55,-0.64 -0.54,-0.34 -0.48,-0.72 -1.92,-0.92 -0.6,-0.52 -0.12,-0.41 0.34,-0.39 0.13,-1.42 -0.15,-0.39 -1.43,-1.51 -0.52,-1.49 -1.09,-0.67 -0.96,-1.6 -0.02,-0.77 0.59,-1.58 0.32,-0.3 1.7,0.01 1.13,0.75 2.55,-0.99 0.69,-0.55 0.3,-0.58 -0.76,-2.75 0.08,-0.88 0.66,-1.62 0.08,-3.11 -0.75,-1.15 -1.99,-1.95 -1.27,-2.5 -0.22,-2.14 0.67,-1.15 0,0 6.46,2.98 3.68,0.95 5.42,3.07 1.3,2.45 1.76,1.45 1.66,0.79 0.46,0.03 3.59,2.23 0.6,1.31 0,0 -2.38,0.76 -4.57,2.94 -0.97,0.89 -1.55,2.21 -0.32,-0.02 0.11,-1.1 -1.05,-1.82 -0.99,0.16 0.34,1.16 1.24,0 0.23,0.24 -0.52,1.97 -1.27,2.09 -0.53,-0.35 -0.37,-0.67 -0.99,-0.16 0.2,0.68 1.13,0.62 -0.26,1.77 -0.86,1.15 -0.93,2.03 -0.78,0.15 -0.3,-0.46 0.48,-1.4 0.41,-0.13 0.31,-0.43 0.37,-1.04 -0.81,-0.37 0.1,0.68 -0.45,1.13 -0.48,0.5 -0.26,1.09 0.28,0.72 -0.26,0.52 z',
                'SP': 'm 404.84257,488.18114 -0.16,-1.33 -1.42,-0.57 -0.73,-3.3 0.4,-1.95 -2.14,-0.58 -0.76,0.17 -1.1,2.77 -0.66,0.85 -1.06,-0.53 -0.35,-0.78 0.69,-3.3 0.89,-0.66 0.14,-0.4 -1.61,-1.27 -1.59,-0.13 -1.58,0.19 -0.5,-0.38 -3.41,0.53 -2.38,0.12 -1.01,-0.21 -0.6,-0.39 -0.33,-2.04 1.28,-2.12 0.25,-1.05 -0.25,-0.44 -0.6,-0.3 -0.92,-1.97 0.06,-0.89 -0.5,-0.68 -0.67,-0.29 -1.21,-1.14 -1.49,-3.01 0.36,-0.55 0.08,-1.76 -1.3,-1.52 -0.38,-1.84 0.17,-0.81 0.39,-0.58 -0.02,-2.74 -0.89,-1.76 -3.59,-2.83 -1.13,-1.55 -2.97,0.86 -5.31,-0.13 -0.66,-0.54 -1.65,-0.14 -0.42,0.34 -1.72,-0.07 -0.72,-1.32 -0.63,-0.51 -3.51,-0.8 -1.75,-0.84 -0.78,-1 -2.58,0.01 -1.07,0.54 -1.32,-0.13 -2.64,-1.09 -2.53,-0.46 -1.48,-0.79 -1.17,-0.29 -0.73,0.37 -0.34,0.6 -1.21,0.62 -3.28,-0.29 -4.01,0.11 -3.83,-0.65 -3.25,2.29 0,0 0.84,-1.08 0.73,-1.54 1.26,-1.14 7.56,-4.54 1.95,-1.87 1.26,-2.43 1.73,-1.69 0.4,-1.21 1.44,-1.03 0.28,-1.22 -0.35,-0.84 2,-2.26 1.21,-2.34 0.07,-0.94 -0.31,-1.93 0.23,-0.39 0.96,-0.52 2.6,-3.64 0.16,-2.93 0.62,-1.68 1.01,-0.3 0.73,-0.64 1.99,-2.68 1.22,-1.02 0.47,-0.23 1.31,-0.04 1.5,-0.78 0.28,-0.4 0.4,-2.46 0,0 1.22,-1.13 2.15,-1.11 1.92,-0.37 1.43,-1.69 1.5,-0.61 0.75,0.14 1.73,1.55 2.55,0.08 4.29,0.96 1.67,-0.36 1.62,0.22 2,-0.59 2.18,1.42 1.67,0.79 -0.13,0.92 0.33,1.42 1.21,2.09 0.63,0.03 0.54,-0.32 0.67,-0.94 0.41,-1.13 0.26,-0.19 0.55,0.05 0.36,0.39 0.25,0.96 0.01,2.78 1.2,0.53 0.41,-0.45 -0.27,-2.54 0.49,-1.19 0.45,-0.48 8.18,-0.67 1.01,-1.25 1.5,1.46 1.12,0.43 2.78,-0.69 0.44,-0.99 -0.2,-0.46 0.31,-0.61 2.38,-0.11 1.66,0.78 0.85,-0.64 1.31,-0.29 3.26,3.35 0.2,1.04 -0.57,1.01 -0.29,2.37 0.58,0.61 1.89,1.21 0.4,1.55 -0.06,0.56 -1.52,2.03 -0.18,1.94 0.79,0.74 0.31,0.61 0.37,2.21 1.3,1.8 0.83,1.99 -0.03,0.85 1.61,-0.05 0.78,-0.31 0.28,-0.36 1,-0.05 3.7,1.32 0.23,0.37 -0.05,1.27 -0.7,2.18 -1.86,2.72 0.26,2.94 -0.19,3.45 -0.53,1.56 0.72,1.6 1.78,1.24 1.81,0.83 0.51,1.72 -1.21,0.7 2.02,3.31 1.13,0.25 2.01,-0.24 0.18,0.53 3.62,-1 0.56,0.42 1.31,-0.32 0.75,-0.98 0.05,-0.84 -0.24,-0.24 0.17,-2.3 1.19,-0.33 0.09,0.35 -0.35,0.49 0.01,0.48 2.34,0.08 2.39,-0.25 1.79,-0.67 1.23,-1.24 1.93,-1.02 2.21,-0.22 1.24,-0.73 0,0 1.27,0.54 0.56,1.17 1.23,1.59 1.77,0.39 3.15,-0.53 1.7,0.01 0.75,1.64 -1.65,2.15 -1.5,0.71 -2.77,0.36 -0.5,-0.15 -2.35,1.01 -1.09,1.15 -1.09,3.5 0.05,0.41 1.63,1.73 0.48,0.26 0,0 -0.06,0.2 -1.69,0.42 -1.06,-0.82 -1.48,1.11 -0.43,0.65 0.27,0.22 -0.76,0.64 -3.22,1.55 -2.25,0.7 -0.28,0.44 0.04,0.96 0.5,1.55 -0.32,0.42 -1.4,0.26 -0.7,-0.64 -1.34,-0.29 -3.12,-0.5 -0.86,0.15 -1.32,0.34 -1.73,0.82 -0.5,0.51 -1.21,2.15 -1.31,0.57 -0.5,-0.12 0.58,-0.47 -0.48,-1.22 -1.17,-0.85 -0.83,1.23 0.26,0.75 -0.3,0.61 -7.62,4.24 -0.95,0.82 -0.31,1.16 -3.27,3 -3.25,1.95 -1.92,0.53 -4.5,3.21 -2.33,1.96 -0.67,0.08 -0.44,0.62 0.9,0.43 0.66,0.06 0.93,-0.36 0,0.76 -0.62,1.31 -1.32,0.85 -1.06,1.48 z m 44.31,-23.01 -1.54,-0.65 -1.16,0.18 -0.49,-0.38 0.1,-0.78 0.95,-0.65 1.09,-1.85 0.72,0.25 0.66,0.65 0.13,2.91 -0.46,0.32 z',
                'TO': 'm 433.61257,282.08114 -5.36,1.42 -1.74,1.34 -2.56,1.1 -1.55,0 -4.53,1 -2.52,2.08 -1.78,0.9 -0.46,-0.24 -1.51,-2.62 -0.55,-0.03 -0.51,3.3 -0.69,0.08 -3.35,-0.68 -3.13,-1.47 0.56,-1.56 -0.22,-0.74 -4.53,0.53 -2.76,-0.34 -0.56,0.54 -0.3,1 -0.75,0.75 -1.14,-0.05 -0.61,-3.1 -1.11,-3.71 -1.04,-1.88 -1.15,-1.31 -1.18,0.97 -1.47,2.39 -1.63,5.94 -0.63,0.23 -4.07,-1.43 -3.09,-1.71 -3.93,-0.4 -2.2,-1.03 -2.4,-0.4 0.52,-2.34 1.22,-1.88 0.03,-1.71 -0.56,0.3 -1.81,2.09 -0.66,1.23 -0.2,1.88 -0.34,0.45 0,0 -0.8,-0.02 -0.96,-0.51 -0.98,-3.34 0.74,-2.76 -0.44,-3.05 -0.52,-0.58 -0.01,-1.57 0.47,-3.31 -1.1,-2.25 0.05,-0.5 0.82,-0.89 0.16,-0.87 -1.39,-1.34 -0.06,-0.86 1.88,-5.99 0.04,-2.95 0.54,-2.97 1.94,-5.29 0.37,-0.27 0.43,-0.85 0.44,-3.14 1.1,-1.25 0.56,-1.89 0.65,-1.02 0,0 1.62,-3.69 1.13,-4.45 1.15,-1.58 1.19,-1.1 1.21,-1.68 1.03,-1.92 1.37,-0.92 1.05,-0.16 0.73,-0.85 0.94,-1.54 0.18,-0.99 1.7,-3.24 1.09,-0.8 1.76,-5.15 0.66,-4.04 -0.15,-0.3 -0.74,-0.32 -1.67,-1.74 -0.6,-0.95 -0.16,-0.88 0.14,-0.57 1.41,-1.69 1.29,-2.1 -0.06,-2.67 -0.43,-2.18 0.19,-0.35 2.47,-1.78 3.41,-1.14 2.5,-1.21 0.24,-0.5 -0.15,-1.51 0.86,-1.27 1.51,-1.34 1.29,-0.15 0.19,-1.34 -0.29,-1.2 0.25,-0.46 1.46,-0.46 0.64,-0.48 0.93,-2.75 -1.02,-1.34 -0.09,-1.4 0.29,-0.28 0.97,-0.08 0.72,-0.37 0.37,-0.66 0.03,-0.64 -1.26,-1.17 -0.87,-0.14 -0.39,-0.31 -1.02,-1.66 -1.29,-0.12 -1.87,0.25 -2.29,-0.81 0,0 0.53,-0.64 2.62,-1.85 1.96,-0.53 0.87,0.05 2.78,1.52 1.4,0.08 0.95,-0.52 1.74,0.29 0.59,0.69 0.08,1.03 0.28,0.32 1.22,0.03 3.4,1.43 0.84,1.03 0.47,3.5 0.64,1.5 -0.21,3.72 0.23,1.08 0.67,1.13 -0.01,0.44 -1.77,6.15 -0.31,2.37 0.28,1 -0.25,1.59 -1.75,2.04 -1.76,0.67 -0.18,0.71 1.94,1.32 0.42,-0.27 1.37,0.24 0.25,0.35 0.11,0.88 -0.62,1.19 0.85,1.44 0.88,-0.07 3,4.16 0.91,0.85 2.28,3.02 2.14,-1.34 4.27,-0.94 1.8,1.22 0.08,1.75 -0.64,3.25 0.39,1.35 -3.39,0.35 -1.34,0.54 -0.57,0.55 -0.68,1.43 -0.73,2.68 0.37,1.3 -2.63,2.55 -0.26,0.7 0.2,0.42 2.08,0.29 0.94,0.69 0.74,1.59 0.06,1.66 0.62,1.04 3.88,1.95 0.09,0.53 -1.64,1.81 0.13,1.65 2.14,1.62 0.99,2.87 1.34,2 0.71,0.18 1.78,-0.21 1,0.3 0.82,0.44 0.61,0.82 1.28,0.66 0,0 2.94,0.21 0,0 -0.69,0.65 -0.22,0.98 -0.56,0.47 -3.82,2.02 -3.21,2.62 -0.19,0.37 1.29,1.8 -0.36,0.39 -1.01,0.27 -0.9,0.61 -1.52,3.49 -1.01,0.72 -0.5,1.16 0.23,0.92 1.86,1.95 3.59,0.67 1.87,0.99 0.05,0.76 -0.56,0.45 -2.04,0.81 -0.43,0.96 0.09,0.5 0.35,0.33 1.03,-0.18 0.92,0.29 0.58,0.51 0.29,0.64 -0.96,0.71 -1.15,0.42 -1.95,1.67 -0.19,0.85 -0.05,2.92 0.35,1.25 0.94,0.66 1.05,0.24 0.41,0.25 0.17,0.42 0.05,1.06 -1.36,2.38 z'
            };

            // Centros para labels (posições centrais calculadas)
            const centros = {
                'AC': [57.7,224.4],
                'AL': [582.6,232.7],
                'AM': [139.5,141.5],
                'AP': [338.5,57.2],
                'BA': [499.8,293.1],
                'CE': [541.3,164.9],
                'DF': [409.4,329.7],
                'ES': [518.9,392.1],
                'GO': [381.6,333.6],
                'MA': [448.5,170.9],
                'MG': [446.1,376.2],
                'MS': [304.0,409.7],
                'MT': [282.5,281.4],
                'PA': [335.4,139.0],
                'PB': [581.4,193.3],
                'PE': [560.9,212.5],
                'PI': [481.1,188.6],
                'PR': [353.9,476.5],
                'RJ': [485.5,433.2],
                'RN': [581.1,173.9],
                'RO': [166.7,251.4],
                'RR': [190.2,52.3],
                'RS': [317.9,578.8],
                'SC': [357.7,529.2],
                'SE': [572.7,246.7],
                'SP': [395.9,441.7],
                'TO': [402.2,226.4]
            };

            let pathsHTML = '';
            Object.keys(pathsEstados).forEach(uf => {
                const d = dadosEstados[uf] || { faturamento: 0, vendas: 0, clientes: 0 };
                const intensidade = d.faturamento / maxFaturamento;
                const cor = getCorIntensidade(intensidade);
                const centro = centros[uf];
                const valorFormatado = formatarMoeda(d.faturamento);
                const nomeEstado = nomesEstados[uf] || uf;
                const fontSize = ['DF','SE','AL','RN','PB'].includes(uf) ? 8 : 10;
                
                pathsHTML += `
                    <path d="${pathsEstados[uf]}" 
                          fill="${cor}" stroke="#fff" stroke-width="0.8" stroke-linejoin="round"
                          style="cursor:pointer;transition:all 0.3s ease;"
                          data-uf="${uf}" data-nome="${nomeEstado}" data-valor="${valorFormatado}" data-vendas="${d.vendas || 0}" data-clientes="${d.clientes || 0}"
                          onmouseover="highlightEstado(this, event)" onmouseout="unhighlightEstado(this)" onmousemove="moverTooltipMapa(event)"/>
                    <text x="${centro[0]}" y="${centro[1]+3}" text-anchor="middle" font-size="${fontSize}" fill="${intensidade > 0.25 ? '#fff' : '#475569'}" font-weight="700" font-family="Segoe UI, Arial" style="pointer-events:none;text-shadow:${intensidade > 0.25 ? '0 1px 3px rgba(0,0,0,0.4)' : '0 0 3px rgba(255,255,255,0.8)'};">${uf}</text>`;
            });

            // Legenda de intensidade
            const legendaHTML = `
                <div style="position:absolute;bottom:8px;left:12px;display:flex;align-items:center;gap:4px;background:rgba(255,255,255,0.92);padding:6px 10px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.08);backdrop-filter:blur(4px);">
                    <span style="font-size:9px;color:#94a3b8;margin-right:4px;">Menor</span>
                    <div style="width:14px;height:10px;background:#e2e8f0;border-radius:2px;"></div>
                    <div style="width:14px;height:10px;background:#bfdbfe;border-radius:2px;"></div>
                    <div style="width:14px;height:10px;background:#60a5fa;border-radius:2px;"></div>
                    <div style="width:14px;height:10px;background:#2563eb;border-radius:2px;"></div>
                    <div style="width:14px;height:10px;background:#1e40af;border-radius:2px;"></div>
                    <span style="font-size:9px;color:#94a3b8;margin-left:4px;">Maior</span>
                </div>
            `;

            container.innerHTML = `
                <svg viewBox="0 0 613 640" style="width:100%;height:100%;max-height:340px;" preserveAspectRatio="xMidYMid meet">
                    <defs>
                        <filter id="estadoShadow"><feDropShadow dx="0" dy="1" stdDeviation="1.5" flood-color="#000" flood-opacity="0.08"/></filter>
                    </defs>
                    <g filter="url(#estadoShadow)">${pathsHTML}</g>
                </svg>
                ${legendaHTML}
                <div id="mapaTooltipDiv" style="position:absolute;display:none;background:linear-gradient(135deg,#1e293b,#0f172a);color:white;padding:12px 16px;border-radius:10px;font-size:12px;pointer-events:none;box-shadow:0 8px 24px rgba(0,0,0,0.25);z-index:100;white-space:nowrap;border:1px solid rgba(255,255,255,0.08);"></div>
            `;
            container.style.position = 'relative';
        }

        function highlightEstado(el, event) {
            const tooltip = document.getElementById('mapaTooltipDiv');
            if (!tooltip) return;
            
            const nome = el.getAttribute('data-nome');
            const valor = el.getAttribute('data-valor');
            const vendas = el.getAttribute('data-vendas');
            const clientes = el.getAttribute('data-clientes');
            
            tooltip.innerHTML = `
                <div style="font-weight:700;font-size:14px;margin-bottom:6px;display:flex;align-items:center;gap:6px;">
                    <span style="display:inline-block;width:8px;height:8px;background:#60a5fa;border-radius:50%;"></span>
                    ${nome} (${el.getAttribute('data-uf')})
                </div>
                <div style="display:grid;grid-template-columns:auto auto;gap:4px 16px;font-size:12px;">
                    <span style="color:#94a3b8;">Faturamento</span><span style="color:#60a5fa;font-weight:700;">${valor}</span>
                    <span style="color:#94a3b8;">Pedidos</span><span style="font-weight:600;">${vendas}</span>
                    <span style="color:#94a3b8;">Clientes</span><span style="font-weight:600;">${clientes}</span>
                </div>
            `;
            tooltip.style.display = 'block';
            
            el.style.filter = 'brightness(1.15) drop-shadow(0 0 6px rgba(59,130,246,0.5))';
            el.style.strokeWidth = '2';
            el.style.stroke = '#3b82f6';
            
            moverTooltipMapa(event);
        }

        function unhighlightEstado(el) {
            const tooltip = document.getElementById('mapaTooltipDiv');
            if (tooltip) tooltip.style.display = 'none';
            el.style.filter = '';
            el.style.strokeWidth = '1.2';
            el.style.stroke = '#fff';
        }
function getCorIntensidade(intensidade) {
            if (intensidade === 0) return '#e2e8f0';
            if (intensidade < 0.05) return '#dbeafe';
            if (intensidade < 0.1) return '#bfdbfe';
            if (intensidade < 0.2) return '#93c5fd';
            if (intensidade < 0.35) return '#60a5fa';
            if (intensidade < 0.5) return '#3b82f6';
            if (intensidade < 0.7) return '#2563eb';
            if (intensidade < 0.85) return '#1d4ed8';
            return '#1e40af';
        }

        function moverTooltipMapa(event) {
            const tooltip = document.getElementById('mapaTooltipDiv');
            if (!tooltip) return;
            const container = document.getElementById('mapaContainer');
            const rect = container ? container.getBoundingClientRect() : { left: 0, top: 0 };
            tooltip.style.left = (event.clientX - rect.left + 15) + 'px';
            tooltip.style.top = (event.clientY - rect.top - 10) + 'px';
        }

        function renderizarTopEstados(top5) {
            const container = document.getElementById('topEstadosContainer');
            if (!top5 || top5.length === 0) {
                container.innerHTML = `
                    <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:260px;color:#94a3b8;gap:12px;">
                        <i class="fas fa-chart-bar" style="font-size:36px;opacity:0.4;"></i>
                        <span style="font-size:13px;">Sem dados de vendas por estado</span>
                        <span style="font-size:11px;opacity:0.7;">Filtre por um período com pedidos</span>
                    </div>`;
                return;
            }
            
            const maxValor = Math.max(...top5.map(e => e.faturamento), 1);
            const cores = ['#1e40af', '#2563eb', '#3b82f6', '#60a5fa', '#93c5fd'];
            const bgCores = ['#eff6ff', '#f0f7ff', '#f5f9ff', '#f8fafc', '#f8fafc'];
            const medalhas = ['🥇', '🥈', '🥉', '', ''];
            
            container.innerHTML = top5.map((estado, i) => {
                const percentual = (estado.faturamento / maxValor * 100).toFixed(0);
                return `
                    <div style="margin-bottom:12px;padding:14px 16px;background:${bgCores[i]};border-radius:12px;border:1px solid ${i < 3 ? '#dbeafe' : '#e2e8f0'};transition:all 0.2s;cursor:default;" 
                         onmouseover="this.style.transform='translateX(4px)';this.style.boxShadow='0 4px 12px rgba(59,130,246,0.1)'" 
                         onmouseout="this.style.transform='';this.style.boxShadow=''">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                            <div style="display:flex;align-items:center;gap:10px;">
                                ${medalhas[i] ? `<span style="font-size:20px;">${medalhas[i]}</span>` : `<span style="display:inline-flex;width:24px;height:24px;background:${cores[i]};border-radius:7px;color:white;font-size:11px;font-weight:700;align-items:center;justify-content:center;">${i+1}</span>`}
                                <div>
                                    <div style="font-weight:700;color:#0f172a;font-size:14px;line-height:1.2;">${estado.nome}</div>
                                    <div style="font-size:11px;color:#94a3b8;">${estado.uf}</div>
                                </div>
                            </div>
                            <span style="font-weight:800;color:${cores[i]};font-size:15px;">${formatarMoeda(estado.faturamento)}</span>
                        </div>
                        <div style="height:5px;background:#e2e8f0;border-radius:3px;overflow:hidden;margin-bottom:8px;">
                            <div style="height:100%;width:${percentual}%;background:linear-gradient(90deg,${cores[i]},${cores[Math.min(i+1,4)]});border-radius:3px;transition:width 0.8s ease-out;"></div>
                        </div>
                        <div style="display:flex;justify-content:space-between;font-size:11px;color:#64748b;">
                            <span><i class="fas fa-shopping-cart" style="margin-right:4px;color:#94a3b8;font-size:10px;"></i>${estado.vendas} pedidos</span>
                            <span><i class="fas fa-users" style="margin-right:4px;color:#94a3b8;font-size:10px;"></i>${estado.clientes} clientes</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor || 0);
        }    </script>

    <script src="/js/auth-unified.js?v=20260131c"></script>
    <script src="/js/mobile-auto-enhance.js?v=20260202" defer></script>
    <!-- Chat Widget BOB AI - DESATIVADO -->
    <!-- <script src="/chat/widget.js?v=20260218" defer></script> -->
    <script src="/js/user-dropdown.js?v=20260223" defer></script>

    <!-- Sidebar Click Animation -->
    <script src="/js/sidebar-click-animation.js?v=20260224"></script>
    <script src="/_shared/accessibility-widget.js?v=20260226"></script>
</body>
</html>


