/* ================================================= *//* CORREÇÁO ESTRUTURAL JAVASCRIPT                   *//* ================================================= */(function() {    'use strict';    // Aguardar DOM completamente carregado    document.addEventListener('DOMContentLoaded', function() {        initSectionFixes();    });    // Funçáo principal de correções    function initSectionFixes() {        console.log('🔧 Iniciando correções estruturais...');        // Remover seções duplicadas        removeDuplicateSections();                // Garantir que apenas uma seçáo esteja ativa        ensureSingleActiveSection();                // Corrigir navegaçáo        fixNavigation();                // Corrigir IDs duplicados        fixDuplicateIds();        console.log('✅ Correções estruturais aplicadas');    }    // Remove seções duplicadas    function removeDuplicateSections() {        const sectionIds = {};        const sectionsToRemove = [];        document.querySelectorAll('.content-section').forEach(function(section) {            const id = section.id;            if (id && sectionIds[id]) {                // Está é uma seçáo duplicada                console.warn('🚨 Seçáo duplicada encontrada:', id);                sectionsToRemove.push(section);            } else if (id) {                sectionIds[id] = true;            }        });        // Remover seções duplicadas        sectionsToRemove.forEach(function(section) {            console.log('🗑️ Removendo seçáo duplicada:', section.id);            section.remove();        });    }    // Garantir que apenas uma seçáo esteja ativa    function ensureSingleActiveSection() {        const sections = document.querySelectorAll('.content-section');        let activeSection = null;        let activeSections = [];        // Encontrar seções ativas        sections.forEach(function(section) {            if (section.classList.contains('active') || section.style.display === 'block') {                activeSections.push(section);            }        });        // Se há mais de uma seçáo ativa, manter apenas a primeira        if (activeSections.length > 1) {            console.warn('🚨 Múltiplas seções ativas encontradas, corrigindo...');            activeSection = activeSections[0];                        // Desativar todas as outras            activeSections.slice(1).forEach(function(section) {                hideSection(section);            });        } else if (activeSections.length === 1) {            activeSection = activeSections[0];        }        // Se náo há seçáo ativa, ativar o dashboard        if (!activeSection) {            activeSection = document.getElementById('dashboard-home') ||                            document.getElementById('dashboard');                        if (activeSection) {                showSection(activeSection);                console.log('✅ Dashboard definido como seçáo ativa padráo');            }        }        // Garantir que todas as outras seções estejam ocultas        sections.forEach(function(section) {            if (section !== activeSection) {                hideSection(section);            }        });    }    // Mostrar uma seçáo    function showSection(section) {        section.classList.add('active');        section.style.display = 'block';        section.style.visibility = 'visible';        section.style.opacity = '1';    }    // Ocultar uma seçáo    function hideSection(section) {        section.classList.remove('active');        section.style.display = 'none';        section.style.visibility = 'hidden';        section.style.opacity = '0';    }    // Corrigir navegaçáo para evitar conflitos    function fixNavigation() {        document.querySelectorAll('.nav-link').forEach(function(link) {            link.addEventListener('click', function(e) {                e.preventDefault();                e.stopPropagation();                // Obter ID da seçáo target                const href = link.getAttribute('href');                const targetId = href ? href.replace('#', '') : null;                                if (targetId) {                    navigateToSection(targetId);                }            });        });    }    // Navegar para uma seçáo específica    function navigateToSection(sectionId) {        console.log('🧭 Navegando para seçáo:', sectionId);        // Ocultar todas as seções        document.querySelectorAll('.content-section').forEach(function(section) {            hideSection(section);        });        // Mostrar seçáo target        const targetSection = document.getElementById(sectionId);        if (targetSection) {            showSection(targetSection);            // Atualizar navegaçáo ativa            document.querySelectorAll('.nav-link').forEach(function(link) {                link.classList.remove('active');            });            const activeLink = document.querySelector(`[href="#${sectionId}"]`);            if (activeLink) {                activeLink.classList.add('active');            }            // Chamar funções de carregamento específicas se existirem            if (window.omieLayout && window.omieLayout.loadSectionData) {                window.omieLayout.loadSectionData(sectionId);            }            console.log('✅ Navegaçáo para', sectionId, 'concluída');        } else {            console.error('❌ Seçáo náo encontrada:', sectionId);        }    }    // Corrigir IDs duplicados    function fixDuplicateIds() {        const ids = {};        const elementsToFix = [];        document.querySelectorAll('[id]').forEach(function(element) {            const id = element.id;            if (ids[id]) {                elementsToFix.push(element);            } else {                ids[id] = true;            }        });        elementsToFix.forEach(function(element, index) {            const oldId = element.id;            const newId = oldId + '_duplicate_' + (index + 1);            element.id = newId;            console.warn('🔧 ID duplicado corrigido:', oldId, '→', newId);        });    }    // Expor funções globalmente    window.structureFix = {        navigateToSection: navigateToSection,        showSection: showSection,        hideSection: hideSection,        removeDuplicateSections: removeDuplicateSections,        ensureSingleActiveSection: ensureSingleActiveSection    };    // Debug function    window.debugStructure = function() {        console.log('=== 🔍 DEBUG ESTRUTURAL ===');                const sections = document.querySelectorAll('.content-section');        console.log('Total de seções:', sections.length);                const activeSections = document.querySelectorAll('.content-section.active');        console.log('Seções ativas:', activeSections.length);                sections.forEach(function(section, index) {            console.log(`Seçáo ${index + 1}:`, {                id: section.id,                active: section.classList.contains('active'),                display: section.style.display || 'default',                visibility: section.style.visibility || 'default'            });        });        const duplicateIds = [];        const ids = {};        document.querySelectorAll('[id]').forEach(function(element) {            const id = element.id;            if (ids[id]) {                duplicateIds.push(id);            } else {                ids[id] = true;            }        });        if (duplicateIds.length > 0) {            console.warn('IDs duplicados encontrados:', duplicateIds);        } else {            console.log('✅ Nenhum ID duplicado encontrado');        }    };})();