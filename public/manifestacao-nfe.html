<!DOCTYPE html>
<html lang="pt-br">
<head>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <meta charset="UTF-8">
  <title>Aluforce: Manifestação do Destinatário NFe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Mobile Enterprise Design System -->
    <link rel="stylesheet" href="/css/design-system-mobile.css?v=20260202">
    <link rel="stylesheet" href="/css/responsive-global.css?v=20260202">
    <link rel="stylesheet" href="/css/mobile-master-2026.css?v=20260202">
    <link rel="stylesheet" href="/css/mobile-enterprise-enhancements.css?v=20260202">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <!-- Chat Widget BOB AI --><!-- Chat Widget REMOVIDO --><!-- 
    <link rel="stylesheet" href="/chat/widget.css?v=20260218"> -->
</head>
<body class="bg-light">
  <div class="container py-4">
    <h1 class="mb-4">Manifestação do Destinatário NFe</h1>
    <form id="manifestacaoForm" class="card p-4 mb-4">
      <div class="mb-3">
        <label for="chave" class="form-label">Chave de Acesso NFe</label>
        <input type="text" class="form-control" id="chave" required maxlength="44">
      </div>
      <div class="mb-3">
        <label for="tipo" class="form-label">Tipo de Manifestação</label>
        <select class="form-select" id="tipo" required>
          <option value="">Selecione...</option>
          <option value="210200">Confirmação da Operação</option>
          <option value="210210">Ciência da Operação</option>
          <option value="210220">Desconhecimento da Operação</option>
          <option value="210240">Operação não Realizada</option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary">Enviar Manifestação</button>
    </form>
    <div id="alerta"></div>
    <div id="resultado"></div>
  </div>
  <script>
    document.getElementById('manifestacaoForm').onsubmit = async function(e) {
      e.preventDefault();
      const chave = document.getElementById('chave').value.trim();
      const tipo = document.getElementById('tipo').value;
      if (!chave || !tipo) {
        mostrarAlerta('Preencha todos os campos.', 'danger');
        return;
      }
      const resp = await fetch('/api/nfe/manifestacao-destinatario', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ chave, tipo })
      });
      const data = await resp.json();
      if (data.success) {
        mostrarAlerta('Manifestação enviada com sucesso!', 'success');
        document.getElementById('resultado').innerHTML = `<pre>${JSON.stringify(data.resultado, null, 2)}</pre>`;
      } else {
        mostrarAlerta(data.message || 'Erro ao enviar manifestação', 'danger');
      }
    };
    function mostrarAlerta(msg, tipo) {
      document.getElementById('alerta').innerHTML = `<div class="alert alert-${tipo} mt-2">${msg}</div>`;
      setTimeout(() => { document.getElementById('alerta').innerHTML = ''; }, 4000);
    }
  </script>

    <script src="/js/auth-unified.js?v=20260131c"></script>
    <script src="/js/mobile-auto-enhance.js?v=20260202" defer></script>
    <!-- Chat Widget BOB AI --><!-- Chat Widget REMOVIDO --><!-- 
    <script src="/chat/widget.js?v=20260218" defer></script> -->
</body>
</html>
