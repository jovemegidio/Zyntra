<!DOCTYPE html>
<html lang="pt-br">
<head>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <meta charset="UTF-8">
  <title>Aluforce: Importar NFe XML</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Mobile Enterprise Design System -->
    <link rel="stylesheet" href="/css/design-system-mobile.css?v=20260202">
    <link rel="stylesheet" href="/css/responsive-global.css?v=20260202">
    <link rel="stylesheet" href="/css/mobile-master-2026.css?v=20260202">
    <link rel="stylesheet" href="/css/mobile-enterprise-enhancements.css?v=20260202">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <!-- Chat Widget BOB AI --><!-- Chat Widget REMOVIDO --><!-- 
    <link rel="stylesheet" href="/chat/widget.css?v=20260218"> -->
</head>
<body class="bg-light">
  <div class="container py-4">
    <h1 class="mb-4">Importação de NFe XML</h1>
    <form id="xmlForm" class="card p-4 mb-4" enctype="multipart/form-data">
      <div class="mb-3">
        <label for="xmlFile" class="form-label">Arquivo XML da NFe</label>
        <input type="file" class="form-control" id="xmlFile" accept=".xml" required>
      </div>
      <button type="submit" class="btn btn-primary">Importar XML</button>
    </form>
    <div id="alerta"></div>
    <div id="resultado"></div>
  </div>
  <script>
    document.getElementById('xmlForm').onsubmit = async function(e) {
      e.preventDefault();
      const fileInput = document.getElementById('xmlFile');
      if (!fileInput.files.length) return;
      const formData = new FormData();
      formData.append('xml', fileInput.files[0]);
      const resp = await fetch('/api/nfe/importar-xml', {
        method: 'POST',
        body: formData
      });
      const data = await resp.json();
      if (data.success) {
        mostrarAlerta('XML importado e validado com sucesso!', 'success');
        document.getElementById('resultado').innerHTML = `<pre>${JSON.stringify(data.resultado, null, 2)}</pre>`;
      } else {
        mostrarAlerta(data.message || 'Erro ao importar XML', 'danger');
      }
    };
    function mostrarAlerta(msg, tipo) {
      document.getElementById('alerta').innerHTML = `<div class="alert alert-${tipo} mt-2">${msg}</div>`;
      setTimeout(() => { document.getElementById('alerta').innerHTML = ''; }, 4000);
    }
  </script>

    <script src="/js/auth-unified.js?v=20260131c"></script>
    <script src="/js/mobile-auto-enhance.js?v=20260202" defer></script>
    <!-- Chat Widget BOB AI --><!-- Chat Widget REMOVIDO --><!-- 
    <script src="/chat/widget.js?v=20260218" defer></script> -->
</body>
</html>
