/* ============================================================
   ALUFORCE - CSS PERFORMANCE OPTIMIZATIONS
   Otimizações CSS para carregamento e renderização mais rápidos
   ============================================================ */

/* ===========================================
   1. OTIMIZAÇÕES DE RENDERIZAÇÍO
   =========================================== */

/* Usar GPU para animações */
.app-container,
.main-area,
.content,
.sidebar,
.header,
.card,
.modal,
.table-container {
    transform: translateZ(0);
    backface-visibility: hidden;
}

/* Evitar repaint em elementos fixos */
.sidebar,
.header,
[style*="position: fixed"],
[style*="position: sticky"] {
    will-change: transform;
    contain: layout style;
}

/* Content containment para melhor performance */
.card,
.module-card,
.kpi-card,
.notification-item,
table tr {
    contain: content;
}

/* Layout containment para containers */
.grid-2,
.kpi-grid,
.table-container {
    contain: layout;
}

/* ===========================================
   2. SKELETON LOADING STATES
   =========================================== */

/* Skeleton base */
.skeleton,
[data-skeleton] {
    position: relative;
    overflow: hidden;
    background: #e5e7eb !important;
    color: transparent !important;
    border-radius: 4px;
    pointer-events: none;
    user-select: none;
}

.skeleton::after,
[data-skeleton]::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    animation: skeleton-wave 1.5s linear infinite;
}

@keyframes skeleton-wave {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

/* Variações de skeleton */
.skeleton-text {
    height: 1rem;
    margin: 0.5rem 0;
    width: 80%;
}

.skeleton-text.short { width: 40%; }
.skeleton-text.medium { width: 60%; }
.skeleton-text.full { width: 100%; }

.skeleton-title {
    height: 1.5rem;
    width: 50%;
    margin-bottom: 1rem;
}

.skeleton-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

.skeleton-button {
    width: 100px;
    height: 36px;
    border-radius: 6px;
}

.skeleton-card {
    height: 150px;
    border-radius: 12px;
}

.skeleton-row {
    height: 52px;
    margin-bottom: 4px;
    border-radius: 4px;
}

/* ===========================================
   3. INSTANT FEEDBACK (LOADING STATES)
   =========================================== */

/* Estado de loading para botões */
.btn-loading,
button[data-loading="true"] {
    position: relative;
    color: transparent !important;
    pointer-events: none;
}

.btn-loading::after,
button[data-loading="true"]::after {
    content: '';
    position: absolute;
    width: 18px;
    height: 18px;
    top: 50%;
    left: 50%;
    margin: -9px 0 0 -9px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: btn-spinner 0.6s linear infinite;
}

@keyframes btn-spinner {
    to { transform: rotate(360deg); }
}

/* Loading overlay para containers */
.loading-overlay {
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s, visibility 0.2s;
}

.loading-overlay.active {
    opacity: 1;
    visibility: visible;
}

.loading-overlay .spinner {
    width: 32px;
    height: 32px;
    border: 3px solid #e5e7eb;
    border-top-color: #3b82f6;
    border-radius: 50%;
    animation: btn-spinner 0.8s linear infinite;
}

/* ===========================================
   4. TRANSIÇÕES OTIMIZADAS PARA NAVEGAÇÍO
   =========================================== */

/* Page transition */
.page-transition-enter {
    opacity: 0;
    transform: translateY(10px);
}

.page-transition-enter-active {
    opacity: 1;
    transform: translateY(0);
    transition: opacity 0.2s ease-out, transform 0.2s ease-out;
}

.page-transition-exit {
    opacity: 1;
    transform: translateY(0);
}

.page-transition-exit-active {
    opacity: 0;
    transform: translateY(-10px);
    transition: opacity 0.15s ease-in, transform 0.15s ease-in;
}

/* Fade in para conteúdo carregado */
.content-fade-in {
    animation: contentFadeIn 0.25s ease-out forwards;
}

@keyframes contentFadeIn {
    from {
        opacity: 0;
        transform: translateY(8px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ===========================================
   5. OTIMIZAÇÕES DE FONTE
   =========================================== */

/* Font display swap para evitar FOIT */
@font-face {
    font-family: 'Inter';
    font-display: swap;
}

@font-face {
    font-family: 'Outfit';
    font-display: swap;
}

@font-face {
    font-family: 'Poppins';
    font-display: swap;
}

/* Placeholder para texto enquanto fonte carrega */
.font-loading {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* ===========================================
   6. INSTANT HOVER/CLICK FEEDBACK
   =========================================== */

/* Remove delay em touch devices */
a, button, [role="button"], .clickable {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
}

/* Feedback visual imediato */
button:active,
.btn:active,
a:active,
[role="button"]:active,
.clickable:active {
    transform: scale(0.97);
    transition: transform 0.05s ease;
}

/* Hover rápido */
button:hover,
.btn:hover,
a:hover {
    transition: all 0.1s ease;
}

/* ===========================================
   7. OTIMIZAÇÕES DE TABELA
   =========================================== */

/* Table layout fixo para renderização mais rápida */
table {
    table-layout: fixed;
    border-collapse: collapse;
}

/* Virtualização visual - ocultar linhas fora da view */
.virtual-scroll-container {
    overflow-y: auto;
    will-change: scroll-position;
}

.virtual-scroll-container tr {
    content-visibility: auto;
    contain-intrinsic-size: 0 52px;
}

/* ===========================================
   8. LAZY LOADING VISUAL
   =========================================== */

/* Imagens com lazy loading */
img[loading="lazy"],
img[data-src] {
    opacity: 0;
    transition: opacity 0.3s ease;
}

img[loading="lazy"].loaded,
img.lazy-loaded {
    opacity: 1;
}

/* Placeholder para imagens */
.img-placeholder {
    background: linear-gradient(135deg, #f5f5f5, #e5e5e5);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #999;
}

/* ===========================================
   9. PROGRESS BAR DE NAVEGAÇÍO
   =========================================== */

#turbo-progress {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
    z-index: 999999;
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
    pointer-events: none;
}

#turbo-progress.loading {
    animation: turbo-progress-anim 2s ease-in-out infinite;
}

@keyframes turbo-progress-anim {
    0% { transform: scaleX(0); }
    50% { transform: scaleX(0.7); }
    100% { transform: scaleX(1); }
}

#turbo-progress.complete {
    transform: scaleX(1);
    opacity: 0;
    transition: transform 0.2s ease, opacity 0.3s ease 0.2s;
}

/* ===========================================
   10. OTIMIZAÇÕES MOBILE
   =========================================== */

@media (max-width: 768px) {
    /* Desabilitar animações complexas em mobile */
    .card,
    .module-card {
        transform: none !important;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
    }
    
    /* Simplificar transições */
    * {
        transition-duration: 0.1s !important;
    }
    
    /* Menor quantidade de skeleton rows */
    .skeleton-row:nth-child(n+4) {
        display: none;
    }
}

/* ===========================================
   11. PREFERS REDUCED MOTION
   =========================================== */

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    .skeleton::after,
    [data-skeleton]::after {
        animation: none;
    }
}

/* ===========================================
   12. CRITICAL CSS INLINE FALLBACK
   =========================================== */

/* Estilos mínimos para first paint */
.initial-loader {
    position: fixed;
    inset: 0;
    background: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 99999;
}

.initial-loader.fade-out {
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
}

.initial-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid #e5e7eb;
    border-top-color: #3b82f6;
    border-radius: 50%;
    animation: btn-spinner 0.8s linear infinite;
}
